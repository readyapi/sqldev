
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="SQLDev, SQL databases in Python, designed for simplicity, compatibility, and robustness.">
      
      
      
        <link rel="canonical" href="https://sqldev.khulnasoft.com/tutorial/many-to-many/link-with-extra-fields/">
      
      
        <link rel="prev" href="../update-remove-relationships/">
      
      
        <link rel="next" href="../../code-structure/">
      
      
      <link rel="icon" href="../../../img/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.46">
    
    
      
        <title>Link Model with Extra Fields - SQLDev</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.6f8fc17f.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../css/termynal.css">
    
      <link rel="stylesheet" href="../../../css/custom.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-J8HVTT936W"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-J8HVTT936W",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-J8HVTT936W",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="Link Model with Extra Fields - SQLDev" >
      
        <meta  property="og:description"  content="SQLDev, SQL databases in Python, designed for simplicity, compatibility, and robustness." >
      
        <meta  property="og:image"  content="https://sqldev.khulnasoft.com/assets/images/social/tutorial/many-to-many/link-with-extra-fields.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="https://sqldev.khulnasoft.com/tutorial/many-to-many/link-with-extra-fields/" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="Link Model with Extra Fields - SQLDev" >
      
        <meta  name="twitter:description"  content="SQLDev, SQL databases in Python, designed for simplicity, compatibility, and robustness." >
      
        <meta  name="twitter:image"  content="https://sqldev.khulnasoft.com/assets/images/social/tutorial/many-to-many/link-with-extra-fields.png" >
      
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#link-model-with-extra-fields" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="SQLDev" class="md-header__button md-logo" aria-label="SQLDev" data-md-component="logo">
      
  <img src="../../../img/icon-white.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            SQLDev
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Link Model with Extra Fields
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9 2C5.13 2 2 5.13 2 9c0 2.38 1.19 4.47 3 5.74V17c0 .55.45 1 1 1h6c.55 0 1-.45 1-1v-2.26c1.81-1.27 3-3.36 3-5.74 0-3.87-3.13-7-7-7M6 21c0 .55.45 1 1 1h4c.55 0 1-.45 1-1v-1H6zm13-8h-2l-3.2 9h1.9l.7-2h3.2l.7 2h1.9zm-2.15 5.65L18 15l1.15 3.65z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="amber"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="deep-purple" data-md-color-accent="amber"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/readyapi/sqldev" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
  </div>
  <div class="md-source__repository">
    readyapi/sqldev
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  SQLDev

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../features/" class="md-tabs__link">
        
  
    
  
  Features

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../../learn/" class="md-tabs__link">
          
  
    
  
  Learn

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../resources/" class="md-tabs__link">
          
  
    
  
  Resources

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../about/" class="md-tabs__link">
          
  
    
  
  About

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../release-notes/" class="md-tabs__link">
        
  
    
  
  Release Notes

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="SQLDev" class="md-nav__button md-logo" aria-label="SQLDev" data-md-component="logo">
      
  <img src="../../../img/icon-white.svg" alt="logo">

    </a>
    SQLDev
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/readyapi/sqldev" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
  </div>
  <div class="md-source__repository">
    readyapi/sqldev
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SQLDev
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../features/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Features
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../learn/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Learn
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Learn
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../databases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intro to Databases
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../db-to-code/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Database to Code (ORMs)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../environment-variables/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Environment Variables
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../virtual-environments/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Virtual Environments
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../install/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Install **SQLDev**
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_7" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Tutorial - User Guide
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_7" id="__nav_3_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_7">
            <span class="md-nav__icon md-icon"></span>
            Tutorial - User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../create-db-and-table-with-db-browser/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Create a Table with SQL
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../create-db-and-table/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Create a Table with SQLDev - Use the Engine
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../insert/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Create Rows - Use the Session - INSERT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../automatic-id-none-refresh/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Automatic IDs, None Defaults, and Refreshing Data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../select/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Read Data - SELECT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../where/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Filter Data - WHERE
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../indexes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Indexes - Optimize Queries
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../one/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Read One Row
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../limit-and-offset/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Read a Range of Data - LIMIT and OFFSET
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../update/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Update Data - UPDATE
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../delete/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Delete Data - DELETE
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_7_13" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../connect/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Connect Tables - JOIN - Intro
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_7_13" id="__nav_3_7_13_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_7_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_7_13">
            <span class="md-nav__icon md-icon"></span>
            Connect Tables - JOIN - Intro
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../connect/create-connected-tables/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Create Connected Tables
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../connect/create-connected-rows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Create and Connect Rows
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../connect/read-connected-data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Read Connected Data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../connect/update-data-connections/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Update Data Connections
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../connect/remove-data-connections/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Remove Data Connections
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_7_14" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../relationship-attributes/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Relationship Attributes - Intro
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_7_14" id="__nav_3_7_14_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_7_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_7_14">
            <span class="md-nav__icon md-icon"></span>
            Relationship Attributes - Intro
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../relationship-attributes/define-relationships-attributes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Define Relationships Attributes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../relationship-attributes/create-and-update-relationships/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Create and Update Relationships
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../relationship-attributes/read-relationships/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Read Relationships
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../relationship-attributes/remove-relationships/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Remove Relationships
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../relationship-attributes/back-populates/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Relationship back_populates
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../relationship-attributes/cascade-delete-relationships/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cascade Delete Relationships
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../relationship-attributes/type-annotation-strings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Type annotation strings
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_7_15" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Many to Many - Intro
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_7_15" id="__nav_3_7_15_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_7_15_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_7_15">
            <span class="md-nav__icon md-icon"></span>
            Many to Many - Intro
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../create-models-with-link/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Create Models with a Many-to-Many Link
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../create-data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Create Data with Many-to-Many Relationships
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../update-remove-relationships/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Update and Remove Many-to-Many Relationships
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Link Model with Extra Fields
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Link Model with Extra Fields
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#link-model-with-two-one-to-many" class="md-nav__link">
    <span class="md-ellipsis">
      Link Model with Two One-to-Many
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#update-link-model" class="md-nav__link">
    <span class="md-ellipsis">
      Update Link Model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#update-team-model" class="md-nav__link">
    <span class="md-ellipsis">
      Update Team Model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#update-hero-model" class="md-nav__link">
    <span class="md-ellipsis">
      Update Hero Model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-relationships" class="md-nav__link">
    <span class="md-ellipsis">
      Create Relationships
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run-the-program" class="md-nav__link">
    <span class="md-ellipsis">
      Run the Program
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#add-relationships" class="md-nav__link">
    <span class="md-ellipsis">
      Add Relationships
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run-the-program-with-the-new-relationship" class="md-nav__link">
    <span class="md-ellipsis">
      Run the Program with the New Relationship
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#update-relationships-with-links" class="md-nav__link">
    <span class="md-ellipsis">
      Update Relationships with Links
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run-the-program-with-the-updated-relationships" class="md-nav__link">
    <span class="md-ellipsis">
      Run the Program with the Updated Relationships
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recap" class="md-nav__link">
    <span class="md-ellipsis">
      Recap
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../code-structure/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Code Structure and Multiple Files
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_7_17" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../readyapi/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    ReadyAPI and Pydantic - Intro
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_7_17" id="__nav_3_7_17_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_7_17_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_7_17">
            <span class="md-nav__icon md-icon"></span>
            ReadyAPI and Pydantic - Intro
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../readyapi/simple-hero-api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Simple Hero API with ReadyAPI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../readyapi/response-model/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ReadyAPI Response Model with SQLDev
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../readyapi/multiple-models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multiple Models with ReadyAPI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../readyapi/read-one/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Read One Model with ReadyAPI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../readyapi/limit-and-offset/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Read Heroes with Limit and Offset with ReadyAPI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../readyapi/update/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Update Data with ReadyAPI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../readyapi/update-extra-data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Update with Extra Data (Hashed Passwords) with ReadyAPI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../readyapi/delete/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Delete Data with ReadyAPI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../readyapi/session-with-dependency/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Session with ReadyAPI Dependency
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../readyapi/teams/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ReadyAPI Path Operations for Teams - Other Models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../readyapi/relationships/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Models with Relationships in ReadyAPI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../readyapi/tests/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test Applications with ReadyAPI and SQLDev
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_8" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../advanced/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Advanced User Guide
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_8" id="__nav_3_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_8">
            <span class="md-nav__icon md-icon"></span>
            Advanced User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../advanced/decimal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Decimal Numbers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../advanced/uuid/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UUID (Universally Unique Identifiers)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../resources/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Resources
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Resources
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../help/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Help SQLDev - Get Help
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../management-tasks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Repository Management Tasks
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../about/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    About
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            About
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../alternatives/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Alternatives, Inspiration and Comparisons
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../management/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Repository Management
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../release-notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Release Notes
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#link-model-with-two-one-to-many" class="md-nav__link">
    <span class="md-ellipsis">
      Link Model with Two One-to-Many
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#update-link-model" class="md-nav__link">
    <span class="md-ellipsis">
      Update Link Model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#update-team-model" class="md-nav__link">
    <span class="md-ellipsis">
      Update Team Model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#update-hero-model" class="md-nav__link">
    <span class="md-ellipsis">
      Update Hero Model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-relationships" class="md-nav__link">
    <span class="md-ellipsis">
      Create Relationships
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run-the-program" class="md-nav__link">
    <span class="md-ellipsis">
      Run the Program
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#add-relationships" class="md-nav__link">
    <span class="md-ellipsis">
      Add Relationships
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run-the-program-with-the-new-relationship" class="md-nav__link">
    <span class="md-ellipsis">
      Run the Program with the New Relationship
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#update-relationships-with-links" class="md-nav__link">
    <span class="md-ellipsis">
      Update Relationships with Links
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run-the-program-with-the-updated-relationships" class="md-nav__link">
    <span class="md-ellipsis">
      Run the Program with the Updated Relationships
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recap" class="md-nav__link">
    <span class="md-ellipsis">
      Recap
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="link-model-with-extra-fields">Link Model with Extra Fields<a class="headerlink" href="#link-model-with-extra-fields" title="Permanent link">&para;</a></h1>
<p>In the previous example we never interacted directly with the <code>HeroTeamLink</code> model, it was all through the automatic <strong>many-to-many</strong> relationship.</p>
<p>But what if we needed to have additional data to describe the link between the two models?</p>
<p>Let's say that we want to have an extra field/column to say if a hero <strong>is still training</strong> in that team or if they are already going on missions and stuff.</p>
<p>Let's see how to achieve that.</p>
<h2 id="link-model-with-two-one-to-many">Link Model with Two One-to-Many<a class="headerlink" href="#link-model-with-two-one-to-many" title="Permanent link">&para;</a></h2>
<p>The way to handle this is to explicitly use the link model, to be able to get and modify its data (apart from the foreign keys pointing to the two models for <code>Hero</code> and <code>Team</code>).</p>
<p>In the end, the way it works is just like two <strong>one-to-many</strong> relationships combined.</p>
<p>A row in the table <code>heroteamlink</code> points to <strong>one</strong> particular hero, but a single hero can be connected to <strong>many</strong> hero-team links, so it's <strong>one-to-many</strong>.</p>
<p>And also, the same row in the table <code>heroteamlink</code> points to <strong>one</strong> team, but a single team can be connected to <strong>many</strong> hero-team links, so it's also <strong>one-to-many</strong>.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The previous many-to-many relationship was also just two one-to-many relationships combined, but now it's going to be much more explicit.</p>
</div>
<h2 id="update-link-model">Update Link Model<a class="headerlink" href="#update-link-model" title="Permanent link">&para;</a></h2>
<p>Let's update the <code>HeroTeamLink</code> model.</p>
<p>We will add a new field <code>is_training</code>.</p>
<p>And we will also add two <strong>relationship attributes</strong>, for the linked <code>team</code> and <code>hero</code>:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:3"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><input id="__tabbed_1_3" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">Python 3.10+</label><label for="__tabbed_1_2">Python 3.9+</label><label for="__tabbed_1_3">Python 3.7+</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-0-1"><span class="c1"># Code above omitted 👆</span>
</span><span id="__span-0-2">
</span><span id="__span-0-3"><span class="k">class</span> <span class="nc">HeroTeamLink</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-0-4">    <span class="n">team_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-5">    <span class="n">hero_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;hero.id&quot;</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-6"><span class="hll">    <span class="n">is_training</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span></span><span id="__span-0-7">
</span><span id="__span-0-8"><span class="hll">    <span class="n">team</span><span class="p">:</span> <span class="s2">&quot;Team&quot;</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;hero_links&quot;</span><span class="p">)</span>
</span></span><span id="__span-0-9"><span class="hll">    <span class="n">hero</span><span class="p">:</span> <span class="s2">&quot;Hero&quot;</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team_links&quot;</span><span class="p">)</span>
</span></span><span id="__span-0-10">
</span><span id="__span-0-11"><span class="c1"># Code below omitted 👇</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-1-1"><span class="c1"># Code above omitted 👆</span>
</span><span id="__span-1-2">
</span><span id="__span-1-3"><span class="k">class</span> <span class="nc">HeroTeamLink</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-1-4">    <span class="n">team_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
</span><span id="__span-1-5">        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-1-6">    <span class="p">)</span>
</span><span id="__span-1-7">    <span class="n">hero_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
</span><span id="__span-1-8">        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;hero.id&quot;</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-1-9">    <span class="p">)</span>
</span><span id="__span-1-10"><span class="hll">    <span class="n">is_training</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span></span><span id="__span-1-11">
</span><span id="__span-1-12"><span class="hll">    <span class="n">team</span><span class="p">:</span> <span class="s2">&quot;Team&quot;</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;hero_links&quot;</span><span class="p">)</span>
</span></span><span id="__span-1-13"><span class="hll">    <span class="n">hero</span><span class="p">:</span> <span class="s2">&quot;Hero&quot;</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team_links&quot;</span><span class="p">)</span>
</span></span><span id="__span-1-14">
</span><span id="__span-1-15"><span class="c1"># Code below omitted 👇</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-2-1"><span class="c1"># Code above omitted 👆</span>
</span><span id="__span-2-2">
</span><span id="__span-2-3"><span class="k">class</span> <span class="nc">HeroTeamLink</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-2-4">    <span class="n">team_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
</span><span id="__span-2-5">        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-2-6">    <span class="p">)</span>
</span><span id="__span-2-7">    <span class="n">hero_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
</span><span id="__span-2-8">        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;hero.id&quot;</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-2-9">    <span class="p">)</span>
</span><span id="__span-2-10"><span class="hll">    <span class="n">is_training</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span></span><span id="__span-2-11">
</span><span id="__span-2-12"><span class="hll">    <span class="n">team</span><span class="p">:</span> <span class="s2">&quot;Team&quot;</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;hero_links&quot;</span><span class="p">)</span>
</span></span><span id="__span-2-13"><span class="hll">    <span class="n">hero</span><span class="p">:</span> <span class="s2">&quot;Hero&quot;</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team_links&quot;</span><span class="p">)</span>
</span></span><span id="__span-2-14">
</span><span id="__span-2-15"><span class="c1"># Code below omitted 👇</span>
</span></code></pre></div>
</div>
</div>
</div>
<details>
<summary>👀 Full file preview</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="2:3"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><input id="__tabbed_2_3" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">Python 3.10+</label><label for="__tabbed_2_2">Python 3.9+</label><label for="__tabbed_2_3">Python 3.7+</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-3-1"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">select</span>
</span><span id="__span-3-2">
</span><span id="__span-3-3">
</span><span id="__span-3-4"><span class="k">class</span> <span class="nc">HeroTeamLink</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-3-5">    <span class="n">team_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-3-6">    <span class="n">hero_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;hero.id&quot;</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-3-7">    <span class="n">is_training</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-3-8">
</span><span id="__span-3-9">    <span class="n">team</span><span class="p">:</span> <span class="s2">&quot;Team&quot;</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;hero_links&quot;</span><span class="p">)</span>
</span><span id="__span-3-10">    <span class="n">hero</span><span class="p">:</span> <span class="s2">&quot;Hero&quot;</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team_links&quot;</span><span class="p">)</span>
</span><span id="__span-3-11">
</span><span id="__span-3-12">
</span><span id="__span-3-13"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-3-14">    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-3-15">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-3-16">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-3-17">
</span><span id="__span-3-18">    <span class="n">hero_links</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">HeroTeamLink</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team&quot;</span><span class="p">)</span>
</span><span id="__span-3-19">
</span><span id="__span-3-20">
</span><span id="__span-3-21"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-3-22">    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-3-23">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-3-24">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-3-25">    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-3-26">
</span><span id="__span-3-27">    <span class="n">team_links</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">HeroTeamLink</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;hero&quot;</span><span class="p">)</span>
</span><span id="__span-3-28">
</span><span id="__span-3-29">
</span><span id="__span-3-30"><span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
</span><span id="__span-3-31"><span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-3-32">
</span><span id="__span-3-33"><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-3-34">
</span><span id="__span-3-35">
</span><span id="__span-3-36"><span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
</span><span id="__span-3-37">    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
</span><span id="__span-3-38">
</span><span id="__span-3-39">
</span><span id="__span-3-40"><span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
</span><span id="__span-3-41">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-3-42">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Preventers&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sharp Tower&quot;</span><span class="p">)</span>
</span><span id="__span-3-43">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Z-Force&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sister Margaret&#39;s Bar&quot;</span><span class="p">)</span>
</span><span id="__span-3-44">
</span><span id="__span-3-45">        <span class="n">hero_deadpond</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-3-46">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span>
</span><span id="__span-3-47">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Dive Wilson&quot;</span><span class="p">,</span>
</span><span id="__span-3-48">        <span class="p">)</span>
</span><span id="__span-3-49">        <span class="n">hero_rusty_man</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-3-50">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span>
</span><span id="__span-3-51">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span>
</span><span id="__span-3-52">            <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span>
</span><span id="__span-3-53">        <span class="p">)</span>
</span><span id="__span-3-54">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-3-55">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span>
</span><span id="__span-3-56">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">,</span>
</span><span id="__span-3-57">        <span class="p">)</span>
</span><span id="__span-3-58">        <span class="n">deadpond_team_z_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span><span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-3-59">        <span class="n">deadpond_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-3-60">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_deadpond</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-3-61">        <span class="p">)</span>
</span><span id="__span-3-62">        <span class="n">spider_boy_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-3-63">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_spider_boy</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-3-64">        <span class="p">)</span>
</span><span id="__span-3-65">        <span class="n">rusty_man_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-3-66">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_rusty_man</span>
</span><span id="__span-3-67">        <span class="p">)</span>
</span><span id="__span-3-68">
</span><span id="__span-3-69">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">deadpond_team_z_link</span><span class="p">)</span>
</span><span id="__span-3-70">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">deadpond_preventers_link</span><span class="p">)</span>
</span><span id="__span-3-71">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">spider_boy_preventers_link</span><span class="p">)</span>
</span><span id="__span-3-72">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rusty_man_preventers_link</span><span class="p">)</span>
</span><span id="__span-3-73">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-3-74">
</span><span id="__span-3-75">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="p">:</span>
</span><span id="__span-3-76">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Z-Force hero:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">hero</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-3-77">
</span><span id="__span-3-78">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">team_preventers</span><span class="o">.</span><span class="n">hero_links</span><span class="p">:</span>
</span><span id="__span-3-79">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers hero:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">hero</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-3-80">
</span><span id="__span-3-81">
</span><span id="__span-3-82"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-3-83">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-3-84">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-3-85">            <span class="n">select</span><span class="p">(</span><span class="n">Hero</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hero</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Spider-Boy&quot;</span><span class="p">)</span>
</span><span id="__span-3-86">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-3-87">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Z-Force&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-3-88">
</span><span id="__span-3-89">        <span class="n">spider_boy_z_force_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-3-90">            <span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_spider_boy</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-3-91">        <span class="p">)</span>
</span><span id="__span-3-92">        <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spider_boy_z_force_link</span><span class="p">)</span>
</span><span id="__span-3-93">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_z_force</span><span class="p">)</span>
</span><span id="__span-3-94">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-3-95">
</span><span id="__span-3-96">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Updated Spider-Boy&#39;s Teams:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">)</span>
</span><span id="__span-3-97">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Z-Force heroes:&quot;</span><span class="p">,</span> <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="p">)</span>
</span><span id="__span-3-98">
</span><span id="__span-3-99">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">:</span>
</span><span id="__span-3-100">            <span class="k">if</span> <span class="n">link</span><span class="o">.</span><span class="n">team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">:</span>
</span><span id="__span-3-101">                <span class="n">link</span><span class="o">.</span><span class="n">is_training</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-3-102">
</span><span id="__span-3-103">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-3-104">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-3-105">
</span><span id="__span-3-106">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">:</span>
</span><span id="__span-3-107">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy team:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">team</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-3-108">
</span><span id="__span-3-109">
</span><span id="__span-3-110"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span id="__span-3-111">    <span class="n">create_db_and_tables</span><span class="p">()</span>
</span><span id="__span-3-112">    <span class="n">create_heroes</span><span class="p">()</span>
</span><span id="__span-3-113">    <span class="n">update_heroes</span><span class="p">()</span>
</span><span id="__span-3-114">
</span><span id="__span-3-115">
</span><span id="__span-3-116"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-3-117">    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-4-1"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>
</span><span id="__span-4-2">
</span><span id="__span-4-3"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">select</span>
</span><span id="__span-4-4">
</span><span id="__span-4-5">
</span><span id="__span-4-6"><span class="k">class</span> <span class="nc">HeroTeamLink</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-4-7">    <span class="n">team_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
</span><span id="__span-4-8">        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-4-9">    <span class="p">)</span>
</span><span id="__span-4-10">    <span class="n">hero_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
</span><span id="__span-4-11">        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;hero.id&quot;</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-4-12">    <span class="p">)</span>
</span><span id="__span-4-13">    <span class="n">is_training</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-4-14">
</span><span id="__span-4-15">    <span class="n">team</span><span class="p">:</span> <span class="s2">&quot;Team&quot;</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;hero_links&quot;</span><span class="p">)</span>
</span><span id="__span-4-16">    <span class="n">hero</span><span class="p">:</span> <span class="s2">&quot;Hero&quot;</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team_links&quot;</span><span class="p">)</span>
</span><span id="__span-4-17">
</span><span id="__span-4-18">
</span><span id="__span-4-19"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-4-20">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-4-21">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-4-22">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-4-23">
</span><span id="__span-4-24">    <span class="n">hero_links</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">HeroTeamLink</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team&quot;</span><span class="p">)</span>
</span><span id="__span-4-25">
</span><span id="__span-4-26">
</span><span id="__span-4-27"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-4-28">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-4-29">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-4-30">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-4-31">    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-4-32">
</span><span id="__span-4-33">    <span class="n">team_links</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">HeroTeamLink</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;hero&quot;</span><span class="p">)</span>
</span><span id="__span-4-34">
</span><span id="__span-4-35">
</span><span id="__span-4-36"><span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
</span><span id="__span-4-37"><span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-4-38">
</span><span id="__span-4-39"><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-4-40">
</span><span id="__span-4-41">
</span><span id="__span-4-42"><span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
</span><span id="__span-4-43">    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
</span><span id="__span-4-44">
</span><span id="__span-4-45">
</span><span id="__span-4-46"><span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
</span><span id="__span-4-47">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-4-48">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Preventers&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sharp Tower&quot;</span><span class="p">)</span>
</span><span id="__span-4-49">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Z-Force&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sister Margaret&#39;s Bar&quot;</span><span class="p">)</span>
</span><span id="__span-4-50">
</span><span id="__span-4-51">        <span class="n">hero_deadpond</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-4-52">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span>
</span><span id="__span-4-53">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Dive Wilson&quot;</span><span class="p">,</span>
</span><span id="__span-4-54">        <span class="p">)</span>
</span><span id="__span-4-55">        <span class="n">hero_rusty_man</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-4-56">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span>
</span><span id="__span-4-57">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span>
</span><span id="__span-4-58">            <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span>
</span><span id="__span-4-59">        <span class="p">)</span>
</span><span id="__span-4-60">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-4-61">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span>
</span><span id="__span-4-62">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">,</span>
</span><span id="__span-4-63">        <span class="p">)</span>
</span><span id="__span-4-64">        <span class="n">deadpond_team_z_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span><span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-4-65">        <span class="n">deadpond_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-4-66">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_deadpond</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-4-67">        <span class="p">)</span>
</span><span id="__span-4-68">        <span class="n">spider_boy_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-4-69">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_spider_boy</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-4-70">        <span class="p">)</span>
</span><span id="__span-4-71">        <span class="n">rusty_man_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-4-72">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_rusty_man</span>
</span><span id="__span-4-73">        <span class="p">)</span>
</span><span id="__span-4-74">
</span><span id="__span-4-75">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">deadpond_team_z_link</span><span class="p">)</span>
</span><span id="__span-4-76">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">deadpond_preventers_link</span><span class="p">)</span>
</span><span id="__span-4-77">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">spider_boy_preventers_link</span><span class="p">)</span>
</span><span id="__span-4-78">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rusty_man_preventers_link</span><span class="p">)</span>
</span><span id="__span-4-79">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-4-80">
</span><span id="__span-4-81">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="p">:</span>
</span><span id="__span-4-82">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Z-Force hero:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">hero</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-4-83">
</span><span id="__span-4-84">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">team_preventers</span><span class="o">.</span><span class="n">hero_links</span><span class="p">:</span>
</span><span id="__span-4-85">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers hero:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">hero</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-4-86">
</span><span id="__span-4-87">
</span><span id="__span-4-88"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-4-89">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-4-90">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-4-91">            <span class="n">select</span><span class="p">(</span><span class="n">Hero</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hero</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Spider-Boy&quot;</span><span class="p">)</span>
</span><span id="__span-4-92">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-4-93">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Z-Force&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-4-94">
</span><span id="__span-4-95">        <span class="n">spider_boy_z_force_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-4-96">            <span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_spider_boy</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-4-97">        <span class="p">)</span>
</span><span id="__span-4-98">        <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spider_boy_z_force_link</span><span class="p">)</span>
</span><span id="__span-4-99">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_z_force</span><span class="p">)</span>
</span><span id="__span-4-100">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-4-101">
</span><span id="__span-4-102">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Updated Spider-Boy&#39;s Teams:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">)</span>
</span><span id="__span-4-103">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Z-Force heroes:&quot;</span><span class="p">,</span> <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="p">)</span>
</span><span id="__span-4-104">
</span><span id="__span-4-105">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">:</span>
</span><span id="__span-4-106">            <span class="k">if</span> <span class="n">link</span><span class="o">.</span><span class="n">team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">:</span>
</span><span id="__span-4-107">                <span class="n">link</span><span class="o">.</span><span class="n">is_training</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-4-108">
</span><span id="__span-4-109">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-4-110">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-4-111">
</span><span id="__span-4-112">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">:</span>
</span><span id="__span-4-113">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy team:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">team</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-4-114">
</span><span id="__span-4-115">
</span><span id="__span-4-116"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span id="__span-4-117">    <span class="n">create_db_and_tables</span><span class="p">()</span>
</span><span id="__span-4-118">    <span class="n">create_heroes</span><span class="p">()</span>
</span><span id="__span-4-119">    <span class="n">update_heroes</span><span class="p">()</span>
</span><span id="__span-4-120">
</span><span id="__span-4-121">
</span><span id="__span-4-122"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-4-123">    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-5-1"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span>
</span><span id="__span-5-2">
</span><span id="__span-5-3"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">select</span>
</span><span id="__span-5-4">
</span><span id="__span-5-5">
</span><span id="__span-5-6"><span class="k">class</span> <span class="nc">HeroTeamLink</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-5-7">    <span class="n">team_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
</span><span id="__span-5-8">        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-5-9">    <span class="p">)</span>
</span><span id="__span-5-10">    <span class="n">hero_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
</span><span id="__span-5-11">        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;hero.id&quot;</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-5-12">    <span class="p">)</span>
</span><span id="__span-5-13">    <span class="n">is_training</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-5-14">
</span><span id="__span-5-15">    <span class="n">team</span><span class="p">:</span> <span class="s2">&quot;Team&quot;</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;hero_links&quot;</span><span class="p">)</span>
</span><span id="__span-5-16">    <span class="n">hero</span><span class="p">:</span> <span class="s2">&quot;Hero&quot;</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team_links&quot;</span><span class="p">)</span>
</span><span id="__span-5-17">
</span><span id="__span-5-18">
</span><span id="__span-5-19"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-5-20">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-5-21">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-5-22">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-5-23">
</span><span id="__span-5-24">    <span class="n">hero_links</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">HeroTeamLink</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team&quot;</span><span class="p">)</span>
</span><span id="__span-5-25">
</span><span id="__span-5-26">
</span><span id="__span-5-27"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-5-28">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-5-29">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-5-30">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-5-31">    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-5-32">
</span><span id="__span-5-33">    <span class="n">team_links</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">HeroTeamLink</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;hero&quot;</span><span class="p">)</span>
</span><span id="__span-5-34">
</span><span id="__span-5-35">
</span><span id="__span-5-36"><span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
</span><span id="__span-5-37"><span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-5-38">
</span><span id="__span-5-39"><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-5-40">
</span><span id="__span-5-41">
</span><span id="__span-5-42"><span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
</span><span id="__span-5-43">    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
</span><span id="__span-5-44">
</span><span id="__span-5-45">
</span><span id="__span-5-46"><span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
</span><span id="__span-5-47">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-5-48">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Preventers&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sharp Tower&quot;</span><span class="p">)</span>
</span><span id="__span-5-49">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Z-Force&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sister Margaret&#39;s Bar&quot;</span><span class="p">)</span>
</span><span id="__span-5-50">
</span><span id="__span-5-51">        <span class="n">hero_deadpond</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-5-52">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span>
</span><span id="__span-5-53">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Dive Wilson&quot;</span><span class="p">,</span>
</span><span id="__span-5-54">        <span class="p">)</span>
</span><span id="__span-5-55">        <span class="n">hero_rusty_man</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-5-56">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span>
</span><span id="__span-5-57">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span>
</span><span id="__span-5-58">            <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span>
</span><span id="__span-5-59">        <span class="p">)</span>
</span><span id="__span-5-60">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-5-61">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span>
</span><span id="__span-5-62">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">,</span>
</span><span id="__span-5-63">        <span class="p">)</span>
</span><span id="__span-5-64">        <span class="n">deadpond_team_z_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span><span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-5-65">        <span class="n">deadpond_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-5-66">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_deadpond</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-5-67">        <span class="p">)</span>
</span><span id="__span-5-68">        <span class="n">spider_boy_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-5-69">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_spider_boy</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-5-70">        <span class="p">)</span>
</span><span id="__span-5-71">        <span class="n">rusty_man_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-5-72">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_rusty_man</span>
</span><span id="__span-5-73">        <span class="p">)</span>
</span><span id="__span-5-74">
</span><span id="__span-5-75">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">deadpond_team_z_link</span><span class="p">)</span>
</span><span id="__span-5-76">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">deadpond_preventers_link</span><span class="p">)</span>
</span><span id="__span-5-77">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">spider_boy_preventers_link</span><span class="p">)</span>
</span><span id="__span-5-78">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rusty_man_preventers_link</span><span class="p">)</span>
</span><span id="__span-5-79">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-5-80">
</span><span id="__span-5-81">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="p">:</span>
</span><span id="__span-5-82">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Z-Force hero:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">hero</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-5-83">
</span><span id="__span-5-84">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">team_preventers</span><span class="o">.</span><span class="n">hero_links</span><span class="p">:</span>
</span><span id="__span-5-85">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers hero:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">hero</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-5-86">
</span><span id="__span-5-87">
</span><span id="__span-5-88"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-5-89">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-5-90">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-5-91">            <span class="n">select</span><span class="p">(</span><span class="n">Hero</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hero</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Spider-Boy&quot;</span><span class="p">)</span>
</span><span id="__span-5-92">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-5-93">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Z-Force&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-5-94">
</span><span id="__span-5-95">        <span class="n">spider_boy_z_force_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-5-96">            <span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_spider_boy</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-5-97">        <span class="p">)</span>
</span><span id="__span-5-98">        <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spider_boy_z_force_link</span><span class="p">)</span>
</span><span id="__span-5-99">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_z_force</span><span class="p">)</span>
</span><span id="__span-5-100">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-5-101">
</span><span id="__span-5-102">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Updated Spider-Boy&#39;s Teams:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">)</span>
</span><span id="__span-5-103">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Z-Force heroes:&quot;</span><span class="p">,</span> <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="p">)</span>
</span><span id="__span-5-104">
</span><span id="__span-5-105">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">:</span>
</span><span id="__span-5-106">            <span class="k">if</span> <span class="n">link</span><span class="o">.</span><span class="n">team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">:</span>
</span><span id="__span-5-107">                <span class="n">link</span><span class="o">.</span><span class="n">is_training</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-5-108">
</span><span id="__span-5-109">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-5-110">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-5-111">
</span><span id="__span-5-112">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">:</span>
</span><span id="__span-5-113">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy team:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">team</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-5-114">
</span><span id="__span-5-115">
</span><span id="__span-5-116"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span id="__span-5-117">    <span class="n">create_db_and_tables</span><span class="p">()</span>
</span><span id="__span-5-118">    <span class="n">create_heroes</span><span class="p">()</span>
</span><span id="__span-5-119">    <span class="n">update_heroes</span><span class="p">()</span>
</span><span id="__span-5-120">
</span><span id="__span-5-121">
</span><span id="__span-5-122"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-5-123">    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div>
</div>
</div>
</div>
</details>
<p>The new <strong>relationship attributes</strong> have their own <code>back_populates</code> pointing to new relationship attributes we will create in the <code>Hero</code> and <code>Team</code> models:</p>
<ul>
<li><code>team</code>: has <code>back_populates="hero_links"</code>, because in the <code>Team</code> model, the attribute will contain the links to the <strong>team's heroes</strong>.</li>
<li><code>hero</code>: has <code>back_populates="team_links"</code>, because in the <code>Hero</code> model, the attribute will contain the links to the <strong>hero's teams</strong>.</li>
</ul>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>In SQLAlchemy this is called an Association Object or Association Model.</p>
<p>I'm calling it <strong>Link Model</strong> just because that's easier to write avoiding typos. But you are also free to call it however you want. 😉</p>
</div>
<h2 id="update-team-model">Update Team Model<a class="headerlink" href="#update-team-model" title="Permanent link">&para;</a></h2>
<p>Now let's update the <code>Team</code> model.</p>
<p>We no longer have the <code>heroes</code> relationship attribute, and instead we have the new <code>hero_links</code> attribute:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:3"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><input id="__tabbed_3_2" name="__tabbed_3" type="radio" /><input id="__tabbed_3_3" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="__tabbed_3_1">Python 3.10+</label><label for="__tabbed_3_2">Python 3.9+</label><label for="__tabbed_3_3">Python 3.7+</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-6-1"><span class="c1"># Code above omitted 👆</span>
</span><span id="__span-6-2">
</span><span id="__span-6-3"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-6-4">    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-6-5">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-6-6">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-6-7">
</span><span id="__span-6-8"><span class="hll">    <span class="n">hero_links</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">HeroTeamLink</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team&quot;</span><span class="p">)</span>
</span></span><span id="__span-6-9">
</span><span id="__span-6-10"><span class="c1"># Code below omitted 👇</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-7-1"><span class="c1"># Code above omitted 👆</span>
</span><span id="__span-7-2">
</span><span id="__span-7-3"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-7-4">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-7-5">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-7-6">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-7-7">
</span><span id="__span-7-8"><span class="hll">    <span class="n">hero_links</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">HeroTeamLink</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team&quot;</span><span class="p">)</span>
</span></span><span id="__span-7-9">
</span><span id="__span-7-10"><span class="c1"># Code below omitted 👇</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-8-1"><span class="c1"># Code above omitted 👆</span>
</span><span id="__span-8-2">
</span><span id="__span-8-3"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-8-4">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-8-5">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-8-6">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-8-7">
</span><span id="__span-8-8"><span class="hll">    <span class="n">hero_links</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">HeroTeamLink</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team&quot;</span><span class="p">)</span>
</span></span><span id="__span-8-9">
</span><span id="__span-8-10"><span class="c1"># Code below omitted 👇</span>
</span></code></pre></div>
</div>
</div>
</div>
<details>
<summary>👀 Full file preview</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="4:3"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><input id="__tabbed_4_2" name="__tabbed_4" type="radio" /><input id="__tabbed_4_3" name="__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="__tabbed_4_1">Python 3.10+</label><label for="__tabbed_4_2">Python 3.9+</label><label for="__tabbed_4_3">Python 3.7+</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-9-1"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">select</span>
</span><span id="__span-9-2">
</span><span id="__span-9-3">
</span><span id="__span-9-4"><span class="k">class</span> <span class="nc">HeroTeamLink</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-9-5">    <span class="n">team_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-9-6">    <span class="n">hero_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;hero.id&quot;</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-9-7">    <span class="n">is_training</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-9-8">
</span><span id="__span-9-9">    <span class="n">team</span><span class="p">:</span> <span class="s2">&quot;Team&quot;</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;hero_links&quot;</span><span class="p">)</span>
</span><span id="__span-9-10">    <span class="n">hero</span><span class="p">:</span> <span class="s2">&quot;Hero&quot;</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team_links&quot;</span><span class="p">)</span>
</span><span id="__span-9-11">
</span><span id="__span-9-12">
</span><span id="__span-9-13"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-9-14">    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-9-15">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-9-16">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-9-17">
</span><span id="__span-9-18">    <span class="n">hero_links</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">HeroTeamLink</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team&quot;</span><span class="p">)</span>
</span><span id="__span-9-19">
</span><span id="__span-9-20">
</span><span id="__span-9-21"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-9-22">    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-9-23">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-9-24">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-9-25">    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-9-26">
</span><span id="__span-9-27">    <span class="n">team_links</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">HeroTeamLink</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;hero&quot;</span><span class="p">)</span>
</span><span id="__span-9-28">
</span><span id="__span-9-29">
</span><span id="__span-9-30"><span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
</span><span id="__span-9-31"><span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-9-32">
</span><span id="__span-9-33"><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-9-34">
</span><span id="__span-9-35">
</span><span id="__span-9-36"><span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
</span><span id="__span-9-37">    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
</span><span id="__span-9-38">
</span><span id="__span-9-39">
</span><span id="__span-9-40"><span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
</span><span id="__span-9-41">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-9-42">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Preventers&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sharp Tower&quot;</span><span class="p">)</span>
</span><span id="__span-9-43">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Z-Force&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sister Margaret&#39;s Bar&quot;</span><span class="p">)</span>
</span><span id="__span-9-44">
</span><span id="__span-9-45">        <span class="n">hero_deadpond</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-9-46">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span>
</span><span id="__span-9-47">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Dive Wilson&quot;</span><span class="p">,</span>
</span><span id="__span-9-48">        <span class="p">)</span>
</span><span id="__span-9-49">        <span class="n">hero_rusty_man</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-9-50">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span>
</span><span id="__span-9-51">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span>
</span><span id="__span-9-52">            <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span>
</span><span id="__span-9-53">        <span class="p">)</span>
</span><span id="__span-9-54">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-9-55">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span>
</span><span id="__span-9-56">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">,</span>
</span><span id="__span-9-57">        <span class="p">)</span>
</span><span id="__span-9-58">        <span class="n">deadpond_team_z_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span><span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-9-59">        <span class="n">deadpond_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-9-60">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_deadpond</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-9-61">        <span class="p">)</span>
</span><span id="__span-9-62">        <span class="n">spider_boy_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-9-63">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_spider_boy</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-9-64">        <span class="p">)</span>
</span><span id="__span-9-65">        <span class="n">rusty_man_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-9-66">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_rusty_man</span>
</span><span id="__span-9-67">        <span class="p">)</span>
</span><span id="__span-9-68">
</span><span id="__span-9-69">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">deadpond_team_z_link</span><span class="p">)</span>
</span><span id="__span-9-70">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">deadpond_preventers_link</span><span class="p">)</span>
</span><span id="__span-9-71">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">spider_boy_preventers_link</span><span class="p">)</span>
</span><span id="__span-9-72">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rusty_man_preventers_link</span><span class="p">)</span>
</span><span id="__span-9-73">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-9-74">
</span><span id="__span-9-75">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="p">:</span>
</span><span id="__span-9-76">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Z-Force hero:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">hero</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-9-77">
</span><span id="__span-9-78">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">team_preventers</span><span class="o">.</span><span class="n">hero_links</span><span class="p">:</span>
</span><span id="__span-9-79">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers hero:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">hero</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-9-80">
</span><span id="__span-9-81">
</span><span id="__span-9-82"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-9-83">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-9-84">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-9-85">            <span class="n">select</span><span class="p">(</span><span class="n">Hero</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hero</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Spider-Boy&quot;</span><span class="p">)</span>
</span><span id="__span-9-86">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-9-87">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Z-Force&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-9-88">
</span><span id="__span-9-89">        <span class="n">spider_boy_z_force_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-9-90">            <span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_spider_boy</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-9-91">        <span class="p">)</span>
</span><span id="__span-9-92">        <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spider_boy_z_force_link</span><span class="p">)</span>
</span><span id="__span-9-93">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_z_force</span><span class="p">)</span>
</span><span id="__span-9-94">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-9-95">
</span><span id="__span-9-96">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Updated Spider-Boy&#39;s Teams:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">)</span>
</span><span id="__span-9-97">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Z-Force heroes:&quot;</span><span class="p">,</span> <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="p">)</span>
</span><span id="__span-9-98">
</span><span id="__span-9-99">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">:</span>
</span><span id="__span-9-100">            <span class="k">if</span> <span class="n">link</span><span class="o">.</span><span class="n">team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">:</span>
</span><span id="__span-9-101">                <span class="n">link</span><span class="o">.</span><span class="n">is_training</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-9-102">
</span><span id="__span-9-103">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-9-104">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-9-105">
</span><span id="__span-9-106">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">:</span>
</span><span id="__span-9-107">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy team:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">team</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-9-108">
</span><span id="__span-9-109">
</span><span id="__span-9-110"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span id="__span-9-111">    <span class="n">create_db_and_tables</span><span class="p">()</span>
</span><span id="__span-9-112">    <span class="n">create_heroes</span><span class="p">()</span>
</span><span id="__span-9-113">    <span class="n">update_heroes</span><span class="p">()</span>
</span><span id="__span-9-114">
</span><span id="__span-9-115">
</span><span id="__span-9-116"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-9-117">    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-10-1"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>
</span><span id="__span-10-2">
</span><span id="__span-10-3"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">select</span>
</span><span id="__span-10-4">
</span><span id="__span-10-5">
</span><span id="__span-10-6"><span class="k">class</span> <span class="nc">HeroTeamLink</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-10-7">    <span class="n">team_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
</span><span id="__span-10-8">        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-10-9">    <span class="p">)</span>
</span><span id="__span-10-10">    <span class="n">hero_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
</span><span id="__span-10-11">        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;hero.id&quot;</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-10-12">    <span class="p">)</span>
</span><span id="__span-10-13">    <span class="n">is_training</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-10-14">
</span><span id="__span-10-15">    <span class="n">team</span><span class="p">:</span> <span class="s2">&quot;Team&quot;</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;hero_links&quot;</span><span class="p">)</span>
</span><span id="__span-10-16">    <span class="n">hero</span><span class="p">:</span> <span class="s2">&quot;Hero&quot;</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team_links&quot;</span><span class="p">)</span>
</span><span id="__span-10-17">
</span><span id="__span-10-18">
</span><span id="__span-10-19"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-10-20">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-10-21">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-10-22">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-10-23">
</span><span id="__span-10-24">    <span class="n">hero_links</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">HeroTeamLink</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team&quot;</span><span class="p">)</span>
</span><span id="__span-10-25">
</span><span id="__span-10-26">
</span><span id="__span-10-27"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-10-28">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-10-29">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-10-30">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-10-31">    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-10-32">
</span><span id="__span-10-33">    <span class="n">team_links</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">HeroTeamLink</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;hero&quot;</span><span class="p">)</span>
</span><span id="__span-10-34">
</span><span id="__span-10-35">
</span><span id="__span-10-36"><span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
</span><span id="__span-10-37"><span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-10-38">
</span><span id="__span-10-39"><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-10-40">
</span><span id="__span-10-41">
</span><span id="__span-10-42"><span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
</span><span id="__span-10-43">    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
</span><span id="__span-10-44">
</span><span id="__span-10-45">
</span><span id="__span-10-46"><span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
</span><span id="__span-10-47">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-10-48">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Preventers&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sharp Tower&quot;</span><span class="p">)</span>
</span><span id="__span-10-49">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Z-Force&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sister Margaret&#39;s Bar&quot;</span><span class="p">)</span>
</span><span id="__span-10-50">
</span><span id="__span-10-51">        <span class="n">hero_deadpond</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-10-52">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span>
</span><span id="__span-10-53">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Dive Wilson&quot;</span><span class="p">,</span>
</span><span id="__span-10-54">        <span class="p">)</span>
</span><span id="__span-10-55">        <span class="n">hero_rusty_man</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-10-56">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span>
</span><span id="__span-10-57">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span>
</span><span id="__span-10-58">            <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span>
</span><span id="__span-10-59">        <span class="p">)</span>
</span><span id="__span-10-60">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-10-61">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span>
</span><span id="__span-10-62">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">,</span>
</span><span id="__span-10-63">        <span class="p">)</span>
</span><span id="__span-10-64">        <span class="n">deadpond_team_z_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span><span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-10-65">        <span class="n">deadpond_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-10-66">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_deadpond</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-10-67">        <span class="p">)</span>
</span><span id="__span-10-68">        <span class="n">spider_boy_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-10-69">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_spider_boy</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-10-70">        <span class="p">)</span>
</span><span id="__span-10-71">        <span class="n">rusty_man_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-10-72">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_rusty_man</span>
</span><span id="__span-10-73">        <span class="p">)</span>
</span><span id="__span-10-74">
</span><span id="__span-10-75">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">deadpond_team_z_link</span><span class="p">)</span>
</span><span id="__span-10-76">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">deadpond_preventers_link</span><span class="p">)</span>
</span><span id="__span-10-77">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">spider_boy_preventers_link</span><span class="p">)</span>
</span><span id="__span-10-78">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rusty_man_preventers_link</span><span class="p">)</span>
</span><span id="__span-10-79">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-10-80">
</span><span id="__span-10-81">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="p">:</span>
</span><span id="__span-10-82">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Z-Force hero:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">hero</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-10-83">
</span><span id="__span-10-84">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">team_preventers</span><span class="o">.</span><span class="n">hero_links</span><span class="p">:</span>
</span><span id="__span-10-85">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers hero:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">hero</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-10-86">
</span><span id="__span-10-87">
</span><span id="__span-10-88"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-10-89">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-10-90">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-10-91">            <span class="n">select</span><span class="p">(</span><span class="n">Hero</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hero</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Spider-Boy&quot;</span><span class="p">)</span>
</span><span id="__span-10-92">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-10-93">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Z-Force&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-10-94">
</span><span id="__span-10-95">        <span class="n">spider_boy_z_force_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-10-96">            <span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_spider_boy</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-10-97">        <span class="p">)</span>
</span><span id="__span-10-98">        <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spider_boy_z_force_link</span><span class="p">)</span>
</span><span id="__span-10-99">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_z_force</span><span class="p">)</span>
</span><span id="__span-10-100">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-10-101">
</span><span id="__span-10-102">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Updated Spider-Boy&#39;s Teams:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">)</span>
</span><span id="__span-10-103">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Z-Force heroes:&quot;</span><span class="p">,</span> <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="p">)</span>
</span><span id="__span-10-104">
</span><span id="__span-10-105">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">:</span>
</span><span id="__span-10-106">            <span class="k">if</span> <span class="n">link</span><span class="o">.</span><span class="n">team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">:</span>
</span><span id="__span-10-107">                <span class="n">link</span><span class="o">.</span><span class="n">is_training</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-10-108">
</span><span id="__span-10-109">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-10-110">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-10-111">
</span><span id="__span-10-112">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">:</span>
</span><span id="__span-10-113">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy team:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">team</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-10-114">
</span><span id="__span-10-115">
</span><span id="__span-10-116"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span id="__span-10-117">    <span class="n">create_db_and_tables</span><span class="p">()</span>
</span><span id="__span-10-118">    <span class="n">create_heroes</span><span class="p">()</span>
</span><span id="__span-10-119">    <span class="n">update_heroes</span><span class="p">()</span>
</span><span id="__span-10-120">
</span><span id="__span-10-121">
</span><span id="__span-10-122"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-10-123">    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-11-1"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span>
</span><span id="__span-11-2">
</span><span id="__span-11-3"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">select</span>
</span><span id="__span-11-4">
</span><span id="__span-11-5">
</span><span id="__span-11-6"><span class="k">class</span> <span class="nc">HeroTeamLink</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-11-7">    <span class="n">team_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
</span><span id="__span-11-8">        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-11-9">    <span class="p">)</span>
</span><span id="__span-11-10">    <span class="n">hero_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
</span><span id="__span-11-11">        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;hero.id&quot;</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-11-12">    <span class="p">)</span>
</span><span id="__span-11-13">    <span class="n">is_training</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-11-14">
</span><span id="__span-11-15">    <span class="n">team</span><span class="p">:</span> <span class="s2">&quot;Team&quot;</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;hero_links&quot;</span><span class="p">)</span>
</span><span id="__span-11-16">    <span class="n">hero</span><span class="p">:</span> <span class="s2">&quot;Hero&quot;</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team_links&quot;</span><span class="p">)</span>
</span><span id="__span-11-17">
</span><span id="__span-11-18">
</span><span id="__span-11-19"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-11-20">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-11-21">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-11-22">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-11-23">
</span><span id="__span-11-24">    <span class="n">hero_links</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">HeroTeamLink</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team&quot;</span><span class="p">)</span>
</span><span id="__span-11-25">
</span><span id="__span-11-26">
</span><span id="__span-11-27"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-11-28">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-11-29">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-11-30">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-11-31">    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-11-32">
</span><span id="__span-11-33">    <span class="n">team_links</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">HeroTeamLink</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;hero&quot;</span><span class="p">)</span>
</span><span id="__span-11-34">
</span><span id="__span-11-35">
</span><span id="__span-11-36"><span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
</span><span id="__span-11-37"><span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-11-38">
</span><span id="__span-11-39"><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-11-40">
</span><span id="__span-11-41">
</span><span id="__span-11-42"><span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
</span><span id="__span-11-43">    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
</span><span id="__span-11-44">
</span><span id="__span-11-45">
</span><span id="__span-11-46"><span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
</span><span id="__span-11-47">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-11-48">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Preventers&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sharp Tower&quot;</span><span class="p">)</span>
</span><span id="__span-11-49">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Z-Force&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sister Margaret&#39;s Bar&quot;</span><span class="p">)</span>
</span><span id="__span-11-50">
</span><span id="__span-11-51">        <span class="n">hero_deadpond</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-11-52">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span>
</span><span id="__span-11-53">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Dive Wilson&quot;</span><span class="p">,</span>
</span><span id="__span-11-54">        <span class="p">)</span>
</span><span id="__span-11-55">        <span class="n">hero_rusty_man</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-11-56">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span>
</span><span id="__span-11-57">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span>
</span><span id="__span-11-58">            <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span>
</span><span id="__span-11-59">        <span class="p">)</span>
</span><span id="__span-11-60">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-11-61">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span>
</span><span id="__span-11-62">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">,</span>
</span><span id="__span-11-63">        <span class="p">)</span>
</span><span id="__span-11-64">        <span class="n">deadpond_team_z_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span><span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-11-65">        <span class="n">deadpond_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-11-66">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_deadpond</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-11-67">        <span class="p">)</span>
</span><span id="__span-11-68">        <span class="n">spider_boy_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-11-69">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_spider_boy</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-11-70">        <span class="p">)</span>
</span><span id="__span-11-71">        <span class="n">rusty_man_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-11-72">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_rusty_man</span>
</span><span id="__span-11-73">        <span class="p">)</span>
</span><span id="__span-11-74">
</span><span id="__span-11-75">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">deadpond_team_z_link</span><span class="p">)</span>
</span><span id="__span-11-76">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">deadpond_preventers_link</span><span class="p">)</span>
</span><span id="__span-11-77">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">spider_boy_preventers_link</span><span class="p">)</span>
</span><span id="__span-11-78">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rusty_man_preventers_link</span><span class="p">)</span>
</span><span id="__span-11-79">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-11-80">
</span><span id="__span-11-81">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="p">:</span>
</span><span id="__span-11-82">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Z-Force hero:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">hero</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-11-83">
</span><span id="__span-11-84">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">team_preventers</span><span class="o">.</span><span class="n">hero_links</span><span class="p">:</span>
</span><span id="__span-11-85">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers hero:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">hero</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-11-86">
</span><span id="__span-11-87">
</span><span id="__span-11-88"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-11-89">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-11-90">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-11-91">            <span class="n">select</span><span class="p">(</span><span class="n">Hero</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hero</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Spider-Boy&quot;</span><span class="p">)</span>
</span><span id="__span-11-92">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-11-93">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Z-Force&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-11-94">
</span><span id="__span-11-95">        <span class="n">spider_boy_z_force_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-11-96">            <span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_spider_boy</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-11-97">        <span class="p">)</span>
</span><span id="__span-11-98">        <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spider_boy_z_force_link</span><span class="p">)</span>
</span><span id="__span-11-99">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_z_force</span><span class="p">)</span>
</span><span id="__span-11-100">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-11-101">
</span><span id="__span-11-102">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Updated Spider-Boy&#39;s Teams:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">)</span>
</span><span id="__span-11-103">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Z-Force heroes:&quot;</span><span class="p">,</span> <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="p">)</span>
</span><span id="__span-11-104">
</span><span id="__span-11-105">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">:</span>
</span><span id="__span-11-106">            <span class="k">if</span> <span class="n">link</span><span class="o">.</span><span class="n">team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">:</span>
</span><span id="__span-11-107">                <span class="n">link</span><span class="o">.</span><span class="n">is_training</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-11-108">
</span><span id="__span-11-109">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-11-110">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-11-111">
</span><span id="__span-11-112">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">:</span>
</span><span id="__span-11-113">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy team:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">team</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-11-114">
</span><span id="__span-11-115">
</span><span id="__span-11-116"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span id="__span-11-117">    <span class="n">create_db_and_tables</span><span class="p">()</span>
</span><span id="__span-11-118">    <span class="n">create_heroes</span><span class="p">()</span>
</span><span id="__span-11-119">    <span class="n">update_heroes</span><span class="p">()</span>
</span><span id="__span-11-120">
</span><span id="__span-11-121">
</span><span id="__span-11-122"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-11-123">    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div>
</div>
</div>
</div>
</details>
<h2 id="update-hero-model">Update Hero Model<a class="headerlink" href="#update-hero-model" title="Permanent link">&para;</a></h2>
<p>The same with the <code>Hero</code> model.</p>
<p>We change the <code>teams</code> relationship attribute for <code>team_links</code>:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="5:3"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio" /><input id="__tabbed_5_2" name="__tabbed_5" type="radio" /><input id="__tabbed_5_3" name="__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="__tabbed_5_1">Python 3.10+</label><label for="__tabbed_5_2">Python 3.9+</label><label for="__tabbed_5_3">Python 3.7+</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-12-1"><span class="c1"># Code above omitted 👆</span>
</span><span id="__span-12-2">
</span><span id="__span-12-3"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-12-4">    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-12-5">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-12-6">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-12-7">    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-12-8">
</span><span id="__span-12-9"><span class="hll">    <span class="n">team_links</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">HeroTeamLink</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;hero&quot;</span><span class="p">)</span>
</span></span><span id="__span-12-10">
</span><span id="__span-12-11"><span class="c1"># Code below omitted 👇</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-13-1"><span class="c1"># Code above omitted 👆</span>
</span><span id="__span-13-2">
</span><span id="__span-13-3"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-13-4">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-13-5">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-13-6">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-13-7">    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-13-8">
</span><span id="__span-13-9"><span class="hll">    <span class="n">team_links</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">HeroTeamLink</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;hero&quot;</span><span class="p">)</span>
</span></span><span id="__span-13-10">
</span><span id="__span-13-11"><span class="c1"># Code below omitted 👇</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-14-1"><span class="c1"># Code above omitted 👆</span>
</span><span id="__span-14-2">
</span><span id="__span-14-3"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-14-4">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-14-5">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-14-6">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-14-7">    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-14-8">
</span><span id="__span-14-9"><span class="hll">    <span class="n">team_links</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">HeroTeamLink</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;hero&quot;</span><span class="p">)</span>
</span></span><span id="__span-14-10">
</span><span id="__span-14-11"><span class="c1"># Code below omitted 👇</span>
</span></code></pre></div>
</div>
</div>
</div>
<details>
<summary>👀 Full file preview</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="6:3"><input checked="checked" id="__tabbed_6_1" name="__tabbed_6" type="radio" /><input id="__tabbed_6_2" name="__tabbed_6" type="radio" /><input id="__tabbed_6_3" name="__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="__tabbed_6_1">Python 3.10+</label><label for="__tabbed_6_2">Python 3.9+</label><label for="__tabbed_6_3">Python 3.7+</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-15-1"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">select</span>
</span><span id="__span-15-2">
</span><span id="__span-15-3">
</span><span id="__span-15-4"><span class="k">class</span> <span class="nc">HeroTeamLink</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-15-5">    <span class="n">team_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-15-6">    <span class="n">hero_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;hero.id&quot;</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-15-7">    <span class="n">is_training</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-15-8">
</span><span id="__span-15-9">    <span class="n">team</span><span class="p">:</span> <span class="s2">&quot;Team&quot;</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;hero_links&quot;</span><span class="p">)</span>
</span><span id="__span-15-10">    <span class="n">hero</span><span class="p">:</span> <span class="s2">&quot;Hero&quot;</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team_links&quot;</span><span class="p">)</span>
</span><span id="__span-15-11">
</span><span id="__span-15-12">
</span><span id="__span-15-13"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-15-14">    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-15-15">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-15-16">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-15-17">
</span><span id="__span-15-18">    <span class="n">hero_links</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">HeroTeamLink</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team&quot;</span><span class="p">)</span>
</span><span id="__span-15-19">
</span><span id="__span-15-20">
</span><span id="__span-15-21"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-15-22">    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-15-23">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-15-24">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-15-25">    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-15-26">
</span><span id="__span-15-27">    <span class="n">team_links</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">HeroTeamLink</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;hero&quot;</span><span class="p">)</span>
</span><span id="__span-15-28">
</span><span id="__span-15-29">
</span><span id="__span-15-30"><span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
</span><span id="__span-15-31"><span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-15-32">
</span><span id="__span-15-33"><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-15-34">
</span><span id="__span-15-35">
</span><span id="__span-15-36"><span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
</span><span id="__span-15-37">    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
</span><span id="__span-15-38">
</span><span id="__span-15-39">
</span><span id="__span-15-40"><span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
</span><span id="__span-15-41">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-15-42">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Preventers&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sharp Tower&quot;</span><span class="p">)</span>
</span><span id="__span-15-43">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Z-Force&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sister Margaret&#39;s Bar&quot;</span><span class="p">)</span>
</span><span id="__span-15-44">
</span><span id="__span-15-45">        <span class="n">hero_deadpond</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-15-46">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span>
</span><span id="__span-15-47">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Dive Wilson&quot;</span><span class="p">,</span>
</span><span id="__span-15-48">        <span class="p">)</span>
</span><span id="__span-15-49">        <span class="n">hero_rusty_man</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-15-50">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span>
</span><span id="__span-15-51">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span>
</span><span id="__span-15-52">            <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span>
</span><span id="__span-15-53">        <span class="p">)</span>
</span><span id="__span-15-54">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-15-55">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span>
</span><span id="__span-15-56">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">,</span>
</span><span id="__span-15-57">        <span class="p">)</span>
</span><span id="__span-15-58">        <span class="n">deadpond_team_z_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span><span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-15-59">        <span class="n">deadpond_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-15-60">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_deadpond</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-15-61">        <span class="p">)</span>
</span><span id="__span-15-62">        <span class="n">spider_boy_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-15-63">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_spider_boy</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-15-64">        <span class="p">)</span>
</span><span id="__span-15-65">        <span class="n">rusty_man_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-15-66">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_rusty_man</span>
</span><span id="__span-15-67">        <span class="p">)</span>
</span><span id="__span-15-68">
</span><span id="__span-15-69">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">deadpond_team_z_link</span><span class="p">)</span>
</span><span id="__span-15-70">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">deadpond_preventers_link</span><span class="p">)</span>
</span><span id="__span-15-71">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">spider_boy_preventers_link</span><span class="p">)</span>
</span><span id="__span-15-72">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rusty_man_preventers_link</span><span class="p">)</span>
</span><span id="__span-15-73">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-15-74">
</span><span id="__span-15-75">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="p">:</span>
</span><span id="__span-15-76">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Z-Force hero:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">hero</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-15-77">
</span><span id="__span-15-78">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">team_preventers</span><span class="o">.</span><span class="n">hero_links</span><span class="p">:</span>
</span><span id="__span-15-79">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers hero:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">hero</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-15-80">
</span><span id="__span-15-81">
</span><span id="__span-15-82"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-15-83">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-15-84">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-15-85">            <span class="n">select</span><span class="p">(</span><span class="n">Hero</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hero</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Spider-Boy&quot;</span><span class="p">)</span>
</span><span id="__span-15-86">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-15-87">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Z-Force&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-15-88">
</span><span id="__span-15-89">        <span class="n">spider_boy_z_force_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-15-90">            <span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_spider_boy</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-15-91">        <span class="p">)</span>
</span><span id="__span-15-92">        <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spider_boy_z_force_link</span><span class="p">)</span>
</span><span id="__span-15-93">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_z_force</span><span class="p">)</span>
</span><span id="__span-15-94">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-15-95">
</span><span id="__span-15-96">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Updated Spider-Boy&#39;s Teams:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">)</span>
</span><span id="__span-15-97">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Z-Force heroes:&quot;</span><span class="p">,</span> <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="p">)</span>
</span><span id="__span-15-98">
</span><span id="__span-15-99">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">:</span>
</span><span id="__span-15-100">            <span class="k">if</span> <span class="n">link</span><span class="o">.</span><span class="n">team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">:</span>
</span><span id="__span-15-101">                <span class="n">link</span><span class="o">.</span><span class="n">is_training</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-15-102">
</span><span id="__span-15-103">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-15-104">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-15-105">
</span><span id="__span-15-106">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">:</span>
</span><span id="__span-15-107">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy team:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">team</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-15-108">
</span><span id="__span-15-109">
</span><span id="__span-15-110"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span id="__span-15-111">    <span class="n">create_db_and_tables</span><span class="p">()</span>
</span><span id="__span-15-112">    <span class="n">create_heroes</span><span class="p">()</span>
</span><span id="__span-15-113">    <span class="n">update_heroes</span><span class="p">()</span>
</span><span id="__span-15-114">
</span><span id="__span-15-115">
</span><span id="__span-15-116"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-15-117">    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-16-1"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>
</span><span id="__span-16-2">
</span><span id="__span-16-3"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">select</span>
</span><span id="__span-16-4">
</span><span id="__span-16-5">
</span><span id="__span-16-6"><span class="k">class</span> <span class="nc">HeroTeamLink</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-16-7">    <span class="n">team_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
</span><span id="__span-16-8">        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-16-9">    <span class="p">)</span>
</span><span id="__span-16-10">    <span class="n">hero_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
</span><span id="__span-16-11">        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;hero.id&quot;</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-16-12">    <span class="p">)</span>
</span><span id="__span-16-13">    <span class="n">is_training</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-16-14">
</span><span id="__span-16-15">    <span class="n">team</span><span class="p">:</span> <span class="s2">&quot;Team&quot;</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;hero_links&quot;</span><span class="p">)</span>
</span><span id="__span-16-16">    <span class="n">hero</span><span class="p">:</span> <span class="s2">&quot;Hero&quot;</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team_links&quot;</span><span class="p">)</span>
</span><span id="__span-16-17">
</span><span id="__span-16-18">
</span><span id="__span-16-19"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-16-20">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-16-21">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-16-22">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-16-23">
</span><span id="__span-16-24">    <span class="n">hero_links</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">HeroTeamLink</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team&quot;</span><span class="p">)</span>
</span><span id="__span-16-25">
</span><span id="__span-16-26">
</span><span id="__span-16-27"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-16-28">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-16-29">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-16-30">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-16-31">    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-16-32">
</span><span id="__span-16-33">    <span class="n">team_links</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">HeroTeamLink</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;hero&quot;</span><span class="p">)</span>
</span><span id="__span-16-34">
</span><span id="__span-16-35">
</span><span id="__span-16-36"><span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
</span><span id="__span-16-37"><span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-16-38">
</span><span id="__span-16-39"><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-16-40">
</span><span id="__span-16-41">
</span><span id="__span-16-42"><span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
</span><span id="__span-16-43">    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
</span><span id="__span-16-44">
</span><span id="__span-16-45">
</span><span id="__span-16-46"><span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
</span><span id="__span-16-47">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-16-48">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Preventers&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sharp Tower&quot;</span><span class="p">)</span>
</span><span id="__span-16-49">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Z-Force&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sister Margaret&#39;s Bar&quot;</span><span class="p">)</span>
</span><span id="__span-16-50">
</span><span id="__span-16-51">        <span class="n">hero_deadpond</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-16-52">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span>
</span><span id="__span-16-53">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Dive Wilson&quot;</span><span class="p">,</span>
</span><span id="__span-16-54">        <span class="p">)</span>
</span><span id="__span-16-55">        <span class="n">hero_rusty_man</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-16-56">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span>
</span><span id="__span-16-57">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span>
</span><span id="__span-16-58">            <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span>
</span><span id="__span-16-59">        <span class="p">)</span>
</span><span id="__span-16-60">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-16-61">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span>
</span><span id="__span-16-62">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">,</span>
</span><span id="__span-16-63">        <span class="p">)</span>
</span><span id="__span-16-64">        <span class="n">deadpond_team_z_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span><span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-16-65">        <span class="n">deadpond_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-16-66">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_deadpond</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-16-67">        <span class="p">)</span>
</span><span id="__span-16-68">        <span class="n">spider_boy_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-16-69">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_spider_boy</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-16-70">        <span class="p">)</span>
</span><span id="__span-16-71">        <span class="n">rusty_man_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-16-72">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_rusty_man</span>
</span><span id="__span-16-73">        <span class="p">)</span>
</span><span id="__span-16-74">
</span><span id="__span-16-75">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">deadpond_team_z_link</span><span class="p">)</span>
</span><span id="__span-16-76">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">deadpond_preventers_link</span><span class="p">)</span>
</span><span id="__span-16-77">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">spider_boy_preventers_link</span><span class="p">)</span>
</span><span id="__span-16-78">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rusty_man_preventers_link</span><span class="p">)</span>
</span><span id="__span-16-79">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-16-80">
</span><span id="__span-16-81">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="p">:</span>
</span><span id="__span-16-82">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Z-Force hero:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">hero</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-16-83">
</span><span id="__span-16-84">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">team_preventers</span><span class="o">.</span><span class="n">hero_links</span><span class="p">:</span>
</span><span id="__span-16-85">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers hero:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">hero</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-16-86">
</span><span id="__span-16-87">
</span><span id="__span-16-88"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-16-89">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-16-90">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-16-91">            <span class="n">select</span><span class="p">(</span><span class="n">Hero</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hero</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Spider-Boy&quot;</span><span class="p">)</span>
</span><span id="__span-16-92">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-16-93">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Z-Force&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-16-94">
</span><span id="__span-16-95">        <span class="n">spider_boy_z_force_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-16-96">            <span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_spider_boy</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-16-97">        <span class="p">)</span>
</span><span id="__span-16-98">        <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spider_boy_z_force_link</span><span class="p">)</span>
</span><span id="__span-16-99">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_z_force</span><span class="p">)</span>
</span><span id="__span-16-100">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-16-101">
</span><span id="__span-16-102">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Updated Spider-Boy&#39;s Teams:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">)</span>
</span><span id="__span-16-103">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Z-Force heroes:&quot;</span><span class="p">,</span> <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="p">)</span>
</span><span id="__span-16-104">
</span><span id="__span-16-105">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">:</span>
</span><span id="__span-16-106">            <span class="k">if</span> <span class="n">link</span><span class="o">.</span><span class="n">team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">:</span>
</span><span id="__span-16-107">                <span class="n">link</span><span class="o">.</span><span class="n">is_training</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-16-108">
</span><span id="__span-16-109">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-16-110">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-16-111">
</span><span id="__span-16-112">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">:</span>
</span><span id="__span-16-113">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy team:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">team</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-16-114">
</span><span id="__span-16-115">
</span><span id="__span-16-116"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span id="__span-16-117">    <span class="n">create_db_and_tables</span><span class="p">()</span>
</span><span id="__span-16-118">    <span class="n">create_heroes</span><span class="p">()</span>
</span><span id="__span-16-119">    <span class="n">update_heroes</span><span class="p">()</span>
</span><span id="__span-16-120">
</span><span id="__span-16-121">
</span><span id="__span-16-122"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-16-123">    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-17-1"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span>
</span><span id="__span-17-2">
</span><span id="__span-17-3"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">select</span>
</span><span id="__span-17-4">
</span><span id="__span-17-5">
</span><span id="__span-17-6"><span class="k">class</span> <span class="nc">HeroTeamLink</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-17-7">    <span class="n">team_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
</span><span id="__span-17-8">        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-17-9">    <span class="p">)</span>
</span><span id="__span-17-10">    <span class="n">hero_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
</span><span id="__span-17-11">        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;hero.id&quot;</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-17-12">    <span class="p">)</span>
</span><span id="__span-17-13">    <span class="n">is_training</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-17-14">
</span><span id="__span-17-15">    <span class="n">team</span><span class="p">:</span> <span class="s2">&quot;Team&quot;</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;hero_links&quot;</span><span class="p">)</span>
</span><span id="__span-17-16">    <span class="n">hero</span><span class="p">:</span> <span class="s2">&quot;Hero&quot;</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team_links&quot;</span><span class="p">)</span>
</span><span id="__span-17-17">
</span><span id="__span-17-18">
</span><span id="__span-17-19"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-17-20">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-17-21">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-17-22">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-17-23">
</span><span id="__span-17-24">    <span class="n">hero_links</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">HeroTeamLink</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team&quot;</span><span class="p">)</span>
</span><span id="__span-17-25">
</span><span id="__span-17-26">
</span><span id="__span-17-27"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-17-28">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-17-29">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-17-30">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-17-31">    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-17-32">
</span><span id="__span-17-33">    <span class="n">team_links</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">HeroTeamLink</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;hero&quot;</span><span class="p">)</span>
</span><span id="__span-17-34">
</span><span id="__span-17-35">
</span><span id="__span-17-36"><span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
</span><span id="__span-17-37"><span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-17-38">
</span><span id="__span-17-39"><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-17-40">
</span><span id="__span-17-41">
</span><span id="__span-17-42"><span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
</span><span id="__span-17-43">    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
</span><span id="__span-17-44">
</span><span id="__span-17-45">
</span><span id="__span-17-46"><span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
</span><span id="__span-17-47">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-17-48">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Preventers&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sharp Tower&quot;</span><span class="p">)</span>
</span><span id="__span-17-49">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Z-Force&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sister Margaret&#39;s Bar&quot;</span><span class="p">)</span>
</span><span id="__span-17-50">
</span><span id="__span-17-51">        <span class="n">hero_deadpond</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-17-52">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span>
</span><span id="__span-17-53">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Dive Wilson&quot;</span><span class="p">,</span>
</span><span id="__span-17-54">        <span class="p">)</span>
</span><span id="__span-17-55">        <span class="n">hero_rusty_man</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-17-56">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span>
</span><span id="__span-17-57">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span>
</span><span id="__span-17-58">            <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span>
</span><span id="__span-17-59">        <span class="p">)</span>
</span><span id="__span-17-60">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-17-61">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span>
</span><span id="__span-17-62">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">,</span>
</span><span id="__span-17-63">        <span class="p">)</span>
</span><span id="__span-17-64">        <span class="n">deadpond_team_z_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span><span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-17-65">        <span class="n">deadpond_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-17-66">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_deadpond</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-17-67">        <span class="p">)</span>
</span><span id="__span-17-68">        <span class="n">spider_boy_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-17-69">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_spider_boy</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-17-70">        <span class="p">)</span>
</span><span id="__span-17-71">        <span class="n">rusty_man_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-17-72">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_rusty_man</span>
</span><span id="__span-17-73">        <span class="p">)</span>
</span><span id="__span-17-74">
</span><span id="__span-17-75">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">deadpond_team_z_link</span><span class="p">)</span>
</span><span id="__span-17-76">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">deadpond_preventers_link</span><span class="p">)</span>
</span><span id="__span-17-77">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">spider_boy_preventers_link</span><span class="p">)</span>
</span><span id="__span-17-78">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rusty_man_preventers_link</span><span class="p">)</span>
</span><span id="__span-17-79">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-17-80">
</span><span id="__span-17-81">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="p">:</span>
</span><span id="__span-17-82">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Z-Force hero:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">hero</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-17-83">
</span><span id="__span-17-84">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">team_preventers</span><span class="o">.</span><span class="n">hero_links</span><span class="p">:</span>
</span><span id="__span-17-85">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers hero:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">hero</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-17-86">
</span><span id="__span-17-87">
</span><span id="__span-17-88"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-17-89">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-17-90">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-17-91">            <span class="n">select</span><span class="p">(</span><span class="n">Hero</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hero</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Spider-Boy&quot;</span><span class="p">)</span>
</span><span id="__span-17-92">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-17-93">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Z-Force&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-17-94">
</span><span id="__span-17-95">        <span class="n">spider_boy_z_force_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-17-96">            <span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_spider_boy</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-17-97">        <span class="p">)</span>
</span><span id="__span-17-98">        <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spider_boy_z_force_link</span><span class="p">)</span>
</span><span id="__span-17-99">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_z_force</span><span class="p">)</span>
</span><span id="__span-17-100">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-17-101">
</span><span id="__span-17-102">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Updated Spider-Boy&#39;s Teams:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">)</span>
</span><span id="__span-17-103">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Z-Force heroes:&quot;</span><span class="p">,</span> <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="p">)</span>
</span><span id="__span-17-104">
</span><span id="__span-17-105">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">:</span>
</span><span id="__span-17-106">            <span class="k">if</span> <span class="n">link</span><span class="o">.</span><span class="n">team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">:</span>
</span><span id="__span-17-107">                <span class="n">link</span><span class="o">.</span><span class="n">is_training</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-17-108">
</span><span id="__span-17-109">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-17-110">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-17-111">
</span><span id="__span-17-112">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">:</span>
</span><span id="__span-17-113">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy team:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">team</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-17-114">
</span><span id="__span-17-115">
</span><span id="__span-17-116"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span id="__span-17-117">    <span class="n">create_db_and_tables</span><span class="p">()</span>
</span><span id="__span-17-118">    <span class="n">create_heroes</span><span class="p">()</span>
</span><span id="__span-17-119">    <span class="n">update_heroes</span><span class="p">()</span>
</span><span id="__span-17-120">
</span><span id="__span-17-121">
</span><span id="__span-17-122"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-17-123">    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div>
</div>
</div>
</div>
</details>
<h2 id="create-relationships">Create Relationships<a class="headerlink" href="#create-relationships" title="Permanent link">&para;</a></h2>
<p>Now the process to create relationships is very similar.</p>
<p>But now we create the <strong>explicit link models</strong> manually, pointing to their hero and team instances, and specifying the additional link data (<code>is_training</code>):</p>
<div class="tabbed-set tabbed-alternate" data-tabs="7:3"><input checked="checked" id="__tabbed_7_1" name="__tabbed_7" type="radio" /><input id="__tabbed_7_2" name="__tabbed_7" type="radio" /><input id="__tabbed_7_3" name="__tabbed_7" type="radio" /><div class="tabbed-labels"><label for="__tabbed_7_1">Python 3.10+</label><label for="__tabbed_7_2">Python 3.9+</label><label for="__tabbed_7_3">Python 3.7+</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-18-1"><span class="c1"># Code above omitted 👆</span>
</span><span id="__span-18-2">
</span><span id="__span-18-3"><span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
</span><span id="__span-18-4">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-18-5">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Preventers&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sharp Tower&quot;</span><span class="p">)</span>
</span><span id="__span-18-6">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Z-Force&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sister Margaret&#39;s Bar&quot;</span><span class="p">)</span>
</span><span id="__span-18-7">
</span><span id="__span-18-8">        <span class="n">hero_deadpond</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-18-9">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span>
</span><span id="__span-18-10">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Dive Wilson&quot;</span><span class="p">,</span>
</span><span id="__span-18-11">        <span class="p">)</span>
</span><span id="__span-18-12">        <span class="n">hero_rusty_man</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-18-13">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span>
</span><span id="__span-18-14">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span>
</span><span id="__span-18-15">            <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span>
</span><span id="__span-18-16">        <span class="p">)</span>
</span><span id="__span-18-17">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-18-18">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span>
</span><span id="__span-18-19">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">,</span>
</span><span id="__span-18-20">        <span class="p">)</span>
</span><span id="__span-18-21"><span class="hll">        <span class="n">deadpond_team_z_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span><span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span></span><span id="__span-18-22"><span class="hll">        <span class="n">deadpond_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span></span><span id="__span-18-23"><span class="hll">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_deadpond</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span></span><span id="__span-18-24"><span class="hll">        <span class="p">)</span>
</span></span><span id="__span-18-25"><span class="hll">        <span class="n">spider_boy_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span></span><span id="__span-18-26"><span class="hll">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_spider_boy</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span></span><span id="__span-18-27"><span class="hll">        <span class="p">)</span>
</span></span><span id="__span-18-28"><span class="hll">        <span class="n">rusty_man_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span></span><span id="__span-18-29"><span class="hll">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_rusty_man</span>
</span></span><span id="__span-18-30"><span class="hll">        <span class="p">)</span>
</span></span><span id="__span-18-31">
</span><span id="__span-18-32"><span class="hll">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">deadpond_team_z_link</span><span class="p">)</span>
</span></span><span id="__span-18-33"><span class="hll">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">deadpond_preventers_link</span><span class="p">)</span>
</span></span><span id="__span-18-34"><span class="hll">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">spider_boy_preventers_link</span><span class="p">)</span>
</span></span><span id="__span-18-35"><span class="hll">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rusty_man_preventers_link</span><span class="p">)</span>
</span></span><span id="__span-18-36">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-18-37">
</span><span id="__span-18-38">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="p">:</span>
</span><span id="__span-18-39">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Z-Force hero:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">hero</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-18-40">
</span><span id="__span-18-41">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">team_preventers</span><span class="o">.</span><span class="n">hero_links</span><span class="p">:</span>
</span><span id="__span-18-42">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers hero:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">hero</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-18-43">
</span><span id="__span-18-44"><span class="c1"># Code below omitted 👇</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-19-1"><span class="c1"># Code above omitted 👆</span>
</span><span id="__span-19-2">
</span><span id="__span-19-3"><span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
</span><span id="__span-19-4">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-19-5">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Preventers&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sharp Tower&quot;</span><span class="p">)</span>
</span><span id="__span-19-6">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Z-Force&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sister Margaret&#39;s Bar&quot;</span><span class="p">)</span>
</span><span id="__span-19-7">
</span><span id="__span-19-8">        <span class="n">hero_deadpond</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-19-9">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span>
</span><span id="__span-19-10">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Dive Wilson&quot;</span><span class="p">,</span>
</span><span id="__span-19-11">        <span class="p">)</span>
</span><span id="__span-19-12">        <span class="n">hero_rusty_man</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-19-13">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span>
</span><span id="__span-19-14">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span>
</span><span id="__span-19-15">            <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span>
</span><span id="__span-19-16">        <span class="p">)</span>
</span><span id="__span-19-17">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-19-18">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span>
</span><span id="__span-19-19">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">,</span>
</span><span id="__span-19-20">        <span class="p">)</span>
</span><span id="__span-19-21"><span class="hll">        <span class="n">deadpond_team_z_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span><span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span></span><span id="__span-19-22"><span class="hll">        <span class="n">deadpond_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span></span><span id="__span-19-23"><span class="hll">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_deadpond</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span></span><span id="__span-19-24"><span class="hll">        <span class="p">)</span>
</span></span><span id="__span-19-25"><span class="hll">        <span class="n">spider_boy_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span></span><span id="__span-19-26"><span class="hll">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_spider_boy</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span></span><span id="__span-19-27"><span class="hll">        <span class="p">)</span>
</span></span><span id="__span-19-28"><span class="hll">        <span class="n">rusty_man_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span></span><span id="__span-19-29"><span class="hll">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_rusty_man</span>
</span></span><span id="__span-19-30"><span class="hll">        <span class="p">)</span>
</span></span><span id="__span-19-31">
</span><span id="__span-19-32"><span class="hll">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">deadpond_team_z_link</span><span class="p">)</span>
</span></span><span id="__span-19-33"><span class="hll">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">deadpond_preventers_link</span><span class="p">)</span>
</span></span><span id="__span-19-34"><span class="hll">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">spider_boy_preventers_link</span><span class="p">)</span>
</span></span><span id="__span-19-35"><span class="hll">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rusty_man_preventers_link</span><span class="p">)</span>
</span></span><span id="__span-19-36">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-19-37">
</span><span id="__span-19-38">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="p">:</span>
</span><span id="__span-19-39">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Z-Force hero:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">hero</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-19-40">
</span><span id="__span-19-41">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">team_preventers</span><span class="o">.</span><span class="n">hero_links</span><span class="p">:</span>
</span><span id="__span-19-42">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers hero:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">hero</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-19-43">
</span><span id="__span-19-44"><span class="c1"># Code below omitted 👇</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-20-1"><span class="c1"># Code above omitted 👆</span>
</span><span id="__span-20-2">
</span><span id="__span-20-3"><span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
</span><span id="__span-20-4">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-20-5">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Preventers&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sharp Tower&quot;</span><span class="p">)</span>
</span><span id="__span-20-6">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Z-Force&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sister Margaret&#39;s Bar&quot;</span><span class="p">)</span>
</span><span id="__span-20-7">
</span><span id="__span-20-8">        <span class="n">hero_deadpond</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-20-9">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span>
</span><span id="__span-20-10">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Dive Wilson&quot;</span><span class="p">,</span>
</span><span id="__span-20-11">        <span class="p">)</span>
</span><span id="__span-20-12">        <span class="n">hero_rusty_man</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-20-13">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span>
</span><span id="__span-20-14">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span>
</span><span id="__span-20-15">            <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span>
</span><span id="__span-20-16">        <span class="p">)</span>
</span><span id="__span-20-17">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-20-18">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span>
</span><span id="__span-20-19">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">,</span>
</span><span id="__span-20-20">        <span class="p">)</span>
</span><span id="__span-20-21"><span class="hll">        <span class="n">deadpond_team_z_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span><span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span></span><span id="__span-20-22"><span class="hll">        <span class="n">deadpond_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span></span><span id="__span-20-23"><span class="hll">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_deadpond</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span></span><span id="__span-20-24"><span class="hll">        <span class="p">)</span>
</span></span><span id="__span-20-25"><span class="hll">        <span class="n">spider_boy_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span></span><span id="__span-20-26"><span class="hll">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_spider_boy</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span></span><span id="__span-20-27"><span class="hll">        <span class="p">)</span>
</span></span><span id="__span-20-28"><span class="hll">        <span class="n">rusty_man_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span></span><span id="__span-20-29"><span class="hll">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_rusty_man</span>
</span></span><span id="__span-20-30"><span class="hll">        <span class="p">)</span>
</span></span><span id="__span-20-31">
</span><span id="__span-20-32"><span class="hll">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">deadpond_team_z_link</span><span class="p">)</span>
</span></span><span id="__span-20-33"><span class="hll">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">deadpond_preventers_link</span><span class="p">)</span>
</span></span><span id="__span-20-34"><span class="hll">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">spider_boy_preventers_link</span><span class="p">)</span>
</span></span><span id="__span-20-35"><span class="hll">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rusty_man_preventers_link</span><span class="p">)</span>
</span></span><span id="__span-20-36">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-20-37">
</span><span id="__span-20-38">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="p">:</span>
</span><span id="__span-20-39">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Z-Force hero:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">hero</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-20-40">
</span><span id="__span-20-41">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">team_preventers</span><span class="o">.</span><span class="n">hero_links</span><span class="p">:</span>
</span><span id="__span-20-42">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers hero:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">hero</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-20-43">
</span><span id="__span-20-44"><span class="c1"># Code below omitted 👇</span>
</span></code></pre></div>
</div>
</div>
</div>
<details>
<summary>👀 Full file preview</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="8:3"><input checked="checked" id="__tabbed_8_1" name="__tabbed_8" type="radio" /><input id="__tabbed_8_2" name="__tabbed_8" type="radio" /><input id="__tabbed_8_3" name="__tabbed_8" type="radio" /><div class="tabbed-labels"><label for="__tabbed_8_1">Python 3.10+</label><label for="__tabbed_8_2">Python 3.9+</label><label for="__tabbed_8_3">Python 3.7+</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-21-1"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">select</span>
</span><span id="__span-21-2">
</span><span id="__span-21-3">
</span><span id="__span-21-4"><span class="k">class</span> <span class="nc">HeroTeamLink</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-21-5">    <span class="n">team_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-21-6">    <span class="n">hero_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;hero.id&quot;</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-21-7">    <span class="n">is_training</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-21-8">
</span><span id="__span-21-9">    <span class="n">team</span><span class="p">:</span> <span class="s2">&quot;Team&quot;</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;hero_links&quot;</span><span class="p">)</span>
</span><span id="__span-21-10">    <span class="n">hero</span><span class="p">:</span> <span class="s2">&quot;Hero&quot;</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team_links&quot;</span><span class="p">)</span>
</span><span id="__span-21-11">
</span><span id="__span-21-12">
</span><span id="__span-21-13"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-21-14">    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-21-15">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-21-16">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-21-17">
</span><span id="__span-21-18">    <span class="n">hero_links</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">HeroTeamLink</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team&quot;</span><span class="p">)</span>
</span><span id="__span-21-19">
</span><span id="__span-21-20">
</span><span id="__span-21-21"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-21-22">    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-21-23">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-21-24">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-21-25">    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-21-26">
</span><span id="__span-21-27">    <span class="n">team_links</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">HeroTeamLink</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;hero&quot;</span><span class="p">)</span>
</span><span id="__span-21-28">
</span><span id="__span-21-29">
</span><span id="__span-21-30"><span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
</span><span id="__span-21-31"><span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-21-32">
</span><span id="__span-21-33"><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-21-34">
</span><span id="__span-21-35">
</span><span id="__span-21-36"><span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
</span><span id="__span-21-37">    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
</span><span id="__span-21-38">
</span><span id="__span-21-39">
</span><span id="__span-21-40"><span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
</span><span id="__span-21-41">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-21-42">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Preventers&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sharp Tower&quot;</span><span class="p">)</span>
</span><span id="__span-21-43">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Z-Force&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sister Margaret&#39;s Bar&quot;</span><span class="p">)</span>
</span><span id="__span-21-44">
</span><span id="__span-21-45">        <span class="n">hero_deadpond</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-21-46">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span>
</span><span id="__span-21-47">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Dive Wilson&quot;</span><span class="p">,</span>
</span><span id="__span-21-48">        <span class="p">)</span>
</span><span id="__span-21-49">        <span class="n">hero_rusty_man</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-21-50">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span>
</span><span id="__span-21-51">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span>
</span><span id="__span-21-52">            <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span>
</span><span id="__span-21-53">        <span class="p">)</span>
</span><span id="__span-21-54">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-21-55">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span>
</span><span id="__span-21-56">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">,</span>
</span><span id="__span-21-57">        <span class="p">)</span>
</span><span id="__span-21-58">        <span class="n">deadpond_team_z_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span><span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-21-59">        <span class="n">deadpond_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-21-60">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_deadpond</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-21-61">        <span class="p">)</span>
</span><span id="__span-21-62">        <span class="n">spider_boy_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-21-63">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_spider_boy</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-21-64">        <span class="p">)</span>
</span><span id="__span-21-65">        <span class="n">rusty_man_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-21-66">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_rusty_man</span>
</span><span id="__span-21-67">        <span class="p">)</span>
</span><span id="__span-21-68">
</span><span id="__span-21-69">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">deadpond_team_z_link</span><span class="p">)</span>
</span><span id="__span-21-70">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">deadpond_preventers_link</span><span class="p">)</span>
</span><span id="__span-21-71">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">spider_boy_preventers_link</span><span class="p">)</span>
</span><span id="__span-21-72">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rusty_man_preventers_link</span><span class="p">)</span>
</span><span id="__span-21-73">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-21-74">
</span><span id="__span-21-75">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="p">:</span>
</span><span id="__span-21-76">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Z-Force hero:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">hero</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-21-77">
</span><span id="__span-21-78">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">team_preventers</span><span class="o">.</span><span class="n">hero_links</span><span class="p">:</span>
</span><span id="__span-21-79">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers hero:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">hero</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-21-80">
</span><span id="__span-21-81">
</span><span id="__span-21-82"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-21-83">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-21-84">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-21-85">            <span class="n">select</span><span class="p">(</span><span class="n">Hero</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hero</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Spider-Boy&quot;</span><span class="p">)</span>
</span><span id="__span-21-86">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-21-87">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Z-Force&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-21-88">
</span><span id="__span-21-89">        <span class="n">spider_boy_z_force_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-21-90">            <span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_spider_boy</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-21-91">        <span class="p">)</span>
</span><span id="__span-21-92">        <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spider_boy_z_force_link</span><span class="p">)</span>
</span><span id="__span-21-93">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_z_force</span><span class="p">)</span>
</span><span id="__span-21-94">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-21-95">
</span><span id="__span-21-96">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Updated Spider-Boy&#39;s Teams:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">)</span>
</span><span id="__span-21-97">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Z-Force heroes:&quot;</span><span class="p">,</span> <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="p">)</span>
</span><span id="__span-21-98">
</span><span id="__span-21-99">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">:</span>
</span><span id="__span-21-100">            <span class="k">if</span> <span class="n">link</span><span class="o">.</span><span class="n">team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">:</span>
</span><span id="__span-21-101">                <span class="n">link</span><span class="o">.</span><span class="n">is_training</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-21-102">
</span><span id="__span-21-103">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-21-104">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-21-105">
</span><span id="__span-21-106">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">:</span>
</span><span id="__span-21-107">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy team:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">team</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-21-108">
</span><span id="__span-21-109">
</span><span id="__span-21-110"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span id="__span-21-111">    <span class="n">create_db_and_tables</span><span class="p">()</span>
</span><span id="__span-21-112">    <span class="n">create_heroes</span><span class="p">()</span>
</span><span id="__span-21-113">    <span class="n">update_heroes</span><span class="p">()</span>
</span><span id="__span-21-114">
</span><span id="__span-21-115">
</span><span id="__span-21-116"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-21-117">    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-22-1"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>
</span><span id="__span-22-2">
</span><span id="__span-22-3"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">select</span>
</span><span id="__span-22-4">
</span><span id="__span-22-5">
</span><span id="__span-22-6"><span class="k">class</span> <span class="nc">HeroTeamLink</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-22-7">    <span class="n">team_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
</span><span id="__span-22-8">        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-22-9">    <span class="p">)</span>
</span><span id="__span-22-10">    <span class="n">hero_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
</span><span id="__span-22-11">        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;hero.id&quot;</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-22-12">    <span class="p">)</span>
</span><span id="__span-22-13">    <span class="n">is_training</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-22-14">
</span><span id="__span-22-15">    <span class="n">team</span><span class="p">:</span> <span class="s2">&quot;Team&quot;</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;hero_links&quot;</span><span class="p">)</span>
</span><span id="__span-22-16">    <span class="n">hero</span><span class="p">:</span> <span class="s2">&quot;Hero&quot;</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team_links&quot;</span><span class="p">)</span>
</span><span id="__span-22-17">
</span><span id="__span-22-18">
</span><span id="__span-22-19"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-22-20">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-22-21">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-22-22">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-22-23">
</span><span id="__span-22-24">    <span class="n">hero_links</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">HeroTeamLink</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team&quot;</span><span class="p">)</span>
</span><span id="__span-22-25">
</span><span id="__span-22-26">
</span><span id="__span-22-27"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-22-28">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-22-29">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-22-30">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-22-31">    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-22-32">
</span><span id="__span-22-33">    <span class="n">team_links</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">HeroTeamLink</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;hero&quot;</span><span class="p">)</span>
</span><span id="__span-22-34">
</span><span id="__span-22-35">
</span><span id="__span-22-36"><span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
</span><span id="__span-22-37"><span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-22-38">
</span><span id="__span-22-39"><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-22-40">
</span><span id="__span-22-41">
</span><span id="__span-22-42"><span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
</span><span id="__span-22-43">    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
</span><span id="__span-22-44">
</span><span id="__span-22-45">
</span><span id="__span-22-46"><span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
</span><span id="__span-22-47">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-22-48">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Preventers&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sharp Tower&quot;</span><span class="p">)</span>
</span><span id="__span-22-49">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Z-Force&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sister Margaret&#39;s Bar&quot;</span><span class="p">)</span>
</span><span id="__span-22-50">
</span><span id="__span-22-51">        <span class="n">hero_deadpond</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-22-52">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span>
</span><span id="__span-22-53">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Dive Wilson&quot;</span><span class="p">,</span>
</span><span id="__span-22-54">        <span class="p">)</span>
</span><span id="__span-22-55">        <span class="n">hero_rusty_man</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-22-56">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span>
</span><span id="__span-22-57">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span>
</span><span id="__span-22-58">            <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span>
</span><span id="__span-22-59">        <span class="p">)</span>
</span><span id="__span-22-60">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-22-61">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span>
</span><span id="__span-22-62">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">,</span>
</span><span id="__span-22-63">        <span class="p">)</span>
</span><span id="__span-22-64">        <span class="n">deadpond_team_z_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span><span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-22-65">        <span class="n">deadpond_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-22-66">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_deadpond</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-22-67">        <span class="p">)</span>
</span><span id="__span-22-68">        <span class="n">spider_boy_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-22-69">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_spider_boy</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-22-70">        <span class="p">)</span>
</span><span id="__span-22-71">        <span class="n">rusty_man_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-22-72">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_rusty_man</span>
</span><span id="__span-22-73">        <span class="p">)</span>
</span><span id="__span-22-74">
</span><span id="__span-22-75">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">deadpond_team_z_link</span><span class="p">)</span>
</span><span id="__span-22-76">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">deadpond_preventers_link</span><span class="p">)</span>
</span><span id="__span-22-77">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">spider_boy_preventers_link</span><span class="p">)</span>
</span><span id="__span-22-78">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rusty_man_preventers_link</span><span class="p">)</span>
</span><span id="__span-22-79">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-22-80">
</span><span id="__span-22-81">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="p">:</span>
</span><span id="__span-22-82">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Z-Force hero:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">hero</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-22-83">
</span><span id="__span-22-84">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">team_preventers</span><span class="o">.</span><span class="n">hero_links</span><span class="p">:</span>
</span><span id="__span-22-85">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers hero:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">hero</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-22-86">
</span><span id="__span-22-87">
</span><span id="__span-22-88"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-22-89">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-22-90">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-22-91">            <span class="n">select</span><span class="p">(</span><span class="n">Hero</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hero</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Spider-Boy&quot;</span><span class="p">)</span>
</span><span id="__span-22-92">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-22-93">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Z-Force&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-22-94">
</span><span id="__span-22-95">        <span class="n">spider_boy_z_force_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-22-96">            <span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_spider_boy</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-22-97">        <span class="p">)</span>
</span><span id="__span-22-98">        <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spider_boy_z_force_link</span><span class="p">)</span>
</span><span id="__span-22-99">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_z_force</span><span class="p">)</span>
</span><span id="__span-22-100">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-22-101">
</span><span id="__span-22-102">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Updated Spider-Boy&#39;s Teams:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">)</span>
</span><span id="__span-22-103">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Z-Force heroes:&quot;</span><span class="p">,</span> <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="p">)</span>
</span><span id="__span-22-104">
</span><span id="__span-22-105">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">:</span>
</span><span id="__span-22-106">            <span class="k">if</span> <span class="n">link</span><span class="o">.</span><span class="n">team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">:</span>
</span><span id="__span-22-107">                <span class="n">link</span><span class="o">.</span><span class="n">is_training</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-22-108">
</span><span id="__span-22-109">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-22-110">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-22-111">
</span><span id="__span-22-112">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">:</span>
</span><span id="__span-22-113">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy team:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">team</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-22-114">
</span><span id="__span-22-115">
</span><span id="__span-22-116"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span id="__span-22-117">    <span class="n">create_db_and_tables</span><span class="p">()</span>
</span><span id="__span-22-118">    <span class="n">create_heroes</span><span class="p">()</span>
</span><span id="__span-22-119">    <span class="n">update_heroes</span><span class="p">()</span>
</span><span id="__span-22-120">
</span><span id="__span-22-121">
</span><span id="__span-22-122"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-22-123">    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-23-1"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span>
</span><span id="__span-23-2">
</span><span id="__span-23-3"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">select</span>
</span><span id="__span-23-4">
</span><span id="__span-23-5">
</span><span id="__span-23-6"><span class="k">class</span> <span class="nc">HeroTeamLink</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-23-7">    <span class="n">team_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
</span><span id="__span-23-8">        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-23-9">    <span class="p">)</span>
</span><span id="__span-23-10">    <span class="n">hero_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
</span><span id="__span-23-11">        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;hero.id&quot;</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-23-12">    <span class="p">)</span>
</span><span id="__span-23-13">    <span class="n">is_training</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-23-14">
</span><span id="__span-23-15">    <span class="n">team</span><span class="p">:</span> <span class="s2">&quot;Team&quot;</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;hero_links&quot;</span><span class="p">)</span>
</span><span id="__span-23-16">    <span class="n">hero</span><span class="p">:</span> <span class="s2">&quot;Hero&quot;</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team_links&quot;</span><span class="p">)</span>
</span><span id="__span-23-17">
</span><span id="__span-23-18">
</span><span id="__span-23-19"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-23-20">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-23-21">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-23-22">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-23-23">
</span><span id="__span-23-24">    <span class="n">hero_links</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">HeroTeamLink</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team&quot;</span><span class="p">)</span>
</span><span id="__span-23-25">
</span><span id="__span-23-26">
</span><span id="__span-23-27"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-23-28">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-23-29">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-23-30">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-23-31">    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-23-32">
</span><span id="__span-23-33">    <span class="n">team_links</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">HeroTeamLink</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;hero&quot;</span><span class="p">)</span>
</span><span id="__span-23-34">
</span><span id="__span-23-35">
</span><span id="__span-23-36"><span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
</span><span id="__span-23-37"><span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-23-38">
</span><span id="__span-23-39"><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-23-40">
</span><span id="__span-23-41">
</span><span id="__span-23-42"><span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
</span><span id="__span-23-43">    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
</span><span id="__span-23-44">
</span><span id="__span-23-45">
</span><span id="__span-23-46"><span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
</span><span id="__span-23-47">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-23-48">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Preventers&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sharp Tower&quot;</span><span class="p">)</span>
</span><span id="__span-23-49">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Z-Force&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sister Margaret&#39;s Bar&quot;</span><span class="p">)</span>
</span><span id="__span-23-50">
</span><span id="__span-23-51">        <span class="n">hero_deadpond</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-23-52">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span>
</span><span id="__span-23-53">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Dive Wilson&quot;</span><span class="p">,</span>
</span><span id="__span-23-54">        <span class="p">)</span>
</span><span id="__span-23-55">        <span class="n">hero_rusty_man</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-23-56">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span>
</span><span id="__span-23-57">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span>
</span><span id="__span-23-58">            <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span>
</span><span id="__span-23-59">        <span class="p">)</span>
</span><span id="__span-23-60">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-23-61">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span>
</span><span id="__span-23-62">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">,</span>
</span><span id="__span-23-63">        <span class="p">)</span>
</span><span id="__span-23-64">        <span class="n">deadpond_team_z_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span><span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-23-65">        <span class="n">deadpond_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-23-66">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_deadpond</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-23-67">        <span class="p">)</span>
</span><span id="__span-23-68">        <span class="n">spider_boy_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-23-69">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_spider_boy</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-23-70">        <span class="p">)</span>
</span><span id="__span-23-71">        <span class="n">rusty_man_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-23-72">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_rusty_man</span>
</span><span id="__span-23-73">        <span class="p">)</span>
</span><span id="__span-23-74">
</span><span id="__span-23-75">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">deadpond_team_z_link</span><span class="p">)</span>
</span><span id="__span-23-76">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">deadpond_preventers_link</span><span class="p">)</span>
</span><span id="__span-23-77">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">spider_boy_preventers_link</span><span class="p">)</span>
</span><span id="__span-23-78">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rusty_man_preventers_link</span><span class="p">)</span>
</span><span id="__span-23-79">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-23-80">
</span><span id="__span-23-81">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="p">:</span>
</span><span id="__span-23-82">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Z-Force hero:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">hero</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-23-83">
</span><span id="__span-23-84">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">team_preventers</span><span class="o">.</span><span class="n">hero_links</span><span class="p">:</span>
</span><span id="__span-23-85">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers hero:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">hero</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-23-86">
</span><span id="__span-23-87">
</span><span id="__span-23-88"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-23-89">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-23-90">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-23-91">            <span class="n">select</span><span class="p">(</span><span class="n">Hero</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hero</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Spider-Boy&quot;</span><span class="p">)</span>
</span><span id="__span-23-92">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-23-93">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Z-Force&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-23-94">
</span><span id="__span-23-95">        <span class="n">spider_boy_z_force_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-23-96">            <span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_spider_boy</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-23-97">        <span class="p">)</span>
</span><span id="__span-23-98">        <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spider_boy_z_force_link</span><span class="p">)</span>
</span><span id="__span-23-99">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_z_force</span><span class="p">)</span>
</span><span id="__span-23-100">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-23-101">
</span><span id="__span-23-102">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Updated Spider-Boy&#39;s Teams:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">)</span>
</span><span id="__span-23-103">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Z-Force heroes:&quot;</span><span class="p">,</span> <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="p">)</span>
</span><span id="__span-23-104">
</span><span id="__span-23-105">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">:</span>
</span><span id="__span-23-106">            <span class="k">if</span> <span class="n">link</span><span class="o">.</span><span class="n">team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">:</span>
</span><span id="__span-23-107">                <span class="n">link</span><span class="o">.</span><span class="n">is_training</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-23-108">
</span><span id="__span-23-109">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-23-110">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-23-111">
</span><span id="__span-23-112">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">:</span>
</span><span id="__span-23-113">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy team:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">team</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-23-114">
</span><span id="__span-23-115">
</span><span id="__span-23-116"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span id="__span-23-117">    <span class="n">create_db_and_tables</span><span class="p">()</span>
</span><span id="__span-23-118">    <span class="n">create_heroes</span><span class="p">()</span>
</span><span id="__span-23-119">    <span class="n">update_heroes</span><span class="p">()</span>
</span><span id="__span-23-120">
</span><span id="__span-23-121">
</span><span id="__span-23-122"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-23-123">    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div>
</div>
</div>
</div>
</details>
<p>We are just adding the link model instances to the session, because the link model instances are connected to the heroes and teams, they will be also automatically included in the session when we commit.</p>
<h2 id="run-the-program">Run the Program<a class="headerlink" href="#run-the-program" title="Permanent link">&para;</a></h2>
<p>Now, if we run the program, it will show almost the same output as before, because it is generating almost the same SQL, but this time including the new <code>is_training</code> column:</p>
<div class="termy">

<div class="highlight"><pre><span></span><code><span id="__span-24-1"><span class="gp">$ </span>python<span class="w"> </span>app.py
</span><span id="__span-24-2">
</span><span id="__span-24-3"><span class="go">// Previous output omitted 🙈</span>
</span><span id="__span-24-4">
</span><span id="__span-24-5"><span class="go">// Automatically start a new transaction</span>
</span><span id="__span-24-6"><span class="go">INFO Engine BEGIN (implicit)</span>
</span><span id="__span-24-7">
</span><span id="__span-24-8"><span class="go">// Insert the heroes</span>
</span><span id="__span-24-9"><span class="go">INFO Engine INSERT INTO hero (name, secret_name, age) VALUES (?, ?, ?)</span>
</span><span id="__span-24-10"><span class="go">INFO Engine [generated in 0.00025s] (&#39;Deadpond&#39;, &#39;Dive Wilson&#39;, None)</span>
</span><span id="__span-24-11"><span class="go">INFO Engine INSERT INTO hero (name, secret_name, age) VALUES (?, ?, ?)</span>
</span><span id="__span-24-12"><span class="go">INFO Engine [cached since 0.00136s ago] (&#39;Spider-Boy&#39;, &#39;Pedro Parqueador&#39;, None)</span>
</span><span id="__span-24-13"><span class="go">INFO Engine INSERT INTO hero (name, secret_name, age) VALUES (?, ?, ?)</span>
</span><span id="__span-24-14"><span class="go">INFO Engine [cached since 0.001858s ago] (&#39;Rusty-Man&#39;, &#39;Tommy Sharp&#39;, 48)</span>
</span><span id="__span-24-15">
</span><span id="__span-24-16"><span class="go">// Insert the teams</span>
</span><span id="__span-24-17"><span class="go">INFO Engine INSERT INTO team (name, headquarters) VALUES (?, ?)</span>
</span><span id="__span-24-18"><span class="go">INFO Engine [generated in 0.00019s] (&#39;Z-Force&#39;, &#39;Sister Margaret&#39;s Bar&#39;)</span>
</span><span id="__span-24-19"><span class="go">INFO Engine INSERT INTO team (name, headquarters) VALUES (?, ?)</span>
</span><span id="__span-24-20"><span class="go">INFO Engine [cached since 0.0007985s ago] (&#39;Preventers&#39;, &#39;Sharp Tower&#39;)</span>
</span><span id="__span-24-21">
</span><span id="__span-24-22"><span class="go">// Insert the hero-team links</span>
</span><span id="__span-24-23"><span class="go">INFO Engine INSERT INTO heroteamlink (team_id, hero_id, is_training) VALUES (?, ?, ?)</span>
</span><span id="__span-24-24"><span class="go">INFO Engine [generated in 0.00023s] ((1, 1, 0), (2, 1, 1), (2, 2, 1), (2, 3, 0))</span>
</span><span id="__span-24-25"><span class="go">// Save the changes in the transaction in the database</span>
</span><span id="__span-24-26"><span class="go">INFO Engine COMMIT</span>
</span><span id="__span-24-27">
</span><span id="__span-24-28"><span class="go">// Automatically start a new transaction</span>
</span><span id="__span-24-29"><span class="go">INFO Engine BEGIN (implicit)</span>
</span><span id="__span-24-30">
</span><span id="__span-24-31"><span class="go">// Automatically fetch the data on attribute access</span>
</span><span id="__span-24-32"><span class="go">INFO Engine SELECT team.id AS team_id, team.name AS team_name, team.headquarters AS team_headquarters</span>
</span><span id="__span-24-33"><span class="go">FROM team</span>
</span><span id="__span-24-34"><span class="go">WHERE team.id = ?</span>
</span><span id="__span-24-35"><span class="go">INFO Engine [generated in 0.00028s] (1,)</span>
</span><span id="__span-24-36"><span class="go">INFO Engine SELECT heroteamlink.team_id AS heroteamlink_team_id, heroteamlink.hero_id AS heroteamlink_hero_id, heroteamlink.is_training AS heroteamlink_is_training</span>
</span><span id="__span-24-37"><span class="go">FROM heroteamlink</span>
</span><span id="__span-24-38"><span class="go">WHERE ? = heroteamlink.team_id</span>
</span><span id="__span-24-39"><span class="go">INFO Engine [generated in 0.00026s] (1,)</span>
</span><span id="__span-24-40"><span class="go">INFO Engine SELECT hero.id AS hero_id, hero.name AS hero_name, hero.secret_name AS hero_secret_name, hero.age AS hero_age</span>
</span><span id="__span-24-41"><span class="go">FROM hero</span>
</span><span id="__span-24-42"><span class="go">WHERE hero.id = ?</span>
</span><span id="__span-24-43"><span class="go">INFO Engine [generated in 0.00024s] (1,)</span>
</span><span id="__span-24-44">
</span><span id="__span-24-45"><span class="go">// Print Z-Force hero data, including link data</span>
</span><span id="__span-24-46"><span class="go">Z-Force hero: name=&#39;Deadpond&#39; age=None id=1 secret_name=&#39;Dive Wilson&#39; is training: False</span>
</span><span id="__span-24-47">
</span><span id="__span-24-48"><span class="go">// Automatically fetch the data on attribute access</span>
</span><span id="__span-24-49"><span class="go">INFO Engine SELECT team.id AS team_id, team.name AS team_name, team.headquarters AS team_headquarters</span>
</span><span id="__span-24-50"><span class="go">FROM team</span>
</span><span id="__span-24-51"><span class="go">WHERE team.id = ?</span>
</span><span id="__span-24-52"><span class="go">INFO Engine [cached since 0.008822s ago] (2,)</span>
</span><span id="__span-24-53"><span class="go">INFO Engine SELECT heroteamlink.team_id AS heroteamlink_team_id, heroteamlink.hero_id AS heroteamlink_hero_id, heroteamlink.is_training AS heroteamlink_is_training</span>
</span><span id="__span-24-54"><span class="go">FROM heroteamlink</span>
</span><span id="__span-24-55"><span class="go">WHERE ? = heroteamlink.team_id</span>
</span><span id="__span-24-56"><span class="go">INFO Engine [cached since 0.005778s ago] (2,)</span>
</span><span id="__span-24-57">
</span><span id="__span-24-58"><span class="go">// Print Preventers hero data, including link data</span>
</span><span id="__span-24-59"><span class="go">Preventers hero: name=&#39;Deadpond&#39; age=None id=1 secret_name=&#39;Dive Wilson&#39; is training: True</span>
</span><span id="__span-24-60">
</span><span id="__span-24-61"><span class="go">// Automatically fetch the data on attribute access</span>
</span><span id="__span-24-62"><span class="go">INFO Engine SELECT hero.id AS hero_id, hero.name AS hero_name, hero.secret_name AS hero_secret_name, hero.age AS hero_age</span>
</span><span id="__span-24-63"><span class="go">FROM hero</span>
</span><span id="__span-24-64"><span class="go">WHERE hero.id = ?</span>
</span><span id="__span-24-65"><span class="go">INFO Engine [cached since 0.004196s ago] (2,)</span>
</span><span id="__span-24-66">
</span><span id="__span-24-67"><span class="go">// Print Preventers hero data, including link data</span>
</span><span id="__span-24-68"><span class="go">Preventers hero: name=&#39;Spider-Boy&#39; age=None id=2 secret_name=&#39;Pedro Parqueador&#39; is training: True</span>
</span><span id="__span-24-69">
</span><span id="__span-24-70"><span class="go">// Automatically fetch the data on attribute access</span>
</span><span id="__span-24-71"><span class="go">INFO Engine SELECT hero.id AS hero_id, hero.name AS hero_name, hero.secret_name AS hero_secret_name, hero.age AS hero_age</span>
</span><span id="__span-24-72"><span class="go">FROM hero</span>
</span><span id="__span-24-73"><span class="go">WHERE hero.id = ?</span>
</span><span id="__span-24-74"><span class="go">INFO Engine [cached since 0.006005s ago] (3,)</span>
</span><span id="__span-24-75">
</span><span id="__span-24-76"><span class="go">// Print Preventers hero data, including link data</span>
</span><span id="__span-24-77"><span class="go">Preventers hero: name=&#39;Rusty-Man&#39; age=48 id=3 secret_name=&#39;Tommy Sharp&#39; is training: False</span>
</span></code></pre></div>

</div>

<h2 id="add-relationships">Add Relationships<a class="headerlink" href="#add-relationships" title="Permanent link">&para;</a></h2>
<p>Now, to add a new relationship, we have to create a new <code>HeroTeamLink</code> instance pointing to the hero and the team, add it to the session, and commit it.</p>
<p>Here we do that in the <code>update_heroes()</code> function:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="9:3"><input checked="checked" id="__tabbed_9_1" name="__tabbed_9" type="radio" /><input id="__tabbed_9_2" name="__tabbed_9" type="radio" /><input id="__tabbed_9_3" name="__tabbed_9" type="radio" /><div class="tabbed-labels"><label for="__tabbed_9_1">Python 3.10+</label><label for="__tabbed_9_2">Python 3.9+</label><label for="__tabbed_9_3">Python 3.7+</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-25-1"><span class="c1"># Code above omitted 👆</span>
</span><span id="__span-25-2">
</span><span id="__span-25-3"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-25-4">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-25-5">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-25-6">            <span class="n">select</span><span class="p">(</span><span class="n">Hero</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hero</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Spider-Boy&quot;</span><span class="p">)</span>
</span><span id="__span-25-7">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-25-8">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Z-Force&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-25-9">
</span><span id="__span-25-10"><span class="hll">        <span class="n">spider_boy_z_force_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span></span><span id="__span-25-11"><span class="hll">            <span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_spider_boy</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span></span><span id="__span-25-12"><span class="hll">        <span class="p">)</span>
</span></span><span id="__span-25-13"><span class="hll">        <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spider_boy_z_force_link</span><span class="p">)</span>
</span></span><span id="__span-25-14"><span class="hll">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_z_force</span><span class="p">)</span>
</span></span><span id="__span-25-15"><span class="hll">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span></span><span id="__span-25-16">
</span><span id="__span-25-17">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Updated Spider-Boy&#39;s Teams:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">)</span>
</span><span id="__span-25-18">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Z-Force heroes:&quot;</span><span class="p">,</span> <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="p">)</span>
</span><span id="__span-25-19">
</span><span id="__span-25-20"><span class="c1"># Code below omitted 👇</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-26-1"><span class="c1"># Code above omitted 👆</span>
</span><span id="__span-26-2">
</span><span id="__span-26-3"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-26-4">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-26-5">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-26-6">            <span class="n">select</span><span class="p">(</span><span class="n">Hero</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hero</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Spider-Boy&quot;</span><span class="p">)</span>
</span><span id="__span-26-7">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-26-8">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Z-Force&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-26-9">
</span><span id="__span-26-10"><span class="hll">        <span class="n">spider_boy_z_force_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span></span><span id="__span-26-11"><span class="hll">            <span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_spider_boy</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span></span><span id="__span-26-12"><span class="hll">        <span class="p">)</span>
</span></span><span id="__span-26-13"><span class="hll">        <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spider_boy_z_force_link</span><span class="p">)</span>
</span></span><span id="__span-26-14"><span class="hll">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_z_force</span><span class="p">)</span>
</span></span><span id="__span-26-15"><span class="hll">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span></span><span id="__span-26-16">
</span><span id="__span-26-17">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Updated Spider-Boy&#39;s Teams:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">)</span>
</span><span id="__span-26-18">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Z-Force heroes:&quot;</span><span class="p">,</span> <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="p">)</span>
</span><span id="__span-26-19">
</span><span id="__span-26-20"><span class="c1"># Code below omitted 👇</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-27-1"><span class="c1"># Code above omitted 👆</span>
</span><span id="__span-27-2">
</span><span id="__span-27-3"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-27-4">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-27-5">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-27-6">            <span class="n">select</span><span class="p">(</span><span class="n">Hero</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hero</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Spider-Boy&quot;</span><span class="p">)</span>
</span><span id="__span-27-7">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-27-8">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Z-Force&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-27-9">
</span><span id="__span-27-10"><span class="hll">        <span class="n">spider_boy_z_force_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span></span><span id="__span-27-11"><span class="hll">            <span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_spider_boy</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span></span><span id="__span-27-12"><span class="hll">        <span class="p">)</span>
</span></span><span id="__span-27-13"><span class="hll">        <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spider_boy_z_force_link</span><span class="p">)</span>
</span></span><span id="__span-27-14"><span class="hll">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_z_force</span><span class="p">)</span>
</span></span><span id="__span-27-15"><span class="hll">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span></span><span id="__span-27-16">
</span><span id="__span-27-17">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Updated Spider-Boy&#39;s Teams:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">)</span>
</span><span id="__span-27-18">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Z-Force heroes:&quot;</span><span class="p">,</span> <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="p">)</span>
</span><span id="__span-27-19">
</span><span id="__span-27-20"><span class="c1"># Code below omitted 👇</span>
</span></code></pre></div>
</div>
</div>
</div>
<details>
<summary>👀 Full file preview</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="10:3"><input checked="checked" id="__tabbed_10_1" name="__tabbed_10" type="radio" /><input id="__tabbed_10_2" name="__tabbed_10" type="radio" /><input id="__tabbed_10_3" name="__tabbed_10" type="radio" /><div class="tabbed-labels"><label for="__tabbed_10_1">Python 3.10+</label><label for="__tabbed_10_2">Python 3.9+</label><label for="__tabbed_10_3">Python 3.7+</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-28-1"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">select</span>
</span><span id="__span-28-2">
</span><span id="__span-28-3">
</span><span id="__span-28-4"><span class="k">class</span> <span class="nc">HeroTeamLink</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-28-5">    <span class="n">team_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-28-6">    <span class="n">hero_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;hero.id&quot;</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-28-7">    <span class="n">is_training</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-28-8">
</span><span id="__span-28-9">    <span class="n">team</span><span class="p">:</span> <span class="s2">&quot;Team&quot;</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;hero_links&quot;</span><span class="p">)</span>
</span><span id="__span-28-10">    <span class="n">hero</span><span class="p">:</span> <span class="s2">&quot;Hero&quot;</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team_links&quot;</span><span class="p">)</span>
</span><span id="__span-28-11">
</span><span id="__span-28-12">
</span><span id="__span-28-13"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-28-14">    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-28-15">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-28-16">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-28-17">
</span><span id="__span-28-18">    <span class="n">hero_links</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">HeroTeamLink</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team&quot;</span><span class="p">)</span>
</span><span id="__span-28-19">
</span><span id="__span-28-20">
</span><span id="__span-28-21"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-28-22">    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-28-23">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-28-24">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-28-25">    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-28-26">
</span><span id="__span-28-27">    <span class="n">team_links</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">HeroTeamLink</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;hero&quot;</span><span class="p">)</span>
</span><span id="__span-28-28">
</span><span id="__span-28-29">
</span><span id="__span-28-30"><span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
</span><span id="__span-28-31"><span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-28-32">
</span><span id="__span-28-33"><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-28-34">
</span><span id="__span-28-35">
</span><span id="__span-28-36"><span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
</span><span id="__span-28-37">    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
</span><span id="__span-28-38">
</span><span id="__span-28-39">
</span><span id="__span-28-40"><span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
</span><span id="__span-28-41">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-28-42">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Preventers&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sharp Tower&quot;</span><span class="p">)</span>
</span><span id="__span-28-43">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Z-Force&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sister Margaret&#39;s Bar&quot;</span><span class="p">)</span>
</span><span id="__span-28-44">
</span><span id="__span-28-45">        <span class="n">hero_deadpond</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-28-46">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span>
</span><span id="__span-28-47">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Dive Wilson&quot;</span><span class="p">,</span>
</span><span id="__span-28-48">        <span class="p">)</span>
</span><span id="__span-28-49">        <span class="n">hero_rusty_man</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-28-50">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span>
</span><span id="__span-28-51">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span>
</span><span id="__span-28-52">            <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span>
</span><span id="__span-28-53">        <span class="p">)</span>
</span><span id="__span-28-54">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-28-55">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span>
</span><span id="__span-28-56">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">,</span>
</span><span id="__span-28-57">        <span class="p">)</span>
</span><span id="__span-28-58">        <span class="n">deadpond_team_z_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span><span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-28-59">        <span class="n">deadpond_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-28-60">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_deadpond</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-28-61">        <span class="p">)</span>
</span><span id="__span-28-62">        <span class="n">spider_boy_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-28-63">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_spider_boy</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-28-64">        <span class="p">)</span>
</span><span id="__span-28-65">        <span class="n">rusty_man_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-28-66">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_rusty_man</span>
</span><span id="__span-28-67">        <span class="p">)</span>
</span><span id="__span-28-68">
</span><span id="__span-28-69">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">deadpond_team_z_link</span><span class="p">)</span>
</span><span id="__span-28-70">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">deadpond_preventers_link</span><span class="p">)</span>
</span><span id="__span-28-71">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">spider_boy_preventers_link</span><span class="p">)</span>
</span><span id="__span-28-72">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rusty_man_preventers_link</span><span class="p">)</span>
</span><span id="__span-28-73">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-28-74">
</span><span id="__span-28-75">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="p">:</span>
</span><span id="__span-28-76">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Z-Force hero:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">hero</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-28-77">
</span><span id="__span-28-78">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">team_preventers</span><span class="o">.</span><span class="n">hero_links</span><span class="p">:</span>
</span><span id="__span-28-79">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers hero:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">hero</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-28-80">
</span><span id="__span-28-81">
</span><span id="__span-28-82"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-28-83">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-28-84">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-28-85">            <span class="n">select</span><span class="p">(</span><span class="n">Hero</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hero</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Spider-Boy&quot;</span><span class="p">)</span>
</span><span id="__span-28-86">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-28-87">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Z-Force&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-28-88">
</span><span id="__span-28-89">        <span class="n">spider_boy_z_force_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-28-90">            <span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_spider_boy</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-28-91">        <span class="p">)</span>
</span><span id="__span-28-92">        <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spider_boy_z_force_link</span><span class="p">)</span>
</span><span id="__span-28-93">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_z_force</span><span class="p">)</span>
</span><span id="__span-28-94">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-28-95">
</span><span id="__span-28-96">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Updated Spider-Boy&#39;s Teams:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">)</span>
</span><span id="__span-28-97">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Z-Force heroes:&quot;</span><span class="p">,</span> <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="p">)</span>
</span><span id="__span-28-98">
</span><span id="__span-28-99">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">:</span>
</span><span id="__span-28-100">            <span class="k">if</span> <span class="n">link</span><span class="o">.</span><span class="n">team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">:</span>
</span><span id="__span-28-101">                <span class="n">link</span><span class="o">.</span><span class="n">is_training</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-28-102">
</span><span id="__span-28-103">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-28-104">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-28-105">
</span><span id="__span-28-106">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">:</span>
</span><span id="__span-28-107">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy team:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">team</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-28-108">
</span><span id="__span-28-109">
</span><span id="__span-28-110"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span id="__span-28-111">    <span class="n">create_db_and_tables</span><span class="p">()</span>
</span><span id="__span-28-112">    <span class="n">create_heroes</span><span class="p">()</span>
</span><span id="__span-28-113">    <span class="n">update_heroes</span><span class="p">()</span>
</span><span id="__span-28-114">
</span><span id="__span-28-115">
</span><span id="__span-28-116"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-28-117">    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-29-1"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>
</span><span id="__span-29-2">
</span><span id="__span-29-3"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">select</span>
</span><span id="__span-29-4">
</span><span id="__span-29-5">
</span><span id="__span-29-6"><span class="k">class</span> <span class="nc">HeroTeamLink</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-29-7">    <span class="n">team_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
</span><span id="__span-29-8">        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-29-9">    <span class="p">)</span>
</span><span id="__span-29-10">    <span class="n">hero_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
</span><span id="__span-29-11">        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;hero.id&quot;</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-29-12">    <span class="p">)</span>
</span><span id="__span-29-13">    <span class="n">is_training</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-29-14">
</span><span id="__span-29-15">    <span class="n">team</span><span class="p">:</span> <span class="s2">&quot;Team&quot;</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;hero_links&quot;</span><span class="p">)</span>
</span><span id="__span-29-16">    <span class="n">hero</span><span class="p">:</span> <span class="s2">&quot;Hero&quot;</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team_links&quot;</span><span class="p">)</span>
</span><span id="__span-29-17">
</span><span id="__span-29-18">
</span><span id="__span-29-19"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-29-20">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-29-21">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-29-22">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-29-23">
</span><span id="__span-29-24">    <span class="n">hero_links</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">HeroTeamLink</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team&quot;</span><span class="p">)</span>
</span><span id="__span-29-25">
</span><span id="__span-29-26">
</span><span id="__span-29-27"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-29-28">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-29-29">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-29-30">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-29-31">    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-29-32">
</span><span id="__span-29-33">    <span class="n">team_links</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">HeroTeamLink</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;hero&quot;</span><span class="p">)</span>
</span><span id="__span-29-34">
</span><span id="__span-29-35">
</span><span id="__span-29-36"><span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
</span><span id="__span-29-37"><span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-29-38">
</span><span id="__span-29-39"><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-29-40">
</span><span id="__span-29-41">
</span><span id="__span-29-42"><span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
</span><span id="__span-29-43">    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
</span><span id="__span-29-44">
</span><span id="__span-29-45">
</span><span id="__span-29-46"><span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
</span><span id="__span-29-47">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-29-48">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Preventers&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sharp Tower&quot;</span><span class="p">)</span>
</span><span id="__span-29-49">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Z-Force&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sister Margaret&#39;s Bar&quot;</span><span class="p">)</span>
</span><span id="__span-29-50">
</span><span id="__span-29-51">        <span class="n">hero_deadpond</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-29-52">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span>
</span><span id="__span-29-53">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Dive Wilson&quot;</span><span class="p">,</span>
</span><span id="__span-29-54">        <span class="p">)</span>
</span><span id="__span-29-55">        <span class="n">hero_rusty_man</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-29-56">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span>
</span><span id="__span-29-57">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span>
</span><span id="__span-29-58">            <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span>
</span><span id="__span-29-59">        <span class="p">)</span>
</span><span id="__span-29-60">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-29-61">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span>
</span><span id="__span-29-62">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">,</span>
</span><span id="__span-29-63">        <span class="p">)</span>
</span><span id="__span-29-64">        <span class="n">deadpond_team_z_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span><span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-29-65">        <span class="n">deadpond_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-29-66">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_deadpond</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-29-67">        <span class="p">)</span>
</span><span id="__span-29-68">        <span class="n">spider_boy_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-29-69">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_spider_boy</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-29-70">        <span class="p">)</span>
</span><span id="__span-29-71">        <span class="n">rusty_man_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-29-72">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_rusty_man</span>
</span><span id="__span-29-73">        <span class="p">)</span>
</span><span id="__span-29-74">
</span><span id="__span-29-75">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">deadpond_team_z_link</span><span class="p">)</span>
</span><span id="__span-29-76">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">deadpond_preventers_link</span><span class="p">)</span>
</span><span id="__span-29-77">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">spider_boy_preventers_link</span><span class="p">)</span>
</span><span id="__span-29-78">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rusty_man_preventers_link</span><span class="p">)</span>
</span><span id="__span-29-79">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-29-80">
</span><span id="__span-29-81">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="p">:</span>
</span><span id="__span-29-82">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Z-Force hero:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">hero</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-29-83">
</span><span id="__span-29-84">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">team_preventers</span><span class="o">.</span><span class="n">hero_links</span><span class="p">:</span>
</span><span id="__span-29-85">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers hero:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">hero</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-29-86">
</span><span id="__span-29-87">
</span><span id="__span-29-88"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-29-89">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-29-90">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-29-91">            <span class="n">select</span><span class="p">(</span><span class="n">Hero</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hero</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Spider-Boy&quot;</span><span class="p">)</span>
</span><span id="__span-29-92">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-29-93">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Z-Force&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-29-94">
</span><span id="__span-29-95">        <span class="n">spider_boy_z_force_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-29-96">            <span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_spider_boy</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-29-97">        <span class="p">)</span>
</span><span id="__span-29-98">        <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spider_boy_z_force_link</span><span class="p">)</span>
</span><span id="__span-29-99">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_z_force</span><span class="p">)</span>
</span><span id="__span-29-100">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-29-101">
</span><span id="__span-29-102">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Updated Spider-Boy&#39;s Teams:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">)</span>
</span><span id="__span-29-103">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Z-Force heroes:&quot;</span><span class="p">,</span> <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="p">)</span>
</span><span id="__span-29-104">
</span><span id="__span-29-105">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">:</span>
</span><span id="__span-29-106">            <span class="k">if</span> <span class="n">link</span><span class="o">.</span><span class="n">team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">:</span>
</span><span id="__span-29-107">                <span class="n">link</span><span class="o">.</span><span class="n">is_training</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-29-108">
</span><span id="__span-29-109">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-29-110">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-29-111">
</span><span id="__span-29-112">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">:</span>
</span><span id="__span-29-113">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy team:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">team</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-29-114">
</span><span id="__span-29-115">
</span><span id="__span-29-116"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span id="__span-29-117">    <span class="n">create_db_and_tables</span><span class="p">()</span>
</span><span id="__span-29-118">    <span class="n">create_heroes</span><span class="p">()</span>
</span><span id="__span-29-119">    <span class="n">update_heroes</span><span class="p">()</span>
</span><span id="__span-29-120">
</span><span id="__span-29-121">
</span><span id="__span-29-122"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-29-123">    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-30-1"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span>
</span><span id="__span-30-2">
</span><span id="__span-30-3"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">select</span>
</span><span id="__span-30-4">
</span><span id="__span-30-5">
</span><span id="__span-30-6"><span class="k">class</span> <span class="nc">HeroTeamLink</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-30-7">    <span class="n">team_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
</span><span id="__span-30-8">        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-30-9">    <span class="p">)</span>
</span><span id="__span-30-10">    <span class="n">hero_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
</span><span id="__span-30-11">        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;hero.id&quot;</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-30-12">    <span class="p">)</span>
</span><span id="__span-30-13">    <span class="n">is_training</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-30-14">
</span><span id="__span-30-15">    <span class="n">team</span><span class="p">:</span> <span class="s2">&quot;Team&quot;</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;hero_links&quot;</span><span class="p">)</span>
</span><span id="__span-30-16">    <span class="n">hero</span><span class="p">:</span> <span class="s2">&quot;Hero&quot;</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team_links&quot;</span><span class="p">)</span>
</span><span id="__span-30-17">
</span><span id="__span-30-18">
</span><span id="__span-30-19"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-30-20">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-30-21">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-30-22">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-30-23">
</span><span id="__span-30-24">    <span class="n">hero_links</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">HeroTeamLink</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team&quot;</span><span class="p">)</span>
</span><span id="__span-30-25">
</span><span id="__span-30-26">
</span><span id="__span-30-27"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-30-28">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-30-29">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-30-30">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-30-31">    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-30-32">
</span><span id="__span-30-33">    <span class="n">team_links</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">HeroTeamLink</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;hero&quot;</span><span class="p">)</span>
</span><span id="__span-30-34">
</span><span id="__span-30-35">
</span><span id="__span-30-36"><span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
</span><span id="__span-30-37"><span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-30-38">
</span><span id="__span-30-39"><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-30-40">
</span><span id="__span-30-41">
</span><span id="__span-30-42"><span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
</span><span id="__span-30-43">    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
</span><span id="__span-30-44">
</span><span id="__span-30-45">
</span><span id="__span-30-46"><span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
</span><span id="__span-30-47">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-30-48">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Preventers&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sharp Tower&quot;</span><span class="p">)</span>
</span><span id="__span-30-49">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Z-Force&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sister Margaret&#39;s Bar&quot;</span><span class="p">)</span>
</span><span id="__span-30-50">
</span><span id="__span-30-51">        <span class="n">hero_deadpond</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-30-52">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span>
</span><span id="__span-30-53">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Dive Wilson&quot;</span><span class="p">,</span>
</span><span id="__span-30-54">        <span class="p">)</span>
</span><span id="__span-30-55">        <span class="n">hero_rusty_man</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-30-56">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span>
</span><span id="__span-30-57">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span>
</span><span id="__span-30-58">            <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span>
</span><span id="__span-30-59">        <span class="p">)</span>
</span><span id="__span-30-60">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-30-61">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span>
</span><span id="__span-30-62">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">,</span>
</span><span id="__span-30-63">        <span class="p">)</span>
</span><span id="__span-30-64">        <span class="n">deadpond_team_z_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span><span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-30-65">        <span class="n">deadpond_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-30-66">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_deadpond</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-30-67">        <span class="p">)</span>
</span><span id="__span-30-68">        <span class="n">spider_boy_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-30-69">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_spider_boy</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-30-70">        <span class="p">)</span>
</span><span id="__span-30-71">        <span class="n">rusty_man_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-30-72">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_rusty_man</span>
</span><span id="__span-30-73">        <span class="p">)</span>
</span><span id="__span-30-74">
</span><span id="__span-30-75">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">deadpond_team_z_link</span><span class="p">)</span>
</span><span id="__span-30-76">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">deadpond_preventers_link</span><span class="p">)</span>
</span><span id="__span-30-77">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">spider_boy_preventers_link</span><span class="p">)</span>
</span><span id="__span-30-78">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rusty_man_preventers_link</span><span class="p">)</span>
</span><span id="__span-30-79">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-30-80">
</span><span id="__span-30-81">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="p">:</span>
</span><span id="__span-30-82">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Z-Force hero:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">hero</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-30-83">
</span><span id="__span-30-84">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">team_preventers</span><span class="o">.</span><span class="n">hero_links</span><span class="p">:</span>
</span><span id="__span-30-85">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers hero:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">hero</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-30-86">
</span><span id="__span-30-87">
</span><span id="__span-30-88"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-30-89">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-30-90">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-30-91">            <span class="n">select</span><span class="p">(</span><span class="n">Hero</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hero</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Spider-Boy&quot;</span><span class="p">)</span>
</span><span id="__span-30-92">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-30-93">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Z-Force&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-30-94">
</span><span id="__span-30-95">        <span class="n">spider_boy_z_force_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-30-96">            <span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_spider_boy</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-30-97">        <span class="p">)</span>
</span><span id="__span-30-98">        <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spider_boy_z_force_link</span><span class="p">)</span>
</span><span id="__span-30-99">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_z_force</span><span class="p">)</span>
</span><span id="__span-30-100">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-30-101">
</span><span id="__span-30-102">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Updated Spider-Boy&#39;s Teams:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">)</span>
</span><span id="__span-30-103">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Z-Force heroes:&quot;</span><span class="p">,</span> <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="p">)</span>
</span><span id="__span-30-104">
</span><span id="__span-30-105">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">:</span>
</span><span id="__span-30-106">            <span class="k">if</span> <span class="n">link</span><span class="o">.</span><span class="n">team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">:</span>
</span><span id="__span-30-107">                <span class="n">link</span><span class="o">.</span><span class="n">is_training</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-30-108">
</span><span id="__span-30-109">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-30-110">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-30-111">
</span><span id="__span-30-112">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">:</span>
</span><span id="__span-30-113">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy team:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">team</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-30-114">
</span><span id="__span-30-115">
</span><span id="__span-30-116"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span id="__span-30-117">    <span class="n">create_db_and_tables</span><span class="p">()</span>
</span><span id="__span-30-118">    <span class="n">create_heroes</span><span class="p">()</span>
</span><span id="__span-30-119">    <span class="n">update_heroes</span><span class="p">()</span>
</span><span id="__span-30-120">
</span><span id="__span-30-121">
</span><span id="__span-30-122"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-30-123">    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div>
</div>
</div>
</div>
</details>
<h2 id="run-the-program-with-the-new-relationship">Run the Program with the New Relationship<a class="headerlink" href="#run-the-program-with-the-new-relationship" title="Permanent link">&para;</a></h2>
<p>If we run that program, we will see the output:</p>
<div class="termy">

<div class="highlight"><pre><span></span><code><span id="__span-31-1"><span class="gp">$ </span>python<span class="w"> </span>app.py
</span><span id="__span-31-2">
</span><span id="__span-31-3"><span class="go">// Previous output omitted 🙈</span>
</span><span id="__span-31-4">
</span><span id="__span-31-5"><span class="go">// Automatically start a new transaction</span>
</span><span id="__span-31-6"><span class="go">INFO Engine BEGIN (implicit)</span>
</span><span id="__span-31-7">
</span><span id="__span-31-8"><span class="go">// Select the hero</span>
</span><span id="__span-31-9"><span class="go">INFO Engine SELECT hero.id, hero.name, hero.secret_name, hero.age</span>
</span><span id="__span-31-10"><span class="go">FROM hero</span>
</span><span id="__span-31-11"><span class="go">WHERE hero.name = ?</span>
</span><span id="__span-31-12"><span class="go">INFO Engine [no key 0.00014s] (&#39;Spider-Boy&#39;,)</span>
</span><span id="__span-31-13">
</span><span id="__span-31-14"><span class="go">// Select the team</span>
</span><span id="__span-31-15"><span class="go">INFO Engine SELECT team.id, team.name, team.headquarters</span>
</span><span id="__span-31-16"><span class="go">FROM team</span>
</span><span id="__span-31-17"><span class="go">WHERE team.name = ?</span>
</span><span id="__span-31-18"><span class="go">INFO Engine [no key 0.00012s] (&#39;Z-Force&#39;,)</span>
</span><span id="__span-31-19">
</span><span id="__span-31-20"><span class="go">// Create the link</span>
</span><span id="__span-31-21"><span class="go">INFO Engine INSERT INTO heroteamlink (team_id, hero_id, is_training) VALUES (?, ?, ?)</span>
</span><span id="__span-31-22"><span class="go">INFO Engine [generated in 0.00023s] (1, 2, 1)</span>
</span><span id="__span-31-23">
</span><span id="__span-31-24"><span class="go">// Automatically refresh the data on attribute access</span>
</span><span id="__span-31-25"><span class="go">INFO Engine SELECT heroteamlink.team_id AS heroteamlink_team_id, heroteamlink.hero_id AS heroteamlink_hero_id, heroteamlink.is_training AS heroteamlink_is_training</span>
</span><span id="__span-31-26"><span class="go">FROM heroteamlink</span>
</span><span id="__span-31-27"><span class="go">WHERE ? = heroteamlink.team_id</span>
</span><span id="__span-31-28"><span class="go">INFO Engine [cached since 0.01514s ago] (1,)</span>
</span><span id="__span-31-29"><span class="go">INFO Engine COMMIT</span>
</span><span id="__span-31-30"><span class="go">INFO Engine BEGIN (implicit)</span>
</span><span id="__span-31-31"><span class="go">INFO Engine SELECT hero.id AS hero_id, hero.name AS hero_name, hero.secret_name AS hero_secret_name, hero.age AS hero_age</span>
</span><span id="__span-31-32"><span class="go">FROM hero</span>
</span><span id="__span-31-33"><span class="go">WHERE hero.id = ?</span>
</span><span id="__span-31-34"><span class="go">INFO Engine [cached since 0.08953s ago] (2,)</span>
</span><span id="__span-31-35"><span class="go">INFO Engine SELECT heroteamlink.team_id AS heroteamlink_team_id, heroteamlink.hero_id AS heroteamlink_hero_id, heroteamlink.is_training AS heroteamlink_is_training</span>
</span><span id="__span-31-36"><span class="go">FROM heroteamlink</span>
</span><span id="__span-31-37"><span class="go">WHERE ? = heroteamlink.hero_id</span>
</span><span id="__span-31-38"><span class="go">INFO Engine [generated in 0.00018s] (2,)</span>
</span><span id="__span-31-39">
</span><span id="__span-31-40"><span class="go">// Print updated hero links</span>
</span><span id="__span-31-41"><span class="go">Updated Spider-Boy&#39;s Teams: [</span>
</span><span id="__span-31-42"><span class="go">    HeroTeamLink(team_id=2, is_training=True, hero_id=2),</span>
</span><span id="__span-31-43"><span class="go">    HeroTeamLink(team_id=1, is_training=True, hero_id=2)</span>
</span><span id="__span-31-44"><span class="go">]</span>
</span><span id="__span-31-45">
</span><span id="__span-31-46"><span class="go">// Automatically refresh team data on attribute access</span>
</span><span id="__span-31-47"><span class="go">INFO Engine SELECT team.id AS team_id, team.name AS team_name, team.headquarters AS team_headquarters</span>
</span><span id="__span-31-48"><span class="go">FROM team</span>
</span><span id="__span-31-49"><span class="go">WHERE team.id = ?</span>
</span><span id="__span-31-50"><span class="go">INFO Engine [cached since 0.1084s ago] (1,)</span>
</span><span id="__span-31-51"><span class="go">INFO Engine SELECT heroteamlink.team_id AS heroteamlink_team_id, heroteamlink.hero_id AS heroteamlink_hero_id, heroteamlink.is_training AS heroteamlink_is_training</span>
</span><span id="__span-31-52"><span class="go">FROM heroteamlink</span>
</span><span id="__span-31-53"><span class="go">WHERE ? = heroteamlink.team_id</span>
</span><span id="__span-31-54"><span class="go">INFO Engine [cached since 0.1054s ago] (1,)</span>
</span><span id="__span-31-55">
</span><span id="__span-31-56"><span class="go">// Print team hero links</span>
</span><span id="__span-31-57"><span class="go">Z-Force heroes: [</span>
</span><span id="__span-31-58"><span class="go">    HeroTeamLink(team_id=1, is_training=False, hero_id=1),</span>
</span><span id="__span-31-59"><span class="go">    HeroTeamLink(team_id=1, is_training=True, hero_id=2)</span>
</span><span id="__span-31-60"><span class="go">]</span>
</span></code></pre></div>

</div>

<h2 id="update-relationships-with-links">Update Relationships with Links<a class="headerlink" href="#update-relationships-with-links" title="Permanent link">&para;</a></h2>
<p>Now let's say that <strong>Spider-Boy</strong> has been training enough in the <strong>Preventers</strong>, and they say he can join the team full time.</p>
<p>So now we want to update the status of <code>is_training</code> to <code>False</code>.</p>
<p>We can do that by iterating on the links:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="11:3"><input checked="checked" id="__tabbed_11_1" name="__tabbed_11" type="radio" /><input id="__tabbed_11_2" name="__tabbed_11" type="radio" /><input id="__tabbed_11_3" name="__tabbed_11" type="radio" /><div class="tabbed-labels"><label for="__tabbed_11_1">Python 3.10+</label><label for="__tabbed_11_2">Python 3.9+</label><label for="__tabbed_11_3">Python 3.7+</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-32-1"><span class="c1"># Code above omitted 👆</span>
</span><span id="__span-32-2">
</span><span id="__span-32-3"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-32-4">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-32-5">
</span><span id="__span-32-6">        <span class="c1"># Code here omitted 👈</span>
</span><span id="__span-32-7">
</span><span id="__span-32-8"><span class="hll">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">:</span>
</span></span><span id="__span-32-9"><span class="hll">            <span class="k">if</span> <span class="n">link</span><span class="o">.</span><span class="n">team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">:</span>
</span></span><span id="__span-32-10"><span class="hll">                <span class="n">link</span><span class="o">.</span><span class="n">is_training</span> <span class="o">=</span> <span class="kc">False</span>
</span></span><span id="__span-32-11">
</span><span id="__span-32-12">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-32-13">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-32-14">
</span><span id="__span-32-15">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">:</span>
</span><span id="__span-32-16">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy team:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">team</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-32-17">
</span><span id="__span-32-18"><span class="c1"># Code below omitted 👇</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-33-1"><span class="c1"># Code above omitted 👆</span>
</span><span id="__span-33-2">
</span><span id="__span-33-3"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-33-4">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-33-5">
</span><span id="__span-33-6">        <span class="c1"># Code here omitted 👈</span>
</span><span id="__span-33-7">
</span><span id="__span-33-8"><span class="hll">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">:</span>
</span></span><span id="__span-33-9"><span class="hll">            <span class="k">if</span> <span class="n">link</span><span class="o">.</span><span class="n">team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">:</span>
</span></span><span id="__span-33-10"><span class="hll">                <span class="n">link</span><span class="o">.</span><span class="n">is_training</span> <span class="o">=</span> <span class="kc">False</span>
</span></span><span id="__span-33-11">
</span><span id="__span-33-12">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-33-13">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-33-14">
</span><span id="__span-33-15">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">:</span>
</span><span id="__span-33-16">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy team:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">team</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-33-17">
</span><span id="__span-33-18"><span class="c1"># Code below omitted 👇</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-34-1"><span class="c1"># Code above omitted 👆</span>
</span><span id="__span-34-2">
</span><span id="__span-34-3"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-34-4">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-34-5">
</span><span id="__span-34-6">        <span class="c1"># Code here omitted 👈</span>
</span><span id="__span-34-7">
</span><span id="__span-34-8"><span class="hll">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">:</span>
</span></span><span id="__span-34-9"><span class="hll">            <span class="k">if</span> <span class="n">link</span><span class="o">.</span><span class="n">team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">:</span>
</span></span><span id="__span-34-10"><span class="hll">                <span class="n">link</span><span class="o">.</span><span class="n">is_training</span> <span class="o">=</span> <span class="kc">False</span>
</span></span><span id="__span-34-11">
</span><span id="__span-34-12">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-34-13">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-34-14">
</span><span id="__span-34-15">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">:</span>
</span><span id="__span-34-16">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy team:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">team</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-34-17">
</span><span id="__span-34-18"><span class="c1"># Code below omitted 👇</span>
</span></code></pre></div>
</div>
</div>
</div>
<details>
<summary>👀 Full file preview</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="12:3"><input checked="checked" id="__tabbed_12_1" name="__tabbed_12" type="radio" /><input id="__tabbed_12_2" name="__tabbed_12" type="radio" /><input id="__tabbed_12_3" name="__tabbed_12" type="radio" /><div class="tabbed-labels"><label for="__tabbed_12_1">Python 3.10+</label><label for="__tabbed_12_2">Python 3.9+</label><label for="__tabbed_12_3">Python 3.7+</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-35-1"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">select</span>
</span><span id="__span-35-2">
</span><span id="__span-35-3">
</span><span id="__span-35-4"><span class="k">class</span> <span class="nc">HeroTeamLink</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-35-5">    <span class="n">team_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-35-6">    <span class="n">hero_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;hero.id&quot;</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-35-7">    <span class="n">is_training</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-35-8">
</span><span id="__span-35-9">    <span class="n">team</span><span class="p">:</span> <span class="s2">&quot;Team&quot;</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;hero_links&quot;</span><span class="p">)</span>
</span><span id="__span-35-10">    <span class="n">hero</span><span class="p">:</span> <span class="s2">&quot;Hero&quot;</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team_links&quot;</span><span class="p">)</span>
</span><span id="__span-35-11">
</span><span id="__span-35-12">
</span><span id="__span-35-13"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-35-14">    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-35-15">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-35-16">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-35-17">
</span><span id="__span-35-18">    <span class="n">hero_links</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">HeroTeamLink</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team&quot;</span><span class="p">)</span>
</span><span id="__span-35-19">
</span><span id="__span-35-20">
</span><span id="__span-35-21"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-35-22">    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-35-23">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-35-24">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-35-25">    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-35-26">
</span><span id="__span-35-27">    <span class="n">team_links</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">HeroTeamLink</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;hero&quot;</span><span class="p">)</span>
</span><span id="__span-35-28">
</span><span id="__span-35-29">
</span><span id="__span-35-30"><span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
</span><span id="__span-35-31"><span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-35-32">
</span><span id="__span-35-33"><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-35-34">
</span><span id="__span-35-35">
</span><span id="__span-35-36"><span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
</span><span id="__span-35-37">    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
</span><span id="__span-35-38">
</span><span id="__span-35-39">
</span><span id="__span-35-40"><span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
</span><span id="__span-35-41">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-35-42">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Preventers&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sharp Tower&quot;</span><span class="p">)</span>
</span><span id="__span-35-43">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Z-Force&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sister Margaret&#39;s Bar&quot;</span><span class="p">)</span>
</span><span id="__span-35-44">
</span><span id="__span-35-45">        <span class="n">hero_deadpond</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-35-46">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span>
</span><span id="__span-35-47">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Dive Wilson&quot;</span><span class="p">,</span>
</span><span id="__span-35-48">        <span class="p">)</span>
</span><span id="__span-35-49">        <span class="n">hero_rusty_man</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-35-50">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span>
</span><span id="__span-35-51">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span>
</span><span id="__span-35-52">            <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span>
</span><span id="__span-35-53">        <span class="p">)</span>
</span><span id="__span-35-54">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-35-55">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span>
</span><span id="__span-35-56">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">,</span>
</span><span id="__span-35-57">        <span class="p">)</span>
</span><span id="__span-35-58">        <span class="n">deadpond_team_z_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span><span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-35-59">        <span class="n">deadpond_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-35-60">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_deadpond</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-35-61">        <span class="p">)</span>
</span><span id="__span-35-62">        <span class="n">spider_boy_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-35-63">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_spider_boy</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-35-64">        <span class="p">)</span>
</span><span id="__span-35-65">        <span class="n">rusty_man_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-35-66">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_rusty_man</span>
</span><span id="__span-35-67">        <span class="p">)</span>
</span><span id="__span-35-68">
</span><span id="__span-35-69">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">deadpond_team_z_link</span><span class="p">)</span>
</span><span id="__span-35-70">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">deadpond_preventers_link</span><span class="p">)</span>
</span><span id="__span-35-71">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">spider_boy_preventers_link</span><span class="p">)</span>
</span><span id="__span-35-72">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rusty_man_preventers_link</span><span class="p">)</span>
</span><span id="__span-35-73">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-35-74">
</span><span id="__span-35-75">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="p">:</span>
</span><span id="__span-35-76">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Z-Force hero:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">hero</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-35-77">
</span><span id="__span-35-78">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">team_preventers</span><span class="o">.</span><span class="n">hero_links</span><span class="p">:</span>
</span><span id="__span-35-79">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers hero:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">hero</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-35-80">
</span><span id="__span-35-81">
</span><span id="__span-35-82"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-35-83">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-35-84">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-35-85">            <span class="n">select</span><span class="p">(</span><span class="n">Hero</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hero</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Spider-Boy&quot;</span><span class="p">)</span>
</span><span id="__span-35-86">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-35-87">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Z-Force&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-35-88">
</span><span id="__span-35-89">        <span class="n">spider_boy_z_force_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-35-90">            <span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_spider_boy</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-35-91">        <span class="p">)</span>
</span><span id="__span-35-92">        <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spider_boy_z_force_link</span><span class="p">)</span>
</span><span id="__span-35-93">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_z_force</span><span class="p">)</span>
</span><span id="__span-35-94">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-35-95">
</span><span id="__span-35-96">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Updated Spider-Boy&#39;s Teams:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">)</span>
</span><span id="__span-35-97">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Z-Force heroes:&quot;</span><span class="p">,</span> <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="p">)</span>
</span><span id="__span-35-98">
</span><span id="__span-35-99">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">:</span>
</span><span id="__span-35-100">            <span class="k">if</span> <span class="n">link</span><span class="o">.</span><span class="n">team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">:</span>
</span><span id="__span-35-101">                <span class="n">link</span><span class="o">.</span><span class="n">is_training</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-35-102">
</span><span id="__span-35-103">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-35-104">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-35-105">
</span><span id="__span-35-106">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">:</span>
</span><span id="__span-35-107">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy team:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">team</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-35-108">
</span><span id="__span-35-109">
</span><span id="__span-35-110"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span id="__span-35-111">    <span class="n">create_db_and_tables</span><span class="p">()</span>
</span><span id="__span-35-112">    <span class="n">create_heroes</span><span class="p">()</span>
</span><span id="__span-35-113">    <span class="n">update_heroes</span><span class="p">()</span>
</span><span id="__span-35-114">
</span><span id="__span-35-115">
</span><span id="__span-35-116"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-35-117">    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-36-1"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>
</span><span id="__span-36-2">
</span><span id="__span-36-3"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">select</span>
</span><span id="__span-36-4">
</span><span id="__span-36-5">
</span><span id="__span-36-6"><span class="k">class</span> <span class="nc">HeroTeamLink</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-36-7">    <span class="n">team_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
</span><span id="__span-36-8">        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-36-9">    <span class="p">)</span>
</span><span id="__span-36-10">    <span class="n">hero_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
</span><span id="__span-36-11">        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;hero.id&quot;</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-36-12">    <span class="p">)</span>
</span><span id="__span-36-13">    <span class="n">is_training</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-36-14">
</span><span id="__span-36-15">    <span class="n">team</span><span class="p">:</span> <span class="s2">&quot;Team&quot;</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;hero_links&quot;</span><span class="p">)</span>
</span><span id="__span-36-16">    <span class="n">hero</span><span class="p">:</span> <span class="s2">&quot;Hero&quot;</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team_links&quot;</span><span class="p">)</span>
</span><span id="__span-36-17">
</span><span id="__span-36-18">
</span><span id="__span-36-19"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-36-20">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-36-21">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-36-22">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-36-23">
</span><span id="__span-36-24">    <span class="n">hero_links</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">HeroTeamLink</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team&quot;</span><span class="p">)</span>
</span><span id="__span-36-25">
</span><span id="__span-36-26">
</span><span id="__span-36-27"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-36-28">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-36-29">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-36-30">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-36-31">    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-36-32">
</span><span id="__span-36-33">    <span class="n">team_links</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">HeroTeamLink</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;hero&quot;</span><span class="p">)</span>
</span><span id="__span-36-34">
</span><span id="__span-36-35">
</span><span id="__span-36-36"><span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
</span><span id="__span-36-37"><span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-36-38">
</span><span id="__span-36-39"><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-36-40">
</span><span id="__span-36-41">
</span><span id="__span-36-42"><span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
</span><span id="__span-36-43">    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
</span><span id="__span-36-44">
</span><span id="__span-36-45">
</span><span id="__span-36-46"><span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
</span><span id="__span-36-47">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-36-48">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Preventers&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sharp Tower&quot;</span><span class="p">)</span>
</span><span id="__span-36-49">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Z-Force&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sister Margaret&#39;s Bar&quot;</span><span class="p">)</span>
</span><span id="__span-36-50">
</span><span id="__span-36-51">        <span class="n">hero_deadpond</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-36-52">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span>
</span><span id="__span-36-53">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Dive Wilson&quot;</span><span class="p">,</span>
</span><span id="__span-36-54">        <span class="p">)</span>
</span><span id="__span-36-55">        <span class="n">hero_rusty_man</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-36-56">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span>
</span><span id="__span-36-57">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span>
</span><span id="__span-36-58">            <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span>
</span><span id="__span-36-59">        <span class="p">)</span>
</span><span id="__span-36-60">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-36-61">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span>
</span><span id="__span-36-62">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">,</span>
</span><span id="__span-36-63">        <span class="p">)</span>
</span><span id="__span-36-64">        <span class="n">deadpond_team_z_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span><span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-36-65">        <span class="n">deadpond_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-36-66">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_deadpond</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-36-67">        <span class="p">)</span>
</span><span id="__span-36-68">        <span class="n">spider_boy_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-36-69">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_spider_boy</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-36-70">        <span class="p">)</span>
</span><span id="__span-36-71">        <span class="n">rusty_man_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-36-72">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_rusty_man</span>
</span><span id="__span-36-73">        <span class="p">)</span>
</span><span id="__span-36-74">
</span><span id="__span-36-75">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">deadpond_team_z_link</span><span class="p">)</span>
</span><span id="__span-36-76">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">deadpond_preventers_link</span><span class="p">)</span>
</span><span id="__span-36-77">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">spider_boy_preventers_link</span><span class="p">)</span>
</span><span id="__span-36-78">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rusty_man_preventers_link</span><span class="p">)</span>
</span><span id="__span-36-79">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-36-80">
</span><span id="__span-36-81">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="p">:</span>
</span><span id="__span-36-82">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Z-Force hero:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">hero</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-36-83">
</span><span id="__span-36-84">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">team_preventers</span><span class="o">.</span><span class="n">hero_links</span><span class="p">:</span>
</span><span id="__span-36-85">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers hero:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">hero</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-36-86">
</span><span id="__span-36-87">
</span><span id="__span-36-88"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-36-89">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-36-90">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-36-91">            <span class="n">select</span><span class="p">(</span><span class="n">Hero</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hero</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Spider-Boy&quot;</span><span class="p">)</span>
</span><span id="__span-36-92">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-36-93">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Z-Force&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-36-94">
</span><span id="__span-36-95">        <span class="n">spider_boy_z_force_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-36-96">            <span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_spider_boy</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-36-97">        <span class="p">)</span>
</span><span id="__span-36-98">        <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spider_boy_z_force_link</span><span class="p">)</span>
</span><span id="__span-36-99">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_z_force</span><span class="p">)</span>
</span><span id="__span-36-100">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-36-101">
</span><span id="__span-36-102">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Updated Spider-Boy&#39;s Teams:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">)</span>
</span><span id="__span-36-103">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Z-Force heroes:&quot;</span><span class="p">,</span> <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="p">)</span>
</span><span id="__span-36-104">
</span><span id="__span-36-105">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">:</span>
</span><span id="__span-36-106">            <span class="k">if</span> <span class="n">link</span><span class="o">.</span><span class="n">team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">:</span>
</span><span id="__span-36-107">                <span class="n">link</span><span class="o">.</span><span class="n">is_training</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-36-108">
</span><span id="__span-36-109">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-36-110">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-36-111">
</span><span id="__span-36-112">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">:</span>
</span><span id="__span-36-113">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy team:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">team</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-36-114">
</span><span id="__span-36-115">
</span><span id="__span-36-116"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span id="__span-36-117">    <span class="n">create_db_and_tables</span><span class="p">()</span>
</span><span id="__span-36-118">    <span class="n">create_heroes</span><span class="p">()</span>
</span><span id="__span-36-119">    <span class="n">update_heroes</span><span class="p">()</span>
</span><span id="__span-36-120">
</span><span id="__span-36-121">
</span><span id="__span-36-122"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-36-123">    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-37-1"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span>
</span><span id="__span-37-2">
</span><span id="__span-37-3"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">select</span>
</span><span id="__span-37-4">
</span><span id="__span-37-5">
</span><span id="__span-37-6"><span class="k">class</span> <span class="nc">HeroTeamLink</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-37-7">    <span class="n">team_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
</span><span id="__span-37-8">        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-37-9">    <span class="p">)</span>
</span><span id="__span-37-10">    <span class="n">hero_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
</span><span id="__span-37-11">        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;hero.id&quot;</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-37-12">    <span class="p">)</span>
</span><span id="__span-37-13">    <span class="n">is_training</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-37-14">
</span><span id="__span-37-15">    <span class="n">team</span><span class="p">:</span> <span class="s2">&quot;Team&quot;</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;hero_links&quot;</span><span class="p">)</span>
</span><span id="__span-37-16">    <span class="n">hero</span><span class="p">:</span> <span class="s2">&quot;Hero&quot;</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team_links&quot;</span><span class="p">)</span>
</span><span id="__span-37-17">
</span><span id="__span-37-18">
</span><span id="__span-37-19"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-37-20">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-37-21">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-37-22">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-37-23">
</span><span id="__span-37-24">    <span class="n">hero_links</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">HeroTeamLink</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team&quot;</span><span class="p">)</span>
</span><span id="__span-37-25">
</span><span id="__span-37-26">
</span><span id="__span-37-27"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-37-28">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-37-29">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-37-30">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-37-31">    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-37-32">
</span><span id="__span-37-33">    <span class="n">team_links</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">HeroTeamLink</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;hero&quot;</span><span class="p">)</span>
</span><span id="__span-37-34">
</span><span id="__span-37-35">
</span><span id="__span-37-36"><span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
</span><span id="__span-37-37"><span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-37-38">
</span><span id="__span-37-39"><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-37-40">
</span><span id="__span-37-41">
</span><span id="__span-37-42"><span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
</span><span id="__span-37-43">    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
</span><span id="__span-37-44">
</span><span id="__span-37-45">
</span><span id="__span-37-46"><span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
</span><span id="__span-37-47">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-37-48">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Preventers&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sharp Tower&quot;</span><span class="p">)</span>
</span><span id="__span-37-49">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Z-Force&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sister Margaret&#39;s Bar&quot;</span><span class="p">)</span>
</span><span id="__span-37-50">
</span><span id="__span-37-51">        <span class="n">hero_deadpond</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-37-52">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span>
</span><span id="__span-37-53">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Dive Wilson&quot;</span><span class="p">,</span>
</span><span id="__span-37-54">        <span class="p">)</span>
</span><span id="__span-37-55">        <span class="n">hero_rusty_man</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-37-56">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span>
</span><span id="__span-37-57">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span>
</span><span id="__span-37-58">            <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span>
</span><span id="__span-37-59">        <span class="p">)</span>
</span><span id="__span-37-60">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-37-61">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span>
</span><span id="__span-37-62">            <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">,</span>
</span><span id="__span-37-63">        <span class="p">)</span>
</span><span id="__span-37-64">        <span class="n">deadpond_team_z_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span><span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-37-65">        <span class="n">deadpond_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-37-66">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_deadpond</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-37-67">        <span class="p">)</span>
</span><span id="__span-37-68">        <span class="n">spider_boy_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-37-69">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_spider_boy</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-37-70">        <span class="p">)</span>
</span><span id="__span-37-71">        <span class="n">rusty_man_preventers_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-37-72">            <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_rusty_man</span>
</span><span id="__span-37-73">        <span class="p">)</span>
</span><span id="__span-37-74">
</span><span id="__span-37-75">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">deadpond_team_z_link</span><span class="p">)</span>
</span><span id="__span-37-76">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">deadpond_preventers_link</span><span class="p">)</span>
</span><span id="__span-37-77">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">spider_boy_preventers_link</span><span class="p">)</span>
</span><span id="__span-37-78">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rusty_man_preventers_link</span><span class="p">)</span>
</span><span id="__span-37-79">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-37-80">
</span><span id="__span-37-81">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="p">:</span>
</span><span id="__span-37-82">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Z-Force hero:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">hero</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-37-83">
</span><span id="__span-37-84">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">team_preventers</span><span class="o">.</span><span class="n">hero_links</span><span class="p">:</span>
</span><span id="__span-37-85">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers hero:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">hero</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-37-86">
</span><span id="__span-37-87">
</span><span id="__span-37-88"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-37-89">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-37-90">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-37-91">            <span class="n">select</span><span class="p">(</span><span class="n">Hero</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hero</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Spider-Boy&quot;</span><span class="p">)</span>
</span><span id="__span-37-92">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-37-93">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Z-Force&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-37-94">
</span><span id="__span-37-95">        <span class="n">spider_boy_z_force_link</span> <span class="o">=</span> <span class="n">HeroTeamLink</span><span class="p">(</span>
</span><span id="__span-37-96">            <span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span><span class="p">,</span> <span class="n">hero</span><span class="o">=</span><span class="n">hero_spider_boy</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-37-97">        <span class="p">)</span>
</span><span id="__span-37-98">        <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spider_boy_z_force_link</span><span class="p">)</span>
</span><span id="__span-37-99">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_z_force</span><span class="p">)</span>
</span><span id="__span-37-100">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-37-101">
</span><span id="__span-37-102">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Updated Spider-Boy&#39;s Teams:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">)</span>
</span><span id="__span-37-103">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Z-Force heroes:&quot;</span><span class="p">,</span> <span class="n">team_z_force</span><span class="o">.</span><span class="n">hero_links</span><span class="p">)</span>
</span><span id="__span-37-104">
</span><span id="__span-37-105">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">:</span>
</span><span id="__span-37-106">            <span class="k">if</span> <span class="n">link</span><span class="o">.</span><span class="n">team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">:</span>
</span><span id="__span-37-107">                <span class="n">link</span><span class="o">.</span><span class="n">is_training</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-37-108">
</span><span id="__span-37-109">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-37-110">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-37-111">
</span><span id="__span-37-112">        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team_links</span><span class="p">:</span>
</span><span id="__span-37-113">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy team:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">team</span><span class="p">,</span> <span class="s2">&quot;is training:&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">is_training</span><span class="p">)</span>
</span><span id="__span-37-114">
</span><span id="__span-37-115">
</span><span id="__span-37-116"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span id="__span-37-117">    <span class="n">create_db_and_tables</span><span class="p">()</span>
</span><span id="__span-37-118">    <span class="n">create_heroes</span><span class="p">()</span>
</span><span id="__span-37-119">    <span class="n">update_heroes</span><span class="p">()</span>
</span><span id="__span-37-120">
</span><span id="__span-37-121">
</span><span id="__span-37-122"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-37-123">    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div>
</div>
</div>
</div>
</details>
<h2 id="run-the-program-with-the-updated-relationships">Run the Program with the Updated Relationships<a class="headerlink" href="#run-the-program-with-the-updated-relationships" title="Permanent link">&para;</a></h2>
<p>And if we run the program now, it will output:</p>
<div class="termy">

<div class="highlight"><pre><span></span><code><span id="__span-38-1"><span class="gp">$ </span>python<span class="w"> </span>app.py
</span><span id="__span-38-2">
</span><span id="__span-38-3"><span class="go">// Previous output omitted 🙈</span>
</span><span id="__span-38-4">
</span><span id="__span-38-5"><span class="go">// Automatically fetch team data on attribute access</span>
</span><span id="__span-38-6"><span class="go">INFO Engine SELECT team.id AS team_id, team.name AS team_name, team.headquarters AS team_headquarters</span>
</span><span id="__span-38-7"><span class="go">FROM team</span>
</span><span id="__span-38-8"><span class="go">WHERE team.id = ?</span>
</span><span id="__span-38-9"><span class="go">INFO Engine [generated in 0.00015s] (2,)</span>
</span><span id="__span-38-10">
</span><span id="__span-38-11"><span class="go">// Update link row</span>
</span><span id="__span-38-12"><span class="go">INFO Engine UPDATE heroteamlink SET is_training=? WHERE heroteamlink.team_id = ? AND heroteamlink.hero_id = ?</span>
</span><span id="__span-38-13"><span class="go">INFO Engine [generated in 0.00020s] (0, 2, 2)</span>
</span><span id="__span-38-14">
</span><span id="__span-38-15"><span class="go">// Save current transaction to database</span>
</span><span id="__span-38-16"><span class="go">INFO Engine COMMIT</span>
</span><span id="__span-38-17">
</span><span id="__span-38-18"><span class="go">// Automatically start a new transaction</span>
</span><span id="__span-38-19"><span class="go">INFO Engine BEGIN (implicit)</span>
</span><span id="__span-38-20">
</span><span id="__span-38-21"><span class="go">// Automatically fetch data on attribute access</span>
</span><span id="__span-38-22"><span class="go">INFO Engine SELECT hero.id AS hero_id, hero.name AS hero_name, hero.secret_name AS hero_secret_name, hero.age AS hero_age</span>
</span><span id="__span-38-23"><span class="go">FROM hero</span>
</span><span id="__span-38-24"><span class="go">WHERE hero.id = ?</span>
</span><span id="__span-38-25"><span class="go">INFO Engine [cached since 0.2004s ago] (2,)</span>
</span><span id="__span-38-26"><span class="go">INFO Engine SELECT heroteamlink.team_id AS heroteamlink_team_id, heroteamlink.hero_id AS heroteamlink_hero_id, heroteamlink.is_training AS heroteamlink_is_training</span>
</span><span id="__span-38-27"><span class="go">FROM heroteamlink</span>
</span><span id="__span-38-28"><span class="go">WHERE ? = heroteamlink.hero_id</span>
</span><span id="__span-38-29"><span class="go">INFO Engine [cached since 0.1005s ago] (2,)</span>
</span><span id="__span-38-30"><span class="go">INFO Engine SELECT team.id AS team_id, team.name AS team_name, team.headquarters AS team_headquarters</span>
</span><span id="__span-38-31"><span class="go">FROM team</span>
</span><span id="__span-38-32"><span class="go">WHERE team.id = ?</span>
</span><span id="__span-38-33"><span class="go">INFO Engine [cached since 0.09707s ago] (2,)</span>
</span><span id="__span-38-34">
</span><span id="__span-38-35"><span class="go">// Print Spider-Boy team, including link data, if is training</span>
</span><span id="__span-38-36"><span class="go">Spider-Boy team: headquarters=&#39;Sharp Tower&#39; id=2 name=&#39;Preventers&#39; is training: False</span>
</span><span id="__span-38-37">
</span><span id="__span-38-38"><span class="go">// Automatically fetch data on attribute access</span>
</span><span id="__span-38-39"><span class="go">INFO Engine SELECT team.id AS team_id, team.name AS team_name, team.headquarters AS team_headquarters</span>
</span><span id="__span-38-40"><span class="go">FROM team</span>
</span><span id="__span-38-41"><span class="go">WHERE team.id = ?</span>
</span><span id="__span-38-42"><span class="go">INFO Engine [cached since 0.2097s ago] (1,)</span>
</span><span id="__span-38-43">
</span><span id="__span-38-44"><span class="go">// Print Spider-Boy team, including link data, if is training</span>
</span><span id="__span-38-45"><span class="go">Spider-Boy team: headquarters=&#39;Sister Margaret&#39;s Bar&#39; id=1 name=&#39;Z-Force&#39; is training: True</span>
</span><span id="__span-38-46"><span class="go">INFO Engine ROLLBACK</span>
</span></code></pre></div>

</div>

<h2 id="recap">Recap<a class="headerlink" href="#recap" title="Permanent link">&para;</a></h2>
<p>If you need to store more information about a <strong>many-to-many</strong> relationship you can use an explicit link model with extra data in it. 🤓</p>







  
  



  



  <form class="md-feedback" name="feedback" hidden>
    <fieldset>
      <legend class="md-feedback__title">
        Was this page helpful?
      </legend>
      <div class="md-feedback__inner">
        <div class="md-feedback__list">
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page was helpful" data-md-value="1">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m7 0c0 .8-.7 1.5-1.5 1.5S14 10.3 14 9.5 14.7 8 15.5 8s1.5.7 1.5 1.5m-5 7.73c-1.75 0-3.29-.73-4.19-1.81L9.23 14c.45.72 1.52 1.23 2.77 1.23s2.32-.51 2.77-1.23l1.42 1.42c-.9 1.08-2.44 1.81-4.19 1.81"/></svg>
            </button>
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page could be improved" data-md-value="0">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10m-6.5-4c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5-1.5-.7-1.5-1.5.7-1.5 1.5-1.5M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m2 4.5c1.75 0 3.29.72 4.19 1.81l-1.42 1.42C14.32 16.5 13.25 16 12 16s-2.32.5-2.77 1.23l-1.42-1.42C8.71 14.72 10.25 14 12 14"/></svg>
            </button>
          
        </div>
        <div class="md-feedback__note">
          
            <div data-md-value="1" hidden>
              
              
                
              
              Thanks for your feedback!
            </div>
          
            <div data-md-value="0" hidden>
              
              
                
              
              Thanks for your feedback!
            </div>
          
        </div>
      </div>
    </fieldset>
  </form>


                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../update-remove-relationships/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Update and Remove Many-to-Many Relationships">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Update and Remove Many-to-Many Relationships
              </div>
            </div>
          </a>
        
        
          
          <a href="../../code-structure/" class="md-footer__link md-footer__link--next" aria-label="Next: Code Structure and Multiple Files">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Code Structure and Multiple Files
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/readyapi/sqldev" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/khulnasoft" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/in/khulnasoft" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://dev.to/khulnasoft" target="_blank" rel="noopener" title="dev.to" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M120.12 208.29c-3.88-2.9-7.77-4.35-11.65-4.35H91.03v104.47h17.45c3.88 0 7.77-1.45 11.65-4.35s5.82-7.25 5.82-13.06v-69.65c-.01-5.8-1.96-10.16-5.83-13.06M404.1 32H43.9C19.7 32 .06 51.59 0 75.8v360.4C.06 460.41 19.7 480 43.9 480h360.2c24.21 0 43.84-19.59 43.9-43.8V75.8c-.06-24.21-19.7-43.8-43.9-43.8M154.2 291.19c0 18.81-11.61 47.31-48.36 47.25h-46.4V172.98h47.38c35.44 0 47.36 28.46 47.37 47.28zm100.68-88.66H201.6v38.42h32.57v29.57H201.6v38.41h53.29v29.57h-62.18c-11.16.29-20.44-8.53-20.72-19.69V193.7c-.27-11.15 8.56-20.41 19.71-20.69h63.19zm103.64 115.29c-13.2 30.75-36.85 24.63-47.44 0l-38.53-144.8h32.57l29.71 113.72 29.57-113.72h32.58z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://medium.com/@khulnasoft" target="_blank" rel="noopener" title="medium.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M180.5 74.262C80.813 74.262 0 155.633 0 256s80.819 181.738 180.5 181.738S361 356.373 361 256 280.191 74.262 180.5 74.262m288.25 10.646c-49.845 0-90.245 76.619-90.245 171.095s40.406 171.1 90.251 171.1 90.251-76.619 90.251-171.1H559c0-94.503-40.4-171.095-90.248-171.095Zm139.506 17.821c-17.526 0-31.735 68.628-31.735 153.274s14.2 153.274 31.735 153.274S640 340.631 640 256c0-84.649-14.215-153.271-31.742-153.271Z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://khulnasoft.com" target="_blank" rel="noopener" title="khulnasoft.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M352 256c0 22.2-1.2 43.6-3.3 64H163.4c-2.2-20.4-3.3-41.8-3.3-64s1.2-43.6 3.3-64h185.3c2.2 20.4 3.3 41.8 3.3 64m28.8-64h123.1c5.3 20.5 8.1 41.9 8.1 64s-2.8 43.5-8.1 64H380.8c2.1-20.6 3.2-42 3.2-64s-1.1-43.4-3.2-64m112.6-32H376.7c-10-63.9-29.8-117.4-55.3-151.6 78.3 20.7 142 77.5 171.9 151.6zm-149.1 0H167.7c6.1-36.4 15.5-68.6 27-94.7 10.5-23.6 22.2-40.7 33.5-51.5C239.4 3.2 248.7 0 256 0s16.6 3.2 27.8 13.8c11.3 10.8 23 27.9 33.5 51.5 11.6 26 20.9 58.2 27 94.7m-209 0H18.6c30-74.1 93.6-130.9 172-151.6-25.5 34.2-45.3 87.7-55.3 151.6M8.1 192h123.1c-2.1 20.6-3.2 42-3.2 64s1.1 43.4 3.2 64H8.1C2.8 299.5 0 278.1 0 256s2.8-43.5 8.1-64m186.6 254.6c-11.6-26-20.9-58.2-27-94.6h176.6c-6.1 36.4-15.5 68.6-27 94.6-10.5 23.6-22.2 40.7-33.5 51.5-11.2 10.7-20.5 13.9-27.8 13.9s-16.6-3.2-27.8-13.8c-11.3-10.8-23-27.9-33.5-51.5zM135.3 352c10 63.9 29.8 117.4 55.3 151.6-78.4-20.7-142-77.5-172-151.6zm358.1 0c-30 74.1-93.6 130.9-171.9 151.6 25.5-34.2 45.2-87.7 55.3-151.6h116.7z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.annotate", "content.code.copy", "content.footnote.tooltips", "content.tabs.link", "content.tooltips", "navigation.footer", "navigation.indexes", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.path", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
        <script src="../../../js/termynal.js"></script>
      
        <script src="../../../js/custom.js"></script>
      
    
  </body>
</html>