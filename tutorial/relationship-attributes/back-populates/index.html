
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="SQLDev, SQL databases in Python, designed for simplicity, compatibility, and robustness.">
      
      
      
        <link rel="canonical" href="https://sqldev.khulnasoft.com/tutorial/relationship-attributes/back-populates/">
      
      
        <link rel="prev" href="../remove-relationships/">
      
      
        <link rel="next" href="../cascade-delete-relationships/">
      
      
      <link rel="icon" href="../../../img/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.46">
    
    
      
        <title>Relationship back_populates - SQLDev</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.6f8fc17f.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../css/termynal.css">
    
      <link rel="stylesheet" href="../../../css/custom.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-J8HVTT936W"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-J8HVTT936W",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-J8HVTT936W",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="Relationship back_populates - SQLDev" >
      
        <meta  property="og:description"  content="SQLDev, SQL databases in Python, designed for simplicity, compatibility, and robustness." >
      
        <meta  property="og:image"  content="https://sqldev.khulnasoft.com/assets/images/social/tutorial/relationship-attributes/back-populates.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="https://sqldev.khulnasoft.com/tutorial/relationship-attributes/back-populates/" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="Relationship back_populates - SQLDev" >
      
        <meta  name="twitter:description"  content="SQLDev, SQL databases in Python, designed for simplicity, compatibility, and robustness." >
      
        <meta  name="twitter:image"  content="https://sqldev.khulnasoft.com/assets/images/social/tutorial/relationship-attributes/back-populates.png" >
      
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#relationship-back_populates" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="SQLDev" class="md-header__button md-logo" aria-label="SQLDev" data-md-component="logo">
      
  <img src="../../../img/icon-white.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            SQLDev
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Relationship back_populates
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9 2C5.13 2 2 5.13 2 9c0 2.38 1.19 4.47 3 5.74V17c0 .55.45 1 1 1h6c.55 0 1-.45 1-1v-2.26c1.81-1.27 3-3.36 3-5.74 0-3.87-3.13-7-7-7M6 21c0 .55.45 1 1 1h4c.55 0 1-.45 1-1v-1H6zm13-8h-2l-3.2 9h1.9l.7-2h3.2l.7 2h1.9zm-2.15 5.65L18 15l1.15 3.65z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="amber"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="deep-purple" data-md-color-accent="amber"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/readyapi/sqldev" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
  </div>
  <div class="md-source__repository">
    readyapi/sqldev
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  SQLDev

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../features/" class="md-tabs__link">
        
  
    
  
  Features

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../../learn/" class="md-tabs__link">
          
  
    
  
  Learn

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../resources/" class="md-tabs__link">
          
  
    
  
  Resources

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../about/" class="md-tabs__link">
          
  
    
  
  About

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../release-notes/" class="md-tabs__link">
        
  
    
  
  Release Notes

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="SQLDev" class="md-nav__button md-logo" aria-label="SQLDev" data-md-component="logo">
      
  <img src="../../../img/icon-white.svg" alt="logo">

    </a>
    SQLDev
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/readyapi/sqldev" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
  </div>
  <div class="md-source__repository">
    readyapi/sqldev
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SQLDev
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../features/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Features
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../learn/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Learn
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Learn
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../databases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intro to Databases
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../db-to-code/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Database to Code (ORMs)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../environment-variables/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Environment Variables
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../virtual-environments/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Virtual Environments
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../install/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Install **SQLDev**
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_7" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Tutorial - User Guide
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_7" id="__nav_3_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_7">
            <span class="md-nav__icon md-icon"></span>
            Tutorial - User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../create-db-and-table-with-db-browser/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Create a Table with SQL
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../create-db-and-table/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Create a Table with SQLDev - Use the Engine
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../insert/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Create Rows - Use the Session - INSERT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../automatic-id-none-refresh/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Automatic IDs, None Defaults, and Refreshing Data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../select/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Read Data - SELECT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../where/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Filter Data - WHERE
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../indexes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Indexes - Optimize Queries
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../one/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Read One Row
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../limit-and-offset/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Read a Range of Data - LIMIT and OFFSET
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../update/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Update Data - UPDATE
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../delete/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Delete Data - DELETE
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_7_13" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../connect/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Connect Tables - JOIN - Intro
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_7_13" id="__nav_3_7_13_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_7_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_7_13">
            <span class="md-nav__icon md-icon"></span>
            Connect Tables - JOIN - Intro
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../connect/create-connected-tables/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Create Connected Tables
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../connect/create-connected-rows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Create and Connect Rows
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../connect/read-connected-data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Read Connected Data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../connect/update-data-connections/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Update Data Connections
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../connect/remove-data-connections/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Remove Data Connections
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_7_14" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Relationship Attributes - Intro
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_7_14" id="__nav_3_7_14_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_7_14_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_7_14">
            <span class="md-nav__icon md-icon"></span>
            Relationship Attributes - Intro
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../define-relationships-attributes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Define Relationships Attributes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../create-and-update-relationships/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Create and Update Relationships
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../read-relationships/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Read Relationships
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../remove-relationships/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Remove Relationships
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Relationship back_populates
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Relationship back_populates
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#relationship-with-back_populates" class="md-nav__link">
    <span class="md-ellipsis">
      Relationship with back_populates
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#an-incomplete-relationship" class="md-nav__link">
    <span class="md-ellipsis">
      An Incomplete Relationship
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#read-data-objects" class="md-nav__link">
    <span class="md-ellipsis">
      Read Data Objects
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#print-the-data" class="md-nav__link">
    <span class="md-ellipsis">
      Print the Data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#update-objects-before-committing" class="md-nav__link">
    <span class="md-ellipsis">
      Update Objects Before Committing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#commit-and-print" class="md-nav__link">
    <span class="md-ellipsis">
      Commit and Print
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fix-it-using-back_populates" class="md-nav__link">
    <span class="md-ellipsis">
      Fix It Using back_populates
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#review-the-result" class="md-nav__link">
    <span class="md-ellipsis">
      Review the Result
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-value-of-back_populates" class="md-nav__link">
    <span class="md-ellipsis">
      The Value of back_populates
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#a-mental-trick-to-remember-back_populates" class="md-nav__link">
    <span class="md-ellipsis">
      A Mental Trick to Remember back_populates
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cascade-delete-relationships/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cascade Delete Relationships
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../type-annotation-strings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Type annotation strings
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_7_15" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../many-to-many/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Many to Many - Intro
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_7_15" id="__nav_3_7_15_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_7_15_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_7_15">
            <span class="md-nav__icon md-icon"></span>
            Many to Many - Intro
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../many-to-many/create-models-with-link/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Create Models with a Many-to-Many Link
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../many-to-many/create-data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Create Data with Many-to-Many Relationships
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../many-to-many/update-remove-relationships/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Update and Remove Many-to-Many Relationships
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../many-to-many/link-with-extra-fields/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Link Model with Extra Fields
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../code-structure/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Code Structure and Multiple Files
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_7_17" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../readyapi/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    ReadyAPI and Pydantic - Intro
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_7_17" id="__nav_3_7_17_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_7_17_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_7_17">
            <span class="md-nav__icon md-icon"></span>
            ReadyAPI and Pydantic - Intro
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../readyapi/simple-hero-api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Simple Hero API with ReadyAPI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../readyapi/response-model/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ReadyAPI Response Model with SQLDev
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../readyapi/multiple-models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multiple Models with ReadyAPI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../readyapi/read-one/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Read One Model with ReadyAPI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../readyapi/limit-and-offset/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Read Heroes with Limit and Offset with ReadyAPI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../readyapi/update/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Update Data with ReadyAPI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../readyapi/update-extra-data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Update with Extra Data (Hashed Passwords) with ReadyAPI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../readyapi/delete/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Delete Data with ReadyAPI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../readyapi/session-with-dependency/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Session with ReadyAPI Dependency
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../readyapi/teams/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ReadyAPI Path Operations for Teams - Other Models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../readyapi/relationships/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Models with Relationships in ReadyAPI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../readyapi/tests/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test Applications with ReadyAPI and SQLDev
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_8" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../advanced/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Advanced User Guide
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_8" id="__nav_3_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_8">
            <span class="md-nav__icon md-icon"></span>
            Advanced User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../advanced/decimal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Decimal Numbers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../advanced/uuid/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UUID (Universally Unique Identifiers)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../resources/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Resources
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Resources
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../help/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Help SQLDev - Get Help
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../management-tasks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Repository Management Tasks
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../about/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    About
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            About
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../alternatives/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Alternatives, Inspiration and Comparisons
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../management/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Repository Management
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../release-notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Release Notes
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#relationship-with-back_populates" class="md-nav__link">
    <span class="md-ellipsis">
      Relationship with back_populates
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#an-incomplete-relationship" class="md-nav__link">
    <span class="md-ellipsis">
      An Incomplete Relationship
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#read-data-objects" class="md-nav__link">
    <span class="md-ellipsis">
      Read Data Objects
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#print-the-data" class="md-nav__link">
    <span class="md-ellipsis">
      Print the Data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#update-objects-before-committing" class="md-nav__link">
    <span class="md-ellipsis">
      Update Objects Before Committing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#commit-and-print" class="md-nav__link">
    <span class="md-ellipsis">
      Commit and Print
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fix-it-using-back_populates" class="md-nav__link">
    <span class="md-ellipsis">
      Fix It Using back_populates
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#review-the-result" class="md-nav__link">
    <span class="md-ellipsis">
      Review the Result
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-value-of-back_populates" class="md-nav__link">
    <span class="md-ellipsis">
      The Value of back_populates
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#a-mental-trick-to-remember-back_populates" class="md-nav__link">
    <span class="md-ellipsis">
      A Mental Trick to Remember back_populates
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="relationship-back_populates">Relationship back_populates<a class="headerlink" href="#relationship-back_populates" title="Permanent link">&para;</a></h1>
<p>Now you know how to use the <strong>relationship attributes</strong> to manipulate connected data in the database! 🎉</p>
<p>Let's now take a small step back and review how we defined those <code>Relationship()</code> attributes again, let's clarify that <code>back_populates</code> argument. 🤓</p>
<h2 id="relationship-with-back_populates">Relationship with <code>back_populates</code><a class="headerlink" href="#relationship-with-back_populates" title="Permanent link">&para;</a></h2>
<p>So, what is that <code>back_populates</code> argument in each <code>Relationship()</code>?</p>
<p>The value is a string with the name of the attribute in the <strong>other</strong> model class.</p>
<p><img src="/img/tutorial/relationships/attributes/back-populates.svg"></p>
<p>That tells <strong>SQLDev</strong> that if something changes in this model, it should change that attribute in the other model, and it will work even before committing with the session (that would force a refresh of the data).</p>
<p>Let's understand that better with an example.</p>
<h2 id="an-incomplete-relationship">An Incomplete Relationship<a class="headerlink" href="#an-incomplete-relationship" title="Permanent link">&para;</a></h2>
<p>Let's see how that works by writing an <strong>incomplete</strong> version first, without <code>back_populates</code>:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:3"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><input id="__tabbed_1_3" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">Python 3.10+</label><label for="__tabbed_1_2">Python 3.9+</label><label for="__tabbed_1_3">Python 3.7+</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-0-1"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">select</span>
</span><span id="__span-0-2">
</span><span id="__span-0-3">
</span><span id="__span-0-4"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-0-5">    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-6">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-7">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-0-8">
</span><span id="__span-0-9"><span class="hll">    <span class="n">heroes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;Hero&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">()</span>
</span></span><span id="__span-0-10">
</span><span id="__span-0-11">
</span><span id="__span-0-12"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-0-13">    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-14">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-15">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-0-16">    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-17">
</span><span id="__span-0-18">    <span class="n">team_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">)</span>
</span><span id="__span-0-19"><span class="hll">    <span class="n">team</span><span class="p">:</span> <span class="n">Team</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">()</span>
</span></span><span id="__span-0-20">
</span><span id="__span-0-21"><span class="c1"># Code below omitted 👇</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-1-1"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>
</span><span id="__span-1-2">
</span><span id="__span-1-3"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">select</span>
</span><span id="__span-1-4">
</span><span id="__span-1-5">
</span><span id="__span-1-6"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-1-7">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-1-8">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-1-9">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-1-10">
</span><span id="__span-1-11"><span class="hll">    <span class="n">heroes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;Hero&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">()</span>
</span></span><span id="__span-1-12">
</span><span id="__span-1-13">
</span><span id="__span-1-14"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-1-15">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-1-16">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-1-17">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-1-18">    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-1-19">
</span><span id="__span-1-20">    <span class="n">team_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">)</span>
</span><span id="__span-1-21"><span class="hll">    <span class="n">team</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Team</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">()</span>
</span></span><span id="__span-1-22">
</span><span id="__span-1-23"><span class="c1"># Code below omitted 👇</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-2-1"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span>
</span><span id="__span-2-2">
</span><span id="__span-2-3"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">select</span>
</span><span id="__span-2-4">
</span><span id="__span-2-5">
</span><span id="__span-2-6"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-2-7">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-2-8">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-2-9">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-2-10">
</span><span id="__span-2-11"><span class="hll">    <span class="n">heroes</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="s2">&quot;Hero&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">()</span>
</span></span><span id="__span-2-12">
</span><span id="__span-2-13">
</span><span id="__span-2-14"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-2-15">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-2-16">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-2-17">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-2-18">    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-2-19">
</span><span id="__span-2-20">    <span class="n">team_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">)</span>
</span><span id="__span-2-21"><span class="hll">    <span class="n">team</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Team</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">()</span>
</span></span><span id="__span-2-22">
</span><span id="__span-2-23"><span class="c1"># Code below omitted 👇</span>
</span></code></pre></div>
</div>
</div>
</div>
<details>
<summary>👀 Full file preview</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="2:3"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><input id="__tabbed_2_3" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">Python 3.10+</label><label for="__tabbed_2_2">Python 3.9+</label><label for="__tabbed_2_3">Python 3.7+</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-3-1"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">select</span>
</span><span id="__span-3-2">
</span><span id="__span-3-3">
</span><span id="__span-3-4"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-3-5">    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-3-6">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-3-7">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-3-8">
</span><span id="__span-3-9">    <span class="n">heroes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;Hero&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">()</span>
</span><span id="__span-3-10">
</span><span id="__span-3-11">
</span><span id="__span-3-12"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-3-13">    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-3-14">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-3-15">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-3-16">    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-3-17">
</span><span id="__span-3-18">    <span class="n">team_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">)</span>
</span><span id="__span-3-19">    <span class="n">team</span><span class="p">:</span> <span class="n">Team</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">()</span>
</span><span id="__span-3-20">
</span><span id="__span-3-21">
</span><span id="__span-3-22"><span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
</span><span id="__span-3-23"><span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-3-24">
</span><span id="__span-3-25"><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-3-26">
</span><span id="__span-3-27">
</span><span id="__span-3-28"><span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
</span><span id="__span-3-29">    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
</span><span id="__span-3-30">
</span><span id="__span-3-31">
</span><span id="__span-3-32"><span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
</span><span id="__span-3-33">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-3-34">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Preventers&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sharp Tower&quot;</span><span class="p">)</span>
</span><span id="__span-3-35">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Z-Force&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sister Margaret&#39;s Bar&quot;</span><span class="p">)</span>
</span><span id="__span-3-36">
</span><span id="__span-3-37">        <span class="n">hero_deadpond</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-3-38">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Dive Wilson&quot;</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span>
</span><span id="__span-3-39">        <span class="p">)</span>
</span><span id="__span-3-40">        <span class="n">hero_rusty_man</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-3-41">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span>
</span><span id="__span-3-42">        <span class="p">)</span>
</span><span id="__span-3-43">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
</span><span id="__span-3-44">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-3-45">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-3-46">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-3-47">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-3-48">
</span><span id="__span-3-49">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-3-50">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-3-51">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-3-52">
</span><span id="__span-3-53">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-3-54">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-3-55">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-3-56">
</span><span id="__span-3-57">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="n">team_preventers</span>
</span><span id="__span-3-58">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-3-59">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-3-60">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-3-61">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Updated hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-3-62">
</span><span id="__span-3-63">        <span class="n">hero_black_lion</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Black Lion&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Trevor Challa&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">35</span><span class="p">)</span>
</span><span id="__span-3-64">        <span class="n">hero_sure_e</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Princess Sure-E&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Sure-E&quot;</span><span class="p">)</span>
</span><span id="__span-3-65">        <span class="n">team_wakaland</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span>
</span><span id="__span-3-66">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Wakaland&quot;</span><span class="p">,</span>
</span><span id="__span-3-67">            <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Wakaland Capital City&quot;</span><span class="p">,</span>
</span><span id="__span-3-68">            <span class="n">heroes</span><span class="o">=</span><span class="p">[</span><span class="n">hero_black_lion</span><span class="p">,</span> <span class="n">hero_sure_e</span><span class="p">],</span>
</span><span id="__span-3-69">        <span class="p">)</span>
</span><span id="__span-3-70">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-3-71">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-3-72">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-3-73">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Team Wakaland:&quot;</span><span class="p">,</span> <span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-3-74">
</span><span id="__span-3-75">        <span class="n">hero_tarantula</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Tarantula&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Natalia Roman-on&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
</span><span id="__span-3-76">        <span class="n">hero_dr_weird</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Dr. Weird&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Steve Weird&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">36</span><span class="p">)</span>
</span><span id="__span-3-77">        <span class="n">hero_cap</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-3-78">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Captain North America&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Esteban Rogelios&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">93</span>
</span><span id="__span-3-79">        <span class="p">)</span>
</span><span id="__span-3-80">
</span><span id="__span-3-81">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-3-82">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-3-83">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-3-84">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_preventers</span><span class="p">)</span>
</span><span id="__span-3-85">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-3-86">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-3-87">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-3-88">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-3-89">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-3-90">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-3-91">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-3-92">
</span><span id="__span-3-93">
</span><span id="__span-3-94"><span class="k">def</span> <span class="nf">select_heroes</span><span class="p">():</span>
</span><span id="__span-3-95">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-3-96">        <span class="n">statement</span> <span class="o">=</span> <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-3-97">        <span class="n">result</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="n">statement</span><span class="p">)</span>
</span><span id="__span-3-98">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-3-99">
</span><span id="__span-3-100">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers heroes:&quot;</span><span class="p">,</span> <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-3-101">
</span><span id="__span-3-102">
</span><span id="__span-3-103"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-3-104">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-3-105">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-3-106">            <span class="n">select</span><span class="p">(</span><span class="n">Hero</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hero</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Spider-Boy&quot;</span><span class="p">)</span>
</span><span id="__span-3-107">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-3-108">
</span><span id="__span-3-109">        <span class="n">preventers_team</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-3-110">            <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-3-111">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-3-112">
</span><span id="__span-3-113">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hero Spider-Boy:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-3-114">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="p">)</span>
</span><span id="__span-3-115">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-3-116">
</span><span id="__span-3-117">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-3-118">
</span><span id="__span-3-119">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy without team:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-3-120">
</span><span id="__span-3-121">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes again:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-3-122">
</span><span id="__span-3-123">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-3-124">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-3-125">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After committing&quot;</span><span class="p">)</span>
</span><span id="__span-3-126">
</span><span id="__span-3-127">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-3-128">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy after commit:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-3-129">
</span><span id="__span-3-130">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes after commit:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-3-131">
</span><span id="__span-3-132">
</span><span id="__span-3-133"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span id="__span-3-134">    <span class="n">create_db_and_tables</span><span class="p">()</span>
</span><span id="__span-3-135">    <span class="n">create_heroes</span><span class="p">()</span>
</span><span id="__span-3-136">    <span class="n">select_heroes</span><span class="p">()</span>
</span><span id="__span-3-137">    <span class="n">update_heroes</span><span class="p">()</span>
</span><span id="__span-3-138">
</span><span id="__span-3-139">
</span><span id="__span-3-140"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-3-141">    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-4-1"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>
</span><span id="__span-4-2">
</span><span id="__span-4-3"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">select</span>
</span><span id="__span-4-4">
</span><span id="__span-4-5">
</span><span id="__span-4-6"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-4-7">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-4-8">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-4-9">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-4-10">
</span><span id="__span-4-11">    <span class="n">heroes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;Hero&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">()</span>
</span><span id="__span-4-12">
</span><span id="__span-4-13">
</span><span id="__span-4-14"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-4-15">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-4-16">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-4-17">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-4-18">    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-4-19">
</span><span id="__span-4-20">    <span class="n">team_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">)</span>
</span><span id="__span-4-21">    <span class="n">team</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Team</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">()</span>
</span><span id="__span-4-22">
</span><span id="__span-4-23">
</span><span id="__span-4-24"><span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
</span><span id="__span-4-25"><span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-4-26">
</span><span id="__span-4-27"><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-4-28">
</span><span id="__span-4-29">
</span><span id="__span-4-30"><span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
</span><span id="__span-4-31">    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
</span><span id="__span-4-32">
</span><span id="__span-4-33">
</span><span id="__span-4-34"><span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
</span><span id="__span-4-35">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-4-36">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Preventers&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sharp Tower&quot;</span><span class="p">)</span>
</span><span id="__span-4-37">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Z-Force&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sister Margaret&#39;s Bar&quot;</span><span class="p">)</span>
</span><span id="__span-4-38">
</span><span id="__span-4-39">        <span class="n">hero_deadpond</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-4-40">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Dive Wilson&quot;</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span>
</span><span id="__span-4-41">        <span class="p">)</span>
</span><span id="__span-4-42">        <span class="n">hero_rusty_man</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-4-43">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span>
</span><span id="__span-4-44">        <span class="p">)</span>
</span><span id="__span-4-45">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
</span><span id="__span-4-46">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-4-47">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-4-48">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-4-49">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-4-50">
</span><span id="__span-4-51">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-4-52">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-4-53">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-4-54">
</span><span id="__span-4-55">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-4-56">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-4-57">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-4-58">
</span><span id="__span-4-59">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="n">team_preventers</span>
</span><span id="__span-4-60">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-4-61">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-4-62">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-4-63">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Updated hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-4-64">
</span><span id="__span-4-65">        <span class="n">hero_black_lion</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Black Lion&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Trevor Challa&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">35</span><span class="p">)</span>
</span><span id="__span-4-66">        <span class="n">hero_sure_e</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Princess Sure-E&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Sure-E&quot;</span><span class="p">)</span>
</span><span id="__span-4-67">        <span class="n">team_wakaland</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span>
</span><span id="__span-4-68">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Wakaland&quot;</span><span class="p">,</span>
</span><span id="__span-4-69">            <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Wakaland Capital City&quot;</span><span class="p">,</span>
</span><span id="__span-4-70">            <span class="n">heroes</span><span class="o">=</span><span class="p">[</span><span class="n">hero_black_lion</span><span class="p">,</span> <span class="n">hero_sure_e</span><span class="p">],</span>
</span><span id="__span-4-71">        <span class="p">)</span>
</span><span id="__span-4-72">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-4-73">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-4-74">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-4-75">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Team Wakaland:&quot;</span><span class="p">,</span> <span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-4-76">
</span><span id="__span-4-77">        <span class="n">hero_tarantula</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Tarantula&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Natalia Roman-on&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
</span><span id="__span-4-78">        <span class="n">hero_dr_weird</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Dr. Weird&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Steve Weird&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">36</span><span class="p">)</span>
</span><span id="__span-4-79">        <span class="n">hero_cap</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-4-80">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Captain North America&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Esteban Rogelios&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">93</span>
</span><span id="__span-4-81">        <span class="p">)</span>
</span><span id="__span-4-82">
</span><span id="__span-4-83">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-4-84">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-4-85">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-4-86">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_preventers</span><span class="p">)</span>
</span><span id="__span-4-87">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-4-88">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-4-89">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-4-90">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-4-91">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-4-92">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-4-93">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-4-94">
</span><span id="__span-4-95">
</span><span id="__span-4-96"><span class="k">def</span> <span class="nf">select_heroes</span><span class="p">():</span>
</span><span id="__span-4-97">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-4-98">        <span class="n">statement</span> <span class="o">=</span> <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-4-99">        <span class="n">result</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="n">statement</span><span class="p">)</span>
</span><span id="__span-4-100">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-4-101">
</span><span id="__span-4-102">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers heroes:&quot;</span><span class="p">,</span> <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-4-103">
</span><span id="__span-4-104">
</span><span id="__span-4-105"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-4-106">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-4-107">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-4-108">            <span class="n">select</span><span class="p">(</span><span class="n">Hero</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hero</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Spider-Boy&quot;</span><span class="p">)</span>
</span><span id="__span-4-109">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-4-110">
</span><span id="__span-4-111">        <span class="n">preventers_team</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-4-112">            <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-4-113">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-4-114">
</span><span id="__span-4-115">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hero Spider-Boy:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-4-116">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="p">)</span>
</span><span id="__span-4-117">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-4-118">
</span><span id="__span-4-119">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-4-120">
</span><span id="__span-4-121">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy without team:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-4-122">
</span><span id="__span-4-123">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes again:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-4-124">
</span><span id="__span-4-125">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-4-126">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-4-127">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After committing&quot;</span><span class="p">)</span>
</span><span id="__span-4-128">
</span><span id="__span-4-129">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-4-130">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy after commit:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-4-131">
</span><span id="__span-4-132">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes after commit:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-4-133">
</span><span id="__span-4-134">
</span><span id="__span-4-135"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span id="__span-4-136">    <span class="n">create_db_and_tables</span><span class="p">()</span>
</span><span id="__span-4-137">    <span class="n">create_heroes</span><span class="p">()</span>
</span><span id="__span-4-138">    <span class="n">select_heroes</span><span class="p">()</span>
</span><span id="__span-4-139">    <span class="n">update_heroes</span><span class="p">()</span>
</span><span id="__span-4-140">
</span><span id="__span-4-141">
</span><span id="__span-4-142"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-4-143">    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-5-1"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span>
</span><span id="__span-5-2">
</span><span id="__span-5-3"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">select</span>
</span><span id="__span-5-4">
</span><span id="__span-5-5">
</span><span id="__span-5-6"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-5-7">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-5-8">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-5-9">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-5-10">
</span><span id="__span-5-11">    <span class="n">heroes</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="s2">&quot;Hero&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">()</span>
</span><span id="__span-5-12">
</span><span id="__span-5-13">
</span><span id="__span-5-14"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-5-15">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-5-16">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-5-17">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-5-18">    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-5-19">
</span><span id="__span-5-20">    <span class="n">team_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">)</span>
</span><span id="__span-5-21">    <span class="n">team</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Team</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">()</span>
</span><span id="__span-5-22">
</span><span id="__span-5-23">
</span><span id="__span-5-24"><span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
</span><span id="__span-5-25"><span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-5-26">
</span><span id="__span-5-27"><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-5-28">
</span><span id="__span-5-29">
</span><span id="__span-5-30"><span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
</span><span id="__span-5-31">    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
</span><span id="__span-5-32">
</span><span id="__span-5-33">
</span><span id="__span-5-34"><span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
</span><span id="__span-5-35">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-5-36">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Preventers&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sharp Tower&quot;</span><span class="p">)</span>
</span><span id="__span-5-37">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Z-Force&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sister Margaret&#39;s Bar&quot;</span><span class="p">)</span>
</span><span id="__span-5-38">
</span><span id="__span-5-39">        <span class="n">hero_deadpond</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-5-40">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Dive Wilson&quot;</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span>
</span><span id="__span-5-41">        <span class="p">)</span>
</span><span id="__span-5-42">        <span class="n">hero_rusty_man</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-5-43">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span>
</span><span id="__span-5-44">        <span class="p">)</span>
</span><span id="__span-5-45">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
</span><span id="__span-5-46">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-5-47">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-5-48">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-5-49">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-5-50">
</span><span id="__span-5-51">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-5-52">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-5-53">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-5-54">
</span><span id="__span-5-55">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-5-56">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-5-57">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-5-58">
</span><span id="__span-5-59">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="n">team_preventers</span>
</span><span id="__span-5-60">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-5-61">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-5-62">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-5-63">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Updated hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-5-64">
</span><span id="__span-5-65">        <span class="n">hero_black_lion</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Black Lion&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Trevor Challa&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">35</span><span class="p">)</span>
</span><span id="__span-5-66">        <span class="n">hero_sure_e</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Princess Sure-E&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Sure-E&quot;</span><span class="p">)</span>
</span><span id="__span-5-67">        <span class="n">team_wakaland</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span>
</span><span id="__span-5-68">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Wakaland&quot;</span><span class="p">,</span>
</span><span id="__span-5-69">            <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Wakaland Capital City&quot;</span><span class="p">,</span>
</span><span id="__span-5-70">            <span class="n">heroes</span><span class="o">=</span><span class="p">[</span><span class="n">hero_black_lion</span><span class="p">,</span> <span class="n">hero_sure_e</span><span class="p">],</span>
</span><span id="__span-5-71">        <span class="p">)</span>
</span><span id="__span-5-72">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-5-73">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-5-74">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-5-75">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Team Wakaland:&quot;</span><span class="p">,</span> <span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-5-76">
</span><span id="__span-5-77">        <span class="n">hero_tarantula</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Tarantula&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Natalia Roman-on&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
</span><span id="__span-5-78">        <span class="n">hero_dr_weird</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Dr. Weird&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Steve Weird&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">36</span><span class="p">)</span>
</span><span id="__span-5-79">        <span class="n">hero_cap</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-5-80">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Captain North America&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Esteban Rogelios&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">93</span>
</span><span id="__span-5-81">        <span class="p">)</span>
</span><span id="__span-5-82">
</span><span id="__span-5-83">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-5-84">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-5-85">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-5-86">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_preventers</span><span class="p">)</span>
</span><span id="__span-5-87">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-5-88">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-5-89">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-5-90">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-5-91">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-5-92">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-5-93">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-5-94">
</span><span id="__span-5-95">
</span><span id="__span-5-96"><span class="k">def</span> <span class="nf">select_heroes</span><span class="p">():</span>
</span><span id="__span-5-97">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-5-98">        <span class="n">statement</span> <span class="o">=</span> <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-5-99">        <span class="n">result</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="n">statement</span><span class="p">)</span>
</span><span id="__span-5-100">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-5-101">
</span><span id="__span-5-102">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers heroes:&quot;</span><span class="p">,</span> <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-5-103">
</span><span id="__span-5-104">
</span><span id="__span-5-105"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-5-106">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-5-107">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-5-108">            <span class="n">select</span><span class="p">(</span><span class="n">Hero</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hero</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Spider-Boy&quot;</span><span class="p">)</span>
</span><span id="__span-5-109">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-5-110">
</span><span id="__span-5-111">        <span class="n">preventers_team</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-5-112">            <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-5-113">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-5-114">
</span><span id="__span-5-115">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hero Spider-Boy:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-5-116">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="p">)</span>
</span><span id="__span-5-117">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-5-118">
</span><span id="__span-5-119">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-5-120">
</span><span id="__span-5-121">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy without team:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-5-122">
</span><span id="__span-5-123">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes again:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-5-124">
</span><span id="__span-5-125">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-5-126">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-5-127">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After committing&quot;</span><span class="p">)</span>
</span><span id="__span-5-128">
</span><span id="__span-5-129">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-5-130">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy after commit:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-5-131">
</span><span id="__span-5-132">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes after commit:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-5-133">
</span><span id="__span-5-134">
</span><span id="__span-5-135"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span id="__span-5-136">    <span class="n">create_db_and_tables</span><span class="p">()</span>
</span><span id="__span-5-137">    <span class="n">create_heroes</span><span class="p">()</span>
</span><span id="__span-5-138">    <span class="n">select_heroes</span><span class="p">()</span>
</span><span id="__span-5-139">    <span class="n">update_heroes</span><span class="p">()</span>
</span><span id="__span-5-140">
</span><span id="__span-5-141">
</span><span id="__span-5-142"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-5-143">    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div>
</div>
</div>
</div>
</details>
<h2 id="read-data-objects">Read Data Objects<a class="headerlink" href="#read-data-objects" title="Permanent link">&para;</a></h2>
<p>Now, we will get the <strong>Spider-Boy</strong> hero and, <em>independently</em>, the <strong>Preventers</strong> team using two <code>select</code>s.</p>
<p>As you already know how this works, I won't separate that in a select <code>statement</code>, <code>results</code>, etc. Let's use the shorter form in a single call:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:3"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><input id="__tabbed_3_2" name="__tabbed_3" type="radio" /><input id="__tabbed_3_3" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="__tabbed_3_1">Python 3.10+</label><label for="__tabbed_3_2">Python 3.9+</label><label for="__tabbed_3_3">Python 3.7+</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-6-1"><span class="c1"># Code above omitted 👆</span>
</span><span id="__span-6-2">
</span><span id="__span-6-3"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-6-4">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-6-5"><span class="hll">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span></span><span id="__span-6-6"><span class="hll">            <span class="n">select</span><span class="p">(</span><span class="n">Hero</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hero</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Spider-Boy&quot;</span><span class="p">)</span>
</span></span><span id="__span-6-7"><span class="hll">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span></span><span id="__span-6-8">
</span><span id="__span-6-9"><span class="hll">        <span class="n">preventers_team</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span></span><span id="__span-6-10"><span class="hll">            <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span></span><span id="__span-6-11"><span class="hll">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span></span><span id="__span-6-12">
</span><span id="__span-6-13"><span class="c1"># Code below omitted 👇</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-7-1"><span class="c1"># Code above omitted 👆</span>
</span><span id="__span-7-2">
</span><span id="__span-7-3"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-7-4">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-7-5"><span class="hll">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span></span><span id="__span-7-6"><span class="hll">            <span class="n">select</span><span class="p">(</span><span class="n">Hero</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hero</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Spider-Boy&quot;</span><span class="p">)</span>
</span></span><span id="__span-7-7"><span class="hll">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span></span><span id="__span-7-8">
</span><span id="__span-7-9"><span class="hll">        <span class="n">preventers_team</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span></span><span id="__span-7-10"><span class="hll">            <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span></span><span id="__span-7-11"><span class="hll">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span></span><span id="__span-7-12">
</span><span id="__span-7-13"><span class="c1"># Code below omitted 👇</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-8-1"><span class="c1"># Code above omitted 👆</span>
</span><span id="__span-8-2">
</span><span id="__span-8-3"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-8-4">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-8-5"><span class="hll">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span></span><span id="__span-8-6"><span class="hll">            <span class="n">select</span><span class="p">(</span><span class="n">Hero</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hero</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Spider-Boy&quot;</span><span class="p">)</span>
</span></span><span id="__span-8-7"><span class="hll">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span></span><span id="__span-8-8">
</span><span id="__span-8-9"><span class="hll">        <span class="n">preventers_team</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span></span><span id="__span-8-10"><span class="hll">            <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span></span><span id="__span-8-11"><span class="hll">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span></span><span id="__span-8-12">
</span><span id="__span-8-13"><span class="c1"># Code below omitted 👇</span>
</span></code></pre></div>
</div>
</div>
</div>
<details>
<summary>👀 Full file preview</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="4:3"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><input id="__tabbed_4_2" name="__tabbed_4" type="radio" /><input id="__tabbed_4_3" name="__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="__tabbed_4_1">Python 3.10+</label><label for="__tabbed_4_2">Python 3.9+</label><label for="__tabbed_4_3">Python 3.7+</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-9-1"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">select</span>
</span><span id="__span-9-2">
</span><span id="__span-9-3">
</span><span id="__span-9-4"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-9-5">    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-9-6">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-9-7">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-9-8">
</span><span id="__span-9-9">    <span class="n">heroes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;Hero&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">()</span>
</span><span id="__span-9-10">
</span><span id="__span-9-11">
</span><span id="__span-9-12"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-9-13">    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-9-14">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-9-15">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-9-16">    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-9-17">
</span><span id="__span-9-18">    <span class="n">team_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">)</span>
</span><span id="__span-9-19">    <span class="n">team</span><span class="p">:</span> <span class="n">Team</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">()</span>
</span><span id="__span-9-20">
</span><span id="__span-9-21">
</span><span id="__span-9-22"><span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
</span><span id="__span-9-23"><span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-9-24">
</span><span id="__span-9-25"><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-9-26">
</span><span id="__span-9-27">
</span><span id="__span-9-28"><span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
</span><span id="__span-9-29">    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
</span><span id="__span-9-30">
</span><span id="__span-9-31">
</span><span id="__span-9-32"><span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
</span><span id="__span-9-33">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-9-34">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Preventers&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sharp Tower&quot;</span><span class="p">)</span>
</span><span id="__span-9-35">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Z-Force&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sister Margaret&#39;s Bar&quot;</span><span class="p">)</span>
</span><span id="__span-9-36">
</span><span id="__span-9-37">        <span class="n">hero_deadpond</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-9-38">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Dive Wilson&quot;</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span>
</span><span id="__span-9-39">        <span class="p">)</span>
</span><span id="__span-9-40">        <span class="n">hero_rusty_man</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-9-41">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span>
</span><span id="__span-9-42">        <span class="p">)</span>
</span><span id="__span-9-43">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
</span><span id="__span-9-44">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-9-45">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-9-46">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-9-47">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-9-48">
</span><span id="__span-9-49">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-9-50">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-9-51">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-9-52">
</span><span id="__span-9-53">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-9-54">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-9-55">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-9-56">
</span><span id="__span-9-57">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="n">team_preventers</span>
</span><span id="__span-9-58">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-9-59">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-9-60">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-9-61">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Updated hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-9-62">
</span><span id="__span-9-63">        <span class="n">hero_black_lion</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Black Lion&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Trevor Challa&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">35</span><span class="p">)</span>
</span><span id="__span-9-64">        <span class="n">hero_sure_e</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Princess Sure-E&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Sure-E&quot;</span><span class="p">)</span>
</span><span id="__span-9-65">        <span class="n">team_wakaland</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span>
</span><span id="__span-9-66">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Wakaland&quot;</span><span class="p">,</span>
</span><span id="__span-9-67">            <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Wakaland Capital City&quot;</span><span class="p">,</span>
</span><span id="__span-9-68">            <span class="n">heroes</span><span class="o">=</span><span class="p">[</span><span class="n">hero_black_lion</span><span class="p">,</span> <span class="n">hero_sure_e</span><span class="p">],</span>
</span><span id="__span-9-69">        <span class="p">)</span>
</span><span id="__span-9-70">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-9-71">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-9-72">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-9-73">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Team Wakaland:&quot;</span><span class="p">,</span> <span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-9-74">
</span><span id="__span-9-75">        <span class="n">hero_tarantula</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Tarantula&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Natalia Roman-on&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
</span><span id="__span-9-76">        <span class="n">hero_dr_weird</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Dr. Weird&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Steve Weird&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">36</span><span class="p">)</span>
</span><span id="__span-9-77">        <span class="n">hero_cap</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-9-78">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Captain North America&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Esteban Rogelios&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">93</span>
</span><span id="__span-9-79">        <span class="p">)</span>
</span><span id="__span-9-80">
</span><span id="__span-9-81">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-9-82">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-9-83">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-9-84">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_preventers</span><span class="p">)</span>
</span><span id="__span-9-85">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-9-86">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-9-87">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-9-88">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-9-89">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-9-90">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-9-91">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-9-92">
</span><span id="__span-9-93">
</span><span id="__span-9-94"><span class="k">def</span> <span class="nf">select_heroes</span><span class="p">():</span>
</span><span id="__span-9-95">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-9-96">        <span class="n">statement</span> <span class="o">=</span> <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-9-97">        <span class="n">result</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="n">statement</span><span class="p">)</span>
</span><span id="__span-9-98">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-9-99">
</span><span id="__span-9-100">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers heroes:&quot;</span><span class="p">,</span> <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-9-101">
</span><span id="__span-9-102">
</span><span id="__span-9-103"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-9-104">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-9-105">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-9-106">            <span class="n">select</span><span class="p">(</span><span class="n">Hero</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hero</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Spider-Boy&quot;</span><span class="p">)</span>
</span><span id="__span-9-107">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-9-108">
</span><span id="__span-9-109">        <span class="n">preventers_team</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-9-110">            <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-9-111">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-9-112">
</span><span id="__span-9-113">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hero Spider-Boy:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-9-114">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="p">)</span>
</span><span id="__span-9-115">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-9-116">
</span><span id="__span-9-117">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-9-118">
</span><span id="__span-9-119">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy without team:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-9-120">
</span><span id="__span-9-121">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes again:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-9-122">
</span><span id="__span-9-123">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-9-124">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-9-125">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After committing&quot;</span><span class="p">)</span>
</span><span id="__span-9-126">
</span><span id="__span-9-127">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-9-128">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy after commit:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-9-129">
</span><span id="__span-9-130">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes after commit:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-9-131">
</span><span id="__span-9-132">
</span><span id="__span-9-133"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span id="__span-9-134">    <span class="n">create_db_and_tables</span><span class="p">()</span>
</span><span id="__span-9-135">    <span class="n">create_heroes</span><span class="p">()</span>
</span><span id="__span-9-136">    <span class="n">select_heroes</span><span class="p">()</span>
</span><span id="__span-9-137">    <span class="n">update_heroes</span><span class="p">()</span>
</span><span id="__span-9-138">
</span><span id="__span-9-139">
</span><span id="__span-9-140"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-9-141">    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-10-1"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>
</span><span id="__span-10-2">
</span><span id="__span-10-3"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">select</span>
</span><span id="__span-10-4">
</span><span id="__span-10-5">
</span><span id="__span-10-6"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-10-7">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-10-8">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-10-9">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-10-10">
</span><span id="__span-10-11">    <span class="n">heroes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;Hero&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">()</span>
</span><span id="__span-10-12">
</span><span id="__span-10-13">
</span><span id="__span-10-14"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-10-15">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-10-16">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-10-17">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-10-18">    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-10-19">
</span><span id="__span-10-20">    <span class="n">team_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">)</span>
</span><span id="__span-10-21">    <span class="n">team</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Team</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">()</span>
</span><span id="__span-10-22">
</span><span id="__span-10-23">
</span><span id="__span-10-24"><span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
</span><span id="__span-10-25"><span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-10-26">
</span><span id="__span-10-27"><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-10-28">
</span><span id="__span-10-29">
</span><span id="__span-10-30"><span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
</span><span id="__span-10-31">    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
</span><span id="__span-10-32">
</span><span id="__span-10-33">
</span><span id="__span-10-34"><span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
</span><span id="__span-10-35">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-10-36">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Preventers&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sharp Tower&quot;</span><span class="p">)</span>
</span><span id="__span-10-37">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Z-Force&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sister Margaret&#39;s Bar&quot;</span><span class="p">)</span>
</span><span id="__span-10-38">
</span><span id="__span-10-39">        <span class="n">hero_deadpond</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-10-40">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Dive Wilson&quot;</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span>
</span><span id="__span-10-41">        <span class="p">)</span>
</span><span id="__span-10-42">        <span class="n">hero_rusty_man</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-10-43">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span>
</span><span id="__span-10-44">        <span class="p">)</span>
</span><span id="__span-10-45">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
</span><span id="__span-10-46">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-10-47">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-10-48">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-10-49">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-10-50">
</span><span id="__span-10-51">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-10-52">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-10-53">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-10-54">
</span><span id="__span-10-55">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-10-56">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-10-57">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-10-58">
</span><span id="__span-10-59">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="n">team_preventers</span>
</span><span id="__span-10-60">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-10-61">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-10-62">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-10-63">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Updated hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-10-64">
</span><span id="__span-10-65">        <span class="n">hero_black_lion</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Black Lion&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Trevor Challa&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">35</span><span class="p">)</span>
</span><span id="__span-10-66">        <span class="n">hero_sure_e</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Princess Sure-E&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Sure-E&quot;</span><span class="p">)</span>
</span><span id="__span-10-67">        <span class="n">team_wakaland</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span>
</span><span id="__span-10-68">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Wakaland&quot;</span><span class="p">,</span>
</span><span id="__span-10-69">            <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Wakaland Capital City&quot;</span><span class="p">,</span>
</span><span id="__span-10-70">            <span class="n">heroes</span><span class="o">=</span><span class="p">[</span><span class="n">hero_black_lion</span><span class="p">,</span> <span class="n">hero_sure_e</span><span class="p">],</span>
</span><span id="__span-10-71">        <span class="p">)</span>
</span><span id="__span-10-72">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-10-73">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-10-74">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-10-75">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Team Wakaland:&quot;</span><span class="p">,</span> <span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-10-76">
</span><span id="__span-10-77">        <span class="n">hero_tarantula</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Tarantula&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Natalia Roman-on&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
</span><span id="__span-10-78">        <span class="n">hero_dr_weird</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Dr. Weird&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Steve Weird&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">36</span><span class="p">)</span>
</span><span id="__span-10-79">        <span class="n">hero_cap</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-10-80">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Captain North America&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Esteban Rogelios&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">93</span>
</span><span id="__span-10-81">        <span class="p">)</span>
</span><span id="__span-10-82">
</span><span id="__span-10-83">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-10-84">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-10-85">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-10-86">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_preventers</span><span class="p">)</span>
</span><span id="__span-10-87">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-10-88">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-10-89">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-10-90">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-10-91">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-10-92">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-10-93">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-10-94">
</span><span id="__span-10-95">
</span><span id="__span-10-96"><span class="k">def</span> <span class="nf">select_heroes</span><span class="p">():</span>
</span><span id="__span-10-97">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-10-98">        <span class="n">statement</span> <span class="o">=</span> <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-10-99">        <span class="n">result</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="n">statement</span><span class="p">)</span>
</span><span id="__span-10-100">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-10-101">
</span><span id="__span-10-102">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers heroes:&quot;</span><span class="p">,</span> <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-10-103">
</span><span id="__span-10-104">
</span><span id="__span-10-105"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-10-106">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-10-107">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-10-108">            <span class="n">select</span><span class="p">(</span><span class="n">Hero</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hero</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Spider-Boy&quot;</span><span class="p">)</span>
</span><span id="__span-10-109">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-10-110">
</span><span id="__span-10-111">        <span class="n">preventers_team</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-10-112">            <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-10-113">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-10-114">
</span><span id="__span-10-115">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hero Spider-Boy:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-10-116">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="p">)</span>
</span><span id="__span-10-117">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-10-118">
</span><span id="__span-10-119">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-10-120">
</span><span id="__span-10-121">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy without team:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-10-122">
</span><span id="__span-10-123">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes again:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-10-124">
</span><span id="__span-10-125">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-10-126">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-10-127">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After committing&quot;</span><span class="p">)</span>
</span><span id="__span-10-128">
</span><span id="__span-10-129">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-10-130">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy after commit:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-10-131">
</span><span id="__span-10-132">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes after commit:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-10-133">
</span><span id="__span-10-134">
</span><span id="__span-10-135"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span id="__span-10-136">    <span class="n">create_db_and_tables</span><span class="p">()</span>
</span><span id="__span-10-137">    <span class="n">create_heroes</span><span class="p">()</span>
</span><span id="__span-10-138">    <span class="n">select_heroes</span><span class="p">()</span>
</span><span id="__span-10-139">    <span class="n">update_heroes</span><span class="p">()</span>
</span><span id="__span-10-140">
</span><span id="__span-10-141">
</span><span id="__span-10-142"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-10-143">    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-11-1"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span>
</span><span id="__span-11-2">
</span><span id="__span-11-3"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">select</span>
</span><span id="__span-11-4">
</span><span id="__span-11-5">
</span><span id="__span-11-6"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-11-7">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-11-8">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-11-9">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-11-10">
</span><span id="__span-11-11">    <span class="n">heroes</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="s2">&quot;Hero&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">()</span>
</span><span id="__span-11-12">
</span><span id="__span-11-13">
</span><span id="__span-11-14"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-11-15">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-11-16">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-11-17">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-11-18">    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-11-19">
</span><span id="__span-11-20">    <span class="n">team_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">)</span>
</span><span id="__span-11-21">    <span class="n">team</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Team</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">()</span>
</span><span id="__span-11-22">
</span><span id="__span-11-23">
</span><span id="__span-11-24"><span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
</span><span id="__span-11-25"><span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-11-26">
</span><span id="__span-11-27"><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-11-28">
</span><span id="__span-11-29">
</span><span id="__span-11-30"><span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
</span><span id="__span-11-31">    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
</span><span id="__span-11-32">
</span><span id="__span-11-33">
</span><span id="__span-11-34"><span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
</span><span id="__span-11-35">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-11-36">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Preventers&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sharp Tower&quot;</span><span class="p">)</span>
</span><span id="__span-11-37">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Z-Force&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sister Margaret&#39;s Bar&quot;</span><span class="p">)</span>
</span><span id="__span-11-38">
</span><span id="__span-11-39">        <span class="n">hero_deadpond</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-11-40">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Dive Wilson&quot;</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span>
</span><span id="__span-11-41">        <span class="p">)</span>
</span><span id="__span-11-42">        <span class="n">hero_rusty_man</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-11-43">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span>
</span><span id="__span-11-44">        <span class="p">)</span>
</span><span id="__span-11-45">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
</span><span id="__span-11-46">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-11-47">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-11-48">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-11-49">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-11-50">
</span><span id="__span-11-51">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-11-52">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-11-53">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-11-54">
</span><span id="__span-11-55">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-11-56">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-11-57">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-11-58">
</span><span id="__span-11-59">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="n">team_preventers</span>
</span><span id="__span-11-60">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-11-61">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-11-62">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-11-63">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Updated hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-11-64">
</span><span id="__span-11-65">        <span class="n">hero_black_lion</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Black Lion&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Trevor Challa&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">35</span><span class="p">)</span>
</span><span id="__span-11-66">        <span class="n">hero_sure_e</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Princess Sure-E&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Sure-E&quot;</span><span class="p">)</span>
</span><span id="__span-11-67">        <span class="n">team_wakaland</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span>
</span><span id="__span-11-68">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Wakaland&quot;</span><span class="p">,</span>
</span><span id="__span-11-69">            <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Wakaland Capital City&quot;</span><span class="p">,</span>
</span><span id="__span-11-70">            <span class="n">heroes</span><span class="o">=</span><span class="p">[</span><span class="n">hero_black_lion</span><span class="p">,</span> <span class="n">hero_sure_e</span><span class="p">],</span>
</span><span id="__span-11-71">        <span class="p">)</span>
</span><span id="__span-11-72">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-11-73">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-11-74">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-11-75">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Team Wakaland:&quot;</span><span class="p">,</span> <span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-11-76">
</span><span id="__span-11-77">        <span class="n">hero_tarantula</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Tarantula&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Natalia Roman-on&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
</span><span id="__span-11-78">        <span class="n">hero_dr_weird</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Dr. Weird&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Steve Weird&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">36</span><span class="p">)</span>
</span><span id="__span-11-79">        <span class="n">hero_cap</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-11-80">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Captain North America&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Esteban Rogelios&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">93</span>
</span><span id="__span-11-81">        <span class="p">)</span>
</span><span id="__span-11-82">
</span><span id="__span-11-83">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-11-84">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-11-85">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-11-86">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_preventers</span><span class="p">)</span>
</span><span id="__span-11-87">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-11-88">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-11-89">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-11-90">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-11-91">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-11-92">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-11-93">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-11-94">
</span><span id="__span-11-95">
</span><span id="__span-11-96"><span class="k">def</span> <span class="nf">select_heroes</span><span class="p">():</span>
</span><span id="__span-11-97">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-11-98">        <span class="n">statement</span> <span class="o">=</span> <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-11-99">        <span class="n">result</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="n">statement</span><span class="p">)</span>
</span><span id="__span-11-100">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-11-101">
</span><span id="__span-11-102">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers heroes:&quot;</span><span class="p">,</span> <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-11-103">
</span><span id="__span-11-104">
</span><span id="__span-11-105"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-11-106">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-11-107">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-11-108">            <span class="n">select</span><span class="p">(</span><span class="n">Hero</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hero</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Spider-Boy&quot;</span><span class="p">)</span>
</span><span id="__span-11-109">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-11-110">
</span><span id="__span-11-111">        <span class="n">preventers_team</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-11-112">            <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-11-113">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-11-114">
</span><span id="__span-11-115">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hero Spider-Boy:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-11-116">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="p">)</span>
</span><span id="__span-11-117">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-11-118">
</span><span id="__span-11-119">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-11-120">
</span><span id="__span-11-121">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy without team:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-11-122">
</span><span id="__span-11-123">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes again:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-11-124">
</span><span id="__span-11-125">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-11-126">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-11-127">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After committing&quot;</span><span class="p">)</span>
</span><span id="__span-11-128">
</span><span id="__span-11-129">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-11-130">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy after commit:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-11-131">
</span><span id="__span-11-132">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes after commit:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-11-133">
</span><span id="__span-11-134">
</span><span id="__span-11-135"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span id="__span-11-136">    <span class="n">create_db_and_tables</span><span class="p">()</span>
</span><span id="__span-11-137">    <span class="n">create_heroes</span><span class="p">()</span>
</span><span id="__span-11-138">    <span class="n">select_heroes</span><span class="p">()</span>
</span><span id="__span-11-139">    <span class="n">update_heroes</span><span class="p">()</span>
</span><span id="__span-11-140">
</span><span id="__span-11-141">
</span><span id="__span-11-142"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-11-143">    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div>
</div>
</div>
</div>
</details>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>When writing your own code, this is probably the style you will use most often, as it's shorter, more convenient, and you still get all the power of autocompletion and inline errors.</p>
</div>
<h2 id="print-the-data">Print the Data<a class="headerlink" href="#print-the-data" title="Permanent link">&para;</a></h2>
<p>Now, let's print the current <strong>Spider-Boy</strong>, the current <strong>Preventers</strong> team, and particularly, the current <strong>Preventers</strong> list of heroes:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="5:3"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio" /><input id="__tabbed_5_2" name="__tabbed_5" type="radio" /><input id="__tabbed_5_3" name="__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="__tabbed_5_1">Python 3.10+</label><label for="__tabbed_5_2">Python 3.9+</label><label for="__tabbed_5_3">Python 3.7+</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-12-1"><span class="c1"># Code above omitted 👆</span>
</span><span id="__span-12-2">
</span><span id="__span-12-3"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-12-4">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-12-5">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-12-6">            <span class="n">select</span><span class="p">(</span><span class="n">Hero</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hero</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Spider-Boy&quot;</span><span class="p">)</span>
</span><span id="__span-12-7">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-12-8">
</span><span id="__span-12-9">        <span class="n">preventers_team</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-12-10">            <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-12-11">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-12-12">
</span><span id="__span-12-13"><span class="hll">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hero Spider-Boy:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span></span><span id="__span-12-14"><span class="hll">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="p">)</span>
</span></span><span id="__span-12-15"><span class="hll">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span></span><span id="__span-12-16">
</span><span id="__span-12-17"><span class="c1"># Code below omitted 👇</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-13-1"><span class="c1"># Code above omitted 👆</span>
</span><span id="__span-13-2">
</span><span id="__span-13-3"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-13-4">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-13-5">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-13-6">            <span class="n">select</span><span class="p">(</span><span class="n">Hero</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hero</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Spider-Boy&quot;</span><span class="p">)</span>
</span><span id="__span-13-7">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-13-8">
</span><span id="__span-13-9">        <span class="n">preventers_team</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-13-10">            <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-13-11">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-13-12">
</span><span id="__span-13-13"><span class="hll">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hero Spider-Boy:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span></span><span id="__span-13-14"><span class="hll">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="p">)</span>
</span></span><span id="__span-13-15"><span class="hll">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span></span><span id="__span-13-16">
</span><span id="__span-13-17"><span class="c1"># Code below omitted 👇</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-14-1"><span class="c1"># Code above omitted 👆</span>
</span><span id="__span-14-2">
</span><span id="__span-14-3"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-14-4">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-14-5">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-14-6">            <span class="n">select</span><span class="p">(</span><span class="n">Hero</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hero</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Spider-Boy&quot;</span><span class="p">)</span>
</span><span id="__span-14-7">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-14-8">
</span><span id="__span-14-9">        <span class="n">preventers_team</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-14-10">            <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-14-11">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-14-12">
</span><span id="__span-14-13"><span class="hll">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hero Spider-Boy:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span></span><span id="__span-14-14"><span class="hll">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="p">)</span>
</span></span><span id="__span-14-15"><span class="hll">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span></span><span id="__span-14-16">
</span><span id="__span-14-17"><span class="c1"># Code below omitted 👇</span>
</span></code></pre></div>
</div>
</div>
</div>
<details>
<summary>👀 Full file preview</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="6:3"><input checked="checked" id="__tabbed_6_1" name="__tabbed_6" type="radio" /><input id="__tabbed_6_2" name="__tabbed_6" type="radio" /><input id="__tabbed_6_3" name="__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="__tabbed_6_1">Python 3.10+</label><label for="__tabbed_6_2">Python 3.9+</label><label for="__tabbed_6_3">Python 3.7+</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-15-1"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">select</span>
</span><span id="__span-15-2">
</span><span id="__span-15-3">
</span><span id="__span-15-4"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-15-5">    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-15-6">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-15-7">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-15-8">
</span><span id="__span-15-9">    <span class="n">heroes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;Hero&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">()</span>
</span><span id="__span-15-10">
</span><span id="__span-15-11">
</span><span id="__span-15-12"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-15-13">    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-15-14">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-15-15">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-15-16">    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-15-17">
</span><span id="__span-15-18">    <span class="n">team_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">)</span>
</span><span id="__span-15-19">    <span class="n">team</span><span class="p">:</span> <span class="n">Team</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">()</span>
</span><span id="__span-15-20">
</span><span id="__span-15-21">
</span><span id="__span-15-22"><span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
</span><span id="__span-15-23"><span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-15-24">
</span><span id="__span-15-25"><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-15-26">
</span><span id="__span-15-27">
</span><span id="__span-15-28"><span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
</span><span id="__span-15-29">    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
</span><span id="__span-15-30">
</span><span id="__span-15-31">
</span><span id="__span-15-32"><span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
</span><span id="__span-15-33">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-15-34">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Preventers&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sharp Tower&quot;</span><span class="p">)</span>
</span><span id="__span-15-35">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Z-Force&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sister Margaret&#39;s Bar&quot;</span><span class="p">)</span>
</span><span id="__span-15-36">
</span><span id="__span-15-37">        <span class="n">hero_deadpond</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-15-38">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Dive Wilson&quot;</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span>
</span><span id="__span-15-39">        <span class="p">)</span>
</span><span id="__span-15-40">        <span class="n">hero_rusty_man</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-15-41">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span>
</span><span id="__span-15-42">        <span class="p">)</span>
</span><span id="__span-15-43">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
</span><span id="__span-15-44">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-15-45">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-15-46">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-15-47">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-15-48">
</span><span id="__span-15-49">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-15-50">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-15-51">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-15-52">
</span><span id="__span-15-53">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-15-54">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-15-55">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-15-56">
</span><span id="__span-15-57">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="n">team_preventers</span>
</span><span id="__span-15-58">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-15-59">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-15-60">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-15-61">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Updated hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-15-62">
</span><span id="__span-15-63">        <span class="n">hero_black_lion</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Black Lion&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Trevor Challa&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">35</span><span class="p">)</span>
</span><span id="__span-15-64">        <span class="n">hero_sure_e</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Princess Sure-E&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Sure-E&quot;</span><span class="p">)</span>
</span><span id="__span-15-65">        <span class="n">team_wakaland</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span>
</span><span id="__span-15-66">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Wakaland&quot;</span><span class="p">,</span>
</span><span id="__span-15-67">            <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Wakaland Capital City&quot;</span><span class="p">,</span>
</span><span id="__span-15-68">            <span class="n">heroes</span><span class="o">=</span><span class="p">[</span><span class="n">hero_black_lion</span><span class="p">,</span> <span class="n">hero_sure_e</span><span class="p">],</span>
</span><span id="__span-15-69">        <span class="p">)</span>
</span><span id="__span-15-70">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-15-71">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-15-72">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-15-73">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Team Wakaland:&quot;</span><span class="p">,</span> <span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-15-74">
</span><span id="__span-15-75">        <span class="n">hero_tarantula</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Tarantula&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Natalia Roman-on&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
</span><span id="__span-15-76">        <span class="n">hero_dr_weird</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Dr. Weird&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Steve Weird&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">36</span><span class="p">)</span>
</span><span id="__span-15-77">        <span class="n">hero_cap</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-15-78">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Captain North America&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Esteban Rogelios&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">93</span>
</span><span id="__span-15-79">        <span class="p">)</span>
</span><span id="__span-15-80">
</span><span id="__span-15-81">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-15-82">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-15-83">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-15-84">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_preventers</span><span class="p">)</span>
</span><span id="__span-15-85">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-15-86">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-15-87">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-15-88">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-15-89">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-15-90">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-15-91">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-15-92">
</span><span id="__span-15-93">
</span><span id="__span-15-94"><span class="k">def</span> <span class="nf">select_heroes</span><span class="p">():</span>
</span><span id="__span-15-95">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-15-96">        <span class="n">statement</span> <span class="o">=</span> <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-15-97">        <span class="n">result</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="n">statement</span><span class="p">)</span>
</span><span id="__span-15-98">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-15-99">
</span><span id="__span-15-100">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers heroes:&quot;</span><span class="p">,</span> <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-15-101">
</span><span id="__span-15-102">
</span><span id="__span-15-103"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-15-104">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-15-105">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-15-106">            <span class="n">select</span><span class="p">(</span><span class="n">Hero</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hero</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Spider-Boy&quot;</span><span class="p">)</span>
</span><span id="__span-15-107">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-15-108">
</span><span id="__span-15-109">        <span class="n">preventers_team</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-15-110">            <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-15-111">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-15-112">
</span><span id="__span-15-113">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hero Spider-Boy:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-15-114">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="p">)</span>
</span><span id="__span-15-115">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-15-116">
</span><span id="__span-15-117">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-15-118">
</span><span id="__span-15-119">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy without team:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-15-120">
</span><span id="__span-15-121">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes again:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-15-122">
</span><span id="__span-15-123">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-15-124">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-15-125">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After committing&quot;</span><span class="p">)</span>
</span><span id="__span-15-126">
</span><span id="__span-15-127">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-15-128">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy after commit:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-15-129">
</span><span id="__span-15-130">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes after commit:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-15-131">
</span><span id="__span-15-132">
</span><span id="__span-15-133"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span id="__span-15-134">    <span class="n">create_db_and_tables</span><span class="p">()</span>
</span><span id="__span-15-135">    <span class="n">create_heroes</span><span class="p">()</span>
</span><span id="__span-15-136">    <span class="n">select_heroes</span><span class="p">()</span>
</span><span id="__span-15-137">    <span class="n">update_heroes</span><span class="p">()</span>
</span><span id="__span-15-138">
</span><span id="__span-15-139">
</span><span id="__span-15-140"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-15-141">    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-16-1"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>
</span><span id="__span-16-2">
</span><span id="__span-16-3"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">select</span>
</span><span id="__span-16-4">
</span><span id="__span-16-5">
</span><span id="__span-16-6"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-16-7">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-16-8">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-16-9">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-16-10">
</span><span id="__span-16-11">    <span class="n">heroes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;Hero&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">()</span>
</span><span id="__span-16-12">
</span><span id="__span-16-13">
</span><span id="__span-16-14"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-16-15">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-16-16">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-16-17">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-16-18">    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-16-19">
</span><span id="__span-16-20">    <span class="n">team_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">)</span>
</span><span id="__span-16-21">    <span class="n">team</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Team</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">()</span>
</span><span id="__span-16-22">
</span><span id="__span-16-23">
</span><span id="__span-16-24"><span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
</span><span id="__span-16-25"><span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-16-26">
</span><span id="__span-16-27"><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-16-28">
</span><span id="__span-16-29">
</span><span id="__span-16-30"><span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
</span><span id="__span-16-31">    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
</span><span id="__span-16-32">
</span><span id="__span-16-33">
</span><span id="__span-16-34"><span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
</span><span id="__span-16-35">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-16-36">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Preventers&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sharp Tower&quot;</span><span class="p">)</span>
</span><span id="__span-16-37">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Z-Force&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sister Margaret&#39;s Bar&quot;</span><span class="p">)</span>
</span><span id="__span-16-38">
</span><span id="__span-16-39">        <span class="n">hero_deadpond</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-16-40">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Dive Wilson&quot;</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span>
</span><span id="__span-16-41">        <span class="p">)</span>
</span><span id="__span-16-42">        <span class="n">hero_rusty_man</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-16-43">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span>
</span><span id="__span-16-44">        <span class="p">)</span>
</span><span id="__span-16-45">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
</span><span id="__span-16-46">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-16-47">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-16-48">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-16-49">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-16-50">
</span><span id="__span-16-51">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-16-52">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-16-53">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-16-54">
</span><span id="__span-16-55">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-16-56">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-16-57">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-16-58">
</span><span id="__span-16-59">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="n">team_preventers</span>
</span><span id="__span-16-60">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-16-61">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-16-62">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-16-63">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Updated hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-16-64">
</span><span id="__span-16-65">        <span class="n">hero_black_lion</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Black Lion&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Trevor Challa&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">35</span><span class="p">)</span>
</span><span id="__span-16-66">        <span class="n">hero_sure_e</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Princess Sure-E&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Sure-E&quot;</span><span class="p">)</span>
</span><span id="__span-16-67">        <span class="n">team_wakaland</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span>
</span><span id="__span-16-68">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Wakaland&quot;</span><span class="p">,</span>
</span><span id="__span-16-69">            <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Wakaland Capital City&quot;</span><span class="p">,</span>
</span><span id="__span-16-70">            <span class="n">heroes</span><span class="o">=</span><span class="p">[</span><span class="n">hero_black_lion</span><span class="p">,</span> <span class="n">hero_sure_e</span><span class="p">],</span>
</span><span id="__span-16-71">        <span class="p">)</span>
</span><span id="__span-16-72">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-16-73">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-16-74">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-16-75">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Team Wakaland:&quot;</span><span class="p">,</span> <span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-16-76">
</span><span id="__span-16-77">        <span class="n">hero_tarantula</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Tarantula&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Natalia Roman-on&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
</span><span id="__span-16-78">        <span class="n">hero_dr_weird</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Dr. Weird&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Steve Weird&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">36</span><span class="p">)</span>
</span><span id="__span-16-79">        <span class="n">hero_cap</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-16-80">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Captain North America&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Esteban Rogelios&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">93</span>
</span><span id="__span-16-81">        <span class="p">)</span>
</span><span id="__span-16-82">
</span><span id="__span-16-83">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-16-84">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-16-85">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-16-86">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_preventers</span><span class="p">)</span>
</span><span id="__span-16-87">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-16-88">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-16-89">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-16-90">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-16-91">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-16-92">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-16-93">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-16-94">
</span><span id="__span-16-95">
</span><span id="__span-16-96"><span class="k">def</span> <span class="nf">select_heroes</span><span class="p">():</span>
</span><span id="__span-16-97">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-16-98">        <span class="n">statement</span> <span class="o">=</span> <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-16-99">        <span class="n">result</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="n">statement</span><span class="p">)</span>
</span><span id="__span-16-100">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-16-101">
</span><span id="__span-16-102">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers heroes:&quot;</span><span class="p">,</span> <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-16-103">
</span><span id="__span-16-104">
</span><span id="__span-16-105"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-16-106">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-16-107">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-16-108">            <span class="n">select</span><span class="p">(</span><span class="n">Hero</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hero</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Spider-Boy&quot;</span><span class="p">)</span>
</span><span id="__span-16-109">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-16-110">
</span><span id="__span-16-111">        <span class="n">preventers_team</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-16-112">            <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-16-113">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-16-114">
</span><span id="__span-16-115">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hero Spider-Boy:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-16-116">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="p">)</span>
</span><span id="__span-16-117">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-16-118">
</span><span id="__span-16-119">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-16-120">
</span><span id="__span-16-121">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy without team:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-16-122">
</span><span id="__span-16-123">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes again:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-16-124">
</span><span id="__span-16-125">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-16-126">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-16-127">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After committing&quot;</span><span class="p">)</span>
</span><span id="__span-16-128">
</span><span id="__span-16-129">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-16-130">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy after commit:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-16-131">
</span><span id="__span-16-132">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes after commit:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-16-133">
</span><span id="__span-16-134">
</span><span id="__span-16-135"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span id="__span-16-136">    <span class="n">create_db_and_tables</span><span class="p">()</span>
</span><span id="__span-16-137">    <span class="n">create_heroes</span><span class="p">()</span>
</span><span id="__span-16-138">    <span class="n">select_heroes</span><span class="p">()</span>
</span><span id="__span-16-139">    <span class="n">update_heroes</span><span class="p">()</span>
</span><span id="__span-16-140">
</span><span id="__span-16-141">
</span><span id="__span-16-142"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-16-143">    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-17-1"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span>
</span><span id="__span-17-2">
</span><span id="__span-17-3"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">select</span>
</span><span id="__span-17-4">
</span><span id="__span-17-5">
</span><span id="__span-17-6"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-17-7">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-17-8">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-17-9">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-17-10">
</span><span id="__span-17-11">    <span class="n">heroes</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="s2">&quot;Hero&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">()</span>
</span><span id="__span-17-12">
</span><span id="__span-17-13">
</span><span id="__span-17-14"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-17-15">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-17-16">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-17-17">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-17-18">    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-17-19">
</span><span id="__span-17-20">    <span class="n">team_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">)</span>
</span><span id="__span-17-21">    <span class="n">team</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Team</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">()</span>
</span><span id="__span-17-22">
</span><span id="__span-17-23">
</span><span id="__span-17-24"><span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
</span><span id="__span-17-25"><span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-17-26">
</span><span id="__span-17-27"><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-17-28">
</span><span id="__span-17-29">
</span><span id="__span-17-30"><span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
</span><span id="__span-17-31">    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
</span><span id="__span-17-32">
</span><span id="__span-17-33">
</span><span id="__span-17-34"><span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
</span><span id="__span-17-35">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-17-36">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Preventers&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sharp Tower&quot;</span><span class="p">)</span>
</span><span id="__span-17-37">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Z-Force&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sister Margaret&#39;s Bar&quot;</span><span class="p">)</span>
</span><span id="__span-17-38">
</span><span id="__span-17-39">        <span class="n">hero_deadpond</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-17-40">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Dive Wilson&quot;</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span>
</span><span id="__span-17-41">        <span class="p">)</span>
</span><span id="__span-17-42">        <span class="n">hero_rusty_man</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-17-43">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span>
</span><span id="__span-17-44">        <span class="p">)</span>
</span><span id="__span-17-45">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
</span><span id="__span-17-46">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-17-47">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-17-48">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-17-49">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-17-50">
</span><span id="__span-17-51">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-17-52">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-17-53">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-17-54">
</span><span id="__span-17-55">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-17-56">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-17-57">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-17-58">
</span><span id="__span-17-59">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="n">team_preventers</span>
</span><span id="__span-17-60">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-17-61">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-17-62">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-17-63">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Updated hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-17-64">
</span><span id="__span-17-65">        <span class="n">hero_black_lion</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Black Lion&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Trevor Challa&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">35</span><span class="p">)</span>
</span><span id="__span-17-66">        <span class="n">hero_sure_e</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Princess Sure-E&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Sure-E&quot;</span><span class="p">)</span>
</span><span id="__span-17-67">        <span class="n">team_wakaland</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span>
</span><span id="__span-17-68">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Wakaland&quot;</span><span class="p">,</span>
</span><span id="__span-17-69">            <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Wakaland Capital City&quot;</span><span class="p">,</span>
</span><span id="__span-17-70">            <span class="n">heroes</span><span class="o">=</span><span class="p">[</span><span class="n">hero_black_lion</span><span class="p">,</span> <span class="n">hero_sure_e</span><span class="p">],</span>
</span><span id="__span-17-71">        <span class="p">)</span>
</span><span id="__span-17-72">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-17-73">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-17-74">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-17-75">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Team Wakaland:&quot;</span><span class="p">,</span> <span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-17-76">
</span><span id="__span-17-77">        <span class="n">hero_tarantula</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Tarantula&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Natalia Roman-on&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
</span><span id="__span-17-78">        <span class="n">hero_dr_weird</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Dr. Weird&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Steve Weird&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">36</span><span class="p">)</span>
</span><span id="__span-17-79">        <span class="n">hero_cap</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-17-80">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Captain North America&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Esteban Rogelios&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">93</span>
</span><span id="__span-17-81">        <span class="p">)</span>
</span><span id="__span-17-82">
</span><span id="__span-17-83">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-17-84">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-17-85">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-17-86">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_preventers</span><span class="p">)</span>
</span><span id="__span-17-87">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-17-88">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-17-89">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-17-90">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-17-91">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-17-92">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-17-93">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-17-94">
</span><span id="__span-17-95">
</span><span id="__span-17-96"><span class="k">def</span> <span class="nf">select_heroes</span><span class="p">():</span>
</span><span id="__span-17-97">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-17-98">        <span class="n">statement</span> <span class="o">=</span> <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-17-99">        <span class="n">result</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="n">statement</span><span class="p">)</span>
</span><span id="__span-17-100">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-17-101">
</span><span id="__span-17-102">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers heroes:&quot;</span><span class="p">,</span> <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-17-103">
</span><span id="__span-17-104">
</span><span id="__span-17-105"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-17-106">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-17-107">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-17-108">            <span class="n">select</span><span class="p">(</span><span class="n">Hero</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hero</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Spider-Boy&quot;</span><span class="p">)</span>
</span><span id="__span-17-109">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-17-110">
</span><span id="__span-17-111">        <span class="n">preventers_team</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-17-112">            <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-17-113">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-17-114">
</span><span id="__span-17-115">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hero Spider-Boy:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-17-116">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="p">)</span>
</span><span id="__span-17-117">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-17-118">
</span><span id="__span-17-119">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-17-120">
</span><span id="__span-17-121">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy without team:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-17-122">
</span><span id="__span-17-123">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes again:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-17-124">
</span><span id="__span-17-125">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-17-126">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-17-127">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After committing&quot;</span><span class="p">)</span>
</span><span id="__span-17-128">
</span><span id="__span-17-129">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-17-130">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy after commit:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-17-131">
</span><span id="__span-17-132">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes after commit:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-17-133">
</span><span id="__span-17-134">
</span><span id="__span-17-135"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span id="__span-17-136">    <span class="n">create_db_and_tables</span><span class="p">()</span>
</span><span id="__span-17-137">    <span class="n">create_heroes</span><span class="p">()</span>
</span><span id="__span-17-138">    <span class="n">select_heroes</span><span class="p">()</span>
</span><span id="__span-17-139">    <span class="n">update_heroes</span><span class="p">()</span>
</span><span id="__span-17-140">
</span><span id="__span-17-141">
</span><span id="__span-17-142"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-17-143">    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div>
</div>
</div>
</div>
</details>
<p>Up to this point, it's all good. 😊</p>
<p>In particular, the result of printing <code>preventers_team.heroes</code> is:</p>
<div class="highlight"><pre><span></span><code><span id="__span-18-1">Preventers Team Heroes: [
</span><span id="__span-18-2">        Hero(name=&#39;Rusty-Man&#39;, age=48, id=2, secret_name=&#39;Tommy Sharp&#39;, team_id=2),
</span><span id="__span-18-3"><span class="hll">        Hero(name=&#39;Spider-Boy&#39;, age=None, id=3, secret_name=&#39;Pedro Parqueador&#39;, team_id=2),
</span></span><span id="__span-18-4">        Hero(name=&#39;Tarantula&#39;, age=32, id=6, secret_name=&#39;Natalia Roman-on&#39;, team_id=2),
</span><span id="__span-18-5">        Hero(name=&#39;Dr. Weird&#39;, age=36, id=7, secret_name=&#39;Steve Weird&#39;, team_id=2),
</span><span id="__span-18-6">        Hero(name=&#39;Captain North America&#39;, age=93, id=8, secret_name=&#39;Esteban Rogelios&#39;, team_id=2)
</span><span id="__span-18-7">]
</span></code></pre></div>
<p>Notice that we have <strong>Spider-Boy</strong> there.</p>
<h2 id="update-objects-before-committing">Update Objects Before Committing<a class="headerlink" href="#update-objects-before-committing" title="Permanent link">&para;</a></h2>
<p>Now let's update <strong>Spider-Boy</strong>, removing him from the team by setting <code>hero_spider_boy.team = None</code> and then let's print this object again:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="7:3"><input checked="checked" id="__tabbed_7_1" name="__tabbed_7" type="radio" /><input id="__tabbed_7_2" name="__tabbed_7" type="radio" /><input id="__tabbed_7_3" name="__tabbed_7" type="radio" /><div class="tabbed-labels"><label for="__tabbed_7_1">Python 3.10+</label><label for="__tabbed_7_2">Python 3.9+</label><label for="__tabbed_7_3">Python 3.7+</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-19-1"><span class="c1"># Code above omitted 👆</span>
</span><span id="__span-19-2">
</span><span id="__span-19-3"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-19-4">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-19-5">
</span><span id="__span-19-6">        <span class="c1"># Code here omitted 👈</span>
</span><span id="__span-19-7">
</span><span id="__span-19-8"><span class="hll">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="kc">None</span>
</span></span><span id="__span-19-9">
</span><span id="__span-19-10">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy without team:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-19-11">
</span><span id="__span-19-12"><span class="hll">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes again:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span></span><span id="__span-19-13">
</span><span id="__span-19-14"><span class="c1"># Code below omitted 👇</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-20-1"><span class="c1"># Code above omitted 👆</span>
</span><span id="__span-20-2">
</span><span id="__span-20-3"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-20-4">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-20-5">
</span><span id="__span-20-6">        <span class="c1"># Code here omitted 👈</span>
</span><span id="__span-20-7">
</span><span id="__span-20-8"><span class="hll">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="kc">None</span>
</span></span><span id="__span-20-9">
</span><span id="__span-20-10">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy without team:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-20-11">
</span><span id="__span-20-12"><span class="hll">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes again:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span></span><span id="__span-20-13">
</span><span id="__span-20-14"><span class="c1"># Code below omitted 👇</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-21-1"><span class="c1"># Code above omitted 👆</span>
</span><span id="__span-21-2">
</span><span id="__span-21-3"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-21-4">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-21-5">
</span><span id="__span-21-6">        <span class="c1"># Code here omitted 👈</span>
</span><span id="__span-21-7">
</span><span id="__span-21-8"><span class="hll">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="kc">None</span>
</span></span><span id="__span-21-9">
</span><span id="__span-21-10">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy without team:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-21-11">
</span><span id="__span-21-12"><span class="hll">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes again:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span></span><span id="__span-21-13">
</span><span id="__span-21-14"><span class="c1"># Code below omitted 👇</span>
</span></code></pre></div>
</div>
</div>
</div>
<details>
<summary>👀 Full file preview</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="8:3"><input checked="checked" id="__tabbed_8_1" name="__tabbed_8" type="radio" /><input id="__tabbed_8_2" name="__tabbed_8" type="radio" /><input id="__tabbed_8_3" name="__tabbed_8" type="radio" /><div class="tabbed-labels"><label for="__tabbed_8_1">Python 3.10+</label><label for="__tabbed_8_2">Python 3.9+</label><label for="__tabbed_8_3">Python 3.7+</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-22-1"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">select</span>
</span><span id="__span-22-2">
</span><span id="__span-22-3">
</span><span id="__span-22-4"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-22-5">    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-22-6">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-22-7">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-22-8">
</span><span id="__span-22-9">    <span class="n">heroes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;Hero&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">()</span>
</span><span id="__span-22-10">
</span><span id="__span-22-11">
</span><span id="__span-22-12"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-22-13">    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-22-14">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-22-15">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-22-16">    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-22-17">
</span><span id="__span-22-18">    <span class="n">team_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">)</span>
</span><span id="__span-22-19">    <span class="n">team</span><span class="p">:</span> <span class="n">Team</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">()</span>
</span><span id="__span-22-20">
</span><span id="__span-22-21">
</span><span id="__span-22-22"><span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
</span><span id="__span-22-23"><span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-22-24">
</span><span id="__span-22-25"><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-22-26">
</span><span id="__span-22-27">
</span><span id="__span-22-28"><span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
</span><span id="__span-22-29">    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
</span><span id="__span-22-30">
</span><span id="__span-22-31">
</span><span id="__span-22-32"><span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
</span><span id="__span-22-33">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-22-34">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Preventers&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sharp Tower&quot;</span><span class="p">)</span>
</span><span id="__span-22-35">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Z-Force&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sister Margaret&#39;s Bar&quot;</span><span class="p">)</span>
</span><span id="__span-22-36">
</span><span id="__span-22-37">        <span class="n">hero_deadpond</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-22-38">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Dive Wilson&quot;</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span>
</span><span id="__span-22-39">        <span class="p">)</span>
</span><span id="__span-22-40">        <span class="n">hero_rusty_man</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-22-41">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span>
</span><span id="__span-22-42">        <span class="p">)</span>
</span><span id="__span-22-43">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
</span><span id="__span-22-44">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-22-45">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-22-46">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-22-47">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-22-48">
</span><span id="__span-22-49">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-22-50">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-22-51">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-22-52">
</span><span id="__span-22-53">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-22-54">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-22-55">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-22-56">
</span><span id="__span-22-57">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="n">team_preventers</span>
</span><span id="__span-22-58">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-22-59">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-22-60">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-22-61">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Updated hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-22-62">
</span><span id="__span-22-63">        <span class="n">hero_black_lion</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Black Lion&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Trevor Challa&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">35</span><span class="p">)</span>
</span><span id="__span-22-64">        <span class="n">hero_sure_e</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Princess Sure-E&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Sure-E&quot;</span><span class="p">)</span>
</span><span id="__span-22-65">        <span class="n">team_wakaland</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span>
</span><span id="__span-22-66">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Wakaland&quot;</span><span class="p">,</span>
</span><span id="__span-22-67">            <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Wakaland Capital City&quot;</span><span class="p">,</span>
</span><span id="__span-22-68">            <span class="n">heroes</span><span class="o">=</span><span class="p">[</span><span class="n">hero_black_lion</span><span class="p">,</span> <span class="n">hero_sure_e</span><span class="p">],</span>
</span><span id="__span-22-69">        <span class="p">)</span>
</span><span id="__span-22-70">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-22-71">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-22-72">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-22-73">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Team Wakaland:&quot;</span><span class="p">,</span> <span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-22-74">
</span><span id="__span-22-75">        <span class="n">hero_tarantula</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Tarantula&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Natalia Roman-on&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
</span><span id="__span-22-76">        <span class="n">hero_dr_weird</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Dr. Weird&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Steve Weird&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">36</span><span class="p">)</span>
</span><span id="__span-22-77">        <span class="n">hero_cap</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-22-78">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Captain North America&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Esteban Rogelios&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">93</span>
</span><span id="__span-22-79">        <span class="p">)</span>
</span><span id="__span-22-80">
</span><span id="__span-22-81">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-22-82">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-22-83">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-22-84">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_preventers</span><span class="p">)</span>
</span><span id="__span-22-85">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-22-86">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-22-87">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-22-88">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-22-89">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-22-90">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-22-91">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-22-92">
</span><span id="__span-22-93">
</span><span id="__span-22-94"><span class="k">def</span> <span class="nf">select_heroes</span><span class="p">():</span>
</span><span id="__span-22-95">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-22-96">        <span class="n">statement</span> <span class="o">=</span> <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-22-97">        <span class="n">result</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="n">statement</span><span class="p">)</span>
</span><span id="__span-22-98">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-22-99">
</span><span id="__span-22-100">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers heroes:&quot;</span><span class="p">,</span> <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-22-101">
</span><span id="__span-22-102">
</span><span id="__span-22-103"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-22-104">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-22-105">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-22-106">            <span class="n">select</span><span class="p">(</span><span class="n">Hero</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hero</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Spider-Boy&quot;</span><span class="p">)</span>
</span><span id="__span-22-107">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-22-108">
</span><span id="__span-22-109">        <span class="n">preventers_team</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-22-110">            <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-22-111">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-22-112">
</span><span id="__span-22-113">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hero Spider-Boy:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-22-114">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="p">)</span>
</span><span id="__span-22-115">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-22-116">
</span><span id="__span-22-117">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-22-118">
</span><span id="__span-22-119">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy without team:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-22-120">
</span><span id="__span-22-121">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes again:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-22-122">
</span><span id="__span-22-123">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-22-124">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-22-125">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After committing&quot;</span><span class="p">)</span>
</span><span id="__span-22-126">
</span><span id="__span-22-127">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-22-128">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy after commit:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-22-129">
</span><span id="__span-22-130">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes after commit:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-22-131">
</span><span id="__span-22-132">
</span><span id="__span-22-133"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span id="__span-22-134">    <span class="n">create_db_and_tables</span><span class="p">()</span>
</span><span id="__span-22-135">    <span class="n">create_heroes</span><span class="p">()</span>
</span><span id="__span-22-136">    <span class="n">select_heroes</span><span class="p">()</span>
</span><span id="__span-22-137">    <span class="n">update_heroes</span><span class="p">()</span>
</span><span id="__span-22-138">
</span><span id="__span-22-139">
</span><span id="__span-22-140"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-22-141">    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-23-1"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>
</span><span id="__span-23-2">
</span><span id="__span-23-3"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">select</span>
</span><span id="__span-23-4">
</span><span id="__span-23-5">
</span><span id="__span-23-6"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-23-7">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-23-8">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-23-9">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-23-10">
</span><span id="__span-23-11">    <span class="n">heroes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;Hero&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">()</span>
</span><span id="__span-23-12">
</span><span id="__span-23-13">
</span><span id="__span-23-14"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-23-15">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-23-16">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-23-17">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-23-18">    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-23-19">
</span><span id="__span-23-20">    <span class="n">team_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">)</span>
</span><span id="__span-23-21">    <span class="n">team</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Team</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">()</span>
</span><span id="__span-23-22">
</span><span id="__span-23-23">
</span><span id="__span-23-24"><span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
</span><span id="__span-23-25"><span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-23-26">
</span><span id="__span-23-27"><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-23-28">
</span><span id="__span-23-29">
</span><span id="__span-23-30"><span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
</span><span id="__span-23-31">    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
</span><span id="__span-23-32">
</span><span id="__span-23-33">
</span><span id="__span-23-34"><span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
</span><span id="__span-23-35">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-23-36">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Preventers&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sharp Tower&quot;</span><span class="p">)</span>
</span><span id="__span-23-37">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Z-Force&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sister Margaret&#39;s Bar&quot;</span><span class="p">)</span>
</span><span id="__span-23-38">
</span><span id="__span-23-39">        <span class="n">hero_deadpond</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-23-40">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Dive Wilson&quot;</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span>
</span><span id="__span-23-41">        <span class="p">)</span>
</span><span id="__span-23-42">        <span class="n">hero_rusty_man</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-23-43">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span>
</span><span id="__span-23-44">        <span class="p">)</span>
</span><span id="__span-23-45">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
</span><span id="__span-23-46">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-23-47">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-23-48">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-23-49">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-23-50">
</span><span id="__span-23-51">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-23-52">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-23-53">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-23-54">
</span><span id="__span-23-55">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-23-56">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-23-57">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-23-58">
</span><span id="__span-23-59">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="n">team_preventers</span>
</span><span id="__span-23-60">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-23-61">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-23-62">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-23-63">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Updated hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-23-64">
</span><span id="__span-23-65">        <span class="n">hero_black_lion</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Black Lion&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Trevor Challa&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">35</span><span class="p">)</span>
</span><span id="__span-23-66">        <span class="n">hero_sure_e</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Princess Sure-E&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Sure-E&quot;</span><span class="p">)</span>
</span><span id="__span-23-67">        <span class="n">team_wakaland</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span>
</span><span id="__span-23-68">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Wakaland&quot;</span><span class="p">,</span>
</span><span id="__span-23-69">            <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Wakaland Capital City&quot;</span><span class="p">,</span>
</span><span id="__span-23-70">            <span class="n">heroes</span><span class="o">=</span><span class="p">[</span><span class="n">hero_black_lion</span><span class="p">,</span> <span class="n">hero_sure_e</span><span class="p">],</span>
</span><span id="__span-23-71">        <span class="p">)</span>
</span><span id="__span-23-72">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-23-73">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-23-74">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-23-75">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Team Wakaland:&quot;</span><span class="p">,</span> <span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-23-76">
</span><span id="__span-23-77">        <span class="n">hero_tarantula</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Tarantula&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Natalia Roman-on&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
</span><span id="__span-23-78">        <span class="n">hero_dr_weird</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Dr. Weird&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Steve Weird&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">36</span><span class="p">)</span>
</span><span id="__span-23-79">        <span class="n">hero_cap</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-23-80">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Captain North America&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Esteban Rogelios&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">93</span>
</span><span id="__span-23-81">        <span class="p">)</span>
</span><span id="__span-23-82">
</span><span id="__span-23-83">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-23-84">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-23-85">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-23-86">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_preventers</span><span class="p">)</span>
</span><span id="__span-23-87">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-23-88">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-23-89">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-23-90">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-23-91">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-23-92">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-23-93">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-23-94">
</span><span id="__span-23-95">
</span><span id="__span-23-96"><span class="k">def</span> <span class="nf">select_heroes</span><span class="p">():</span>
</span><span id="__span-23-97">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-23-98">        <span class="n">statement</span> <span class="o">=</span> <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-23-99">        <span class="n">result</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="n">statement</span><span class="p">)</span>
</span><span id="__span-23-100">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-23-101">
</span><span id="__span-23-102">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers heroes:&quot;</span><span class="p">,</span> <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-23-103">
</span><span id="__span-23-104">
</span><span id="__span-23-105"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-23-106">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-23-107">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-23-108">            <span class="n">select</span><span class="p">(</span><span class="n">Hero</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hero</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Spider-Boy&quot;</span><span class="p">)</span>
</span><span id="__span-23-109">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-23-110">
</span><span id="__span-23-111">        <span class="n">preventers_team</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-23-112">            <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-23-113">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-23-114">
</span><span id="__span-23-115">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hero Spider-Boy:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-23-116">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="p">)</span>
</span><span id="__span-23-117">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-23-118">
</span><span id="__span-23-119">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-23-120">
</span><span id="__span-23-121">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy without team:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-23-122">
</span><span id="__span-23-123">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes again:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-23-124">
</span><span id="__span-23-125">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-23-126">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-23-127">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After committing&quot;</span><span class="p">)</span>
</span><span id="__span-23-128">
</span><span id="__span-23-129">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-23-130">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy after commit:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-23-131">
</span><span id="__span-23-132">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes after commit:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-23-133">
</span><span id="__span-23-134">
</span><span id="__span-23-135"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span id="__span-23-136">    <span class="n">create_db_and_tables</span><span class="p">()</span>
</span><span id="__span-23-137">    <span class="n">create_heroes</span><span class="p">()</span>
</span><span id="__span-23-138">    <span class="n">select_heroes</span><span class="p">()</span>
</span><span id="__span-23-139">    <span class="n">update_heroes</span><span class="p">()</span>
</span><span id="__span-23-140">
</span><span id="__span-23-141">
</span><span id="__span-23-142"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-23-143">    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-24-1"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span>
</span><span id="__span-24-2">
</span><span id="__span-24-3"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">select</span>
</span><span id="__span-24-4">
</span><span id="__span-24-5">
</span><span id="__span-24-6"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-24-7">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-24-8">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-24-9">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-24-10">
</span><span id="__span-24-11">    <span class="n">heroes</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="s2">&quot;Hero&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">()</span>
</span><span id="__span-24-12">
</span><span id="__span-24-13">
</span><span id="__span-24-14"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-24-15">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-24-16">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-24-17">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-24-18">    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-24-19">
</span><span id="__span-24-20">    <span class="n">team_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">)</span>
</span><span id="__span-24-21">    <span class="n">team</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Team</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">()</span>
</span><span id="__span-24-22">
</span><span id="__span-24-23">
</span><span id="__span-24-24"><span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
</span><span id="__span-24-25"><span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-24-26">
</span><span id="__span-24-27"><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-24-28">
</span><span id="__span-24-29">
</span><span id="__span-24-30"><span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
</span><span id="__span-24-31">    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
</span><span id="__span-24-32">
</span><span id="__span-24-33">
</span><span id="__span-24-34"><span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
</span><span id="__span-24-35">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-24-36">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Preventers&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sharp Tower&quot;</span><span class="p">)</span>
</span><span id="__span-24-37">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Z-Force&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sister Margaret&#39;s Bar&quot;</span><span class="p">)</span>
</span><span id="__span-24-38">
</span><span id="__span-24-39">        <span class="n">hero_deadpond</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-24-40">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Dive Wilson&quot;</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span>
</span><span id="__span-24-41">        <span class="p">)</span>
</span><span id="__span-24-42">        <span class="n">hero_rusty_man</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-24-43">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span>
</span><span id="__span-24-44">        <span class="p">)</span>
</span><span id="__span-24-45">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
</span><span id="__span-24-46">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-24-47">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-24-48">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-24-49">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-24-50">
</span><span id="__span-24-51">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-24-52">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-24-53">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-24-54">
</span><span id="__span-24-55">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-24-56">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-24-57">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-24-58">
</span><span id="__span-24-59">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="n">team_preventers</span>
</span><span id="__span-24-60">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-24-61">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-24-62">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-24-63">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Updated hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-24-64">
</span><span id="__span-24-65">        <span class="n">hero_black_lion</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Black Lion&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Trevor Challa&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">35</span><span class="p">)</span>
</span><span id="__span-24-66">        <span class="n">hero_sure_e</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Princess Sure-E&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Sure-E&quot;</span><span class="p">)</span>
</span><span id="__span-24-67">        <span class="n">team_wakaland</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span>
</span><span id="__span-24-68">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Wakaland&quot;</span><span class="p">,</span>
</span><span id="__span-24-69">            <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Wakaland Capital City&quot;</span><span class="p">,</span>
</span><span id="__span-24-70">            <span class="n">heroes</span><span class="o">=</span><span class="p">[</span><span class="n">hero_black_lion</span><span class="p">,</span> <span class="n">hero_sure_e</span><span class="p">],</span>
</span><span id="__span-24-71">        <span class="p">)</span>
</span><span id="__span-24-72">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-24-73">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-24-74">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-24-75">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Team Wakaland:&quot;</span><span class="p">,</span> <span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-24-76">
</span><span id="__span-24-77">        <span class="n">hero_tarantula</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Tarantula&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Natalia Roman-on&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
</span><span id="__span-24-78">        <span class="n">hero_dr_weird</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Dr. Weird&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Steve Weird&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">36</span><span class="p">)</span>
</span><span id="__span-24-79">        <span class="n">hero_cap</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-24-80">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Captain North America&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Esteban Rogelios&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">93</span>
</span><span id="__span-24-81">        <span class="p">)</span>
</span><span id="__span-24-82">
</span><span id="__span-24-83">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-24-84">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-24-85">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-24-86">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_preventers</span><span class="p">)</span>
</span><span id="__span-24-87">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-24-88">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-24-89">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-24-90">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-24-91">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-24-92">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-24-93">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-24-94">
</span><span id="__span-24-95">
</span><span id="__span-24-96"><span class="k">def</span> <span class="nf">select_heroes</span><span class="p">():</span>
</span><span id="__span-24-97">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-24-98">        <span class="n">statement</span> <span class="o">=</span> <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-24-99">        <span class="n">result</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="n">statement</span><span class="p">)</span>
</span><span id="__span-24-100">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-24-101">
</span><span id="__span-24-102">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers heroes:&quot;</span><span class="p">,</span> <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-24-103">
</span><span id="__span-24-104">
</span><span id="__span-24-105"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-24-106">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-24-107">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-24-108">            <span class="n">select</span><span class="p">(</span><span class="n">Hero</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hero</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Spider-Boy&quot;</span><span class="p">)</span>
</span><span id="__span-24-109">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-24-110">
</span><span id="__span-24-111">        <span class="n">preventers_team</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-24-112">            <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-24-113">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-24-114">
</span><span id="__span-24-115">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hero Spider-Boy:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-24-116">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="p">)</span>
</span><span id="__span-24-117">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-24-118">
</span><span id="__span-24-119">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-24-120">
</span><span id="__span-24-121">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy without team:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-24-122">
</span><span id="__span-24-123">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes again:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-24-124">
</span><span id="__span-24-125">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-24-126">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-24-127">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After committing&quot;</span><span class="p">)</span>
</span><span id="__span-24-128">
</span><span id="__span-24-129">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-24-130">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy after commit:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-24-131">
</span><span id="__span-24-132">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes after commit:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-24-133">
</span><span id="__span-24-134">
</span><span id="__span-24-135"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span id="__span-24-136">    <span class="n">create_db_and_tables</span><span class="p">()</span>
</span><span id="__span-24-137">    <span class="n">create_heroes</span><span class="p">()</span>
</span><span id="__span-24-138">    <span class="n">select_heroes</span><span class="p">()</span>
</span><span id="__span-24-139">    <span class="n">update_heroes</span><span class="p">()</span>
</span><span id="__span-24-140">
</span><span id="__span-24-141">
</span><span id="__span-24-142"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-24-143">    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div>
</div>
</div>
</div>
</details>
<p>The first important thing is, we <em>haven't committed</em> the hero yet, so accessing the list of heroes would not trigger an automatic refresh.</p>
<p>But in our code, in this exact point in time, we already said that <strong>Spider-Boy</strong> is no longer part of the <strong>Preventers</strong>. 🔥</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>We could revert that later by not committing the <strong>session</strong>, but that's not what we are interested in here.</p>
</div>
<p>Here, at this point in the code, in memory, the code expects <strong>Preventers</strong> to <em>not include</em> <strong>Spider-Boy</strong>.</p>
<p>The output of printing <code>hero_spider_boy</code> without team is:</p>
<div class="highlight"><pre><span></span><code><span id="__span-25-1">Spider-Boy without team: name=&#39;Spider-Boy&#39; age=None id=3 secret_name=&#39;Pedro Parqueador&#39; team_id=2 team=None
</span></code></pre></div>
<p>Cool, the team is set to <code>None</code>, the <code>team_id</code> attribute still has the team ID until we save it. But that's okay as we are now working mainly with the <strong>relationship attributes</strong> and the objects. ✅</p>
<p>But now, what happens when we print the <code>preventers_team.heroes</code>?</p>
<div class="highlight"><pre><span></span><code><span id="__span-26-1">Preventers Team Heroes again: [
</span><span id="__span-26-2">        Hero(name=&#39;Rusty-Man&#39;, age=48, id=2, secret_name=&#39;Tommy Sharp&#39;, team_id=2),
</span><span id="__span-26-3"><span class="hll">        Hero(name=&#39;Spider-Boy&#39;, age=None, id=3, secret_name=&#39;Pedro Parqueador&#39;, team_id=2, team=None),
</span></span><span id="__span-26-4">        Hero(name=&#39;Tarantula&#39;, age=32, id=6, secret_name=&#39;Natalia Roman-on&#39;, team_id=2),
</span><span id="__span-26-5">        Hero(name=&#39;Dr. Weird&#39;, age=36, id=7, secret_name=&#39;Steve Weird&#39;, team_id=2),
</span><span id="__span-26-6">        Hero(name=&#39;Captain North America&#39;, age=93, id=8, secret_name=&#39;Esteban Rogelios&#39;, team_id=2)
</span><span id="__span-26-7">]
</span></code></pre></div>
<p>Oh, no! 😱 <strong>Spider-Boy</strong> is still listed there!</p>
<h2 id="commit-and-print">Commit and Print<a class="headerlink" href="#commit-and-print" title="Permanent link">&para;</a></h2>
<p>Now, if we commit it and print again:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="9:3"><input checked="checked" id="__tabbed_9_1" name="__tabbed_9" type="radio" /><input id="__tabbed_9_2" name="__tabbed_9" type="radio" /><input id="__tabbed_9_3" name="__tabbed_9" type="radio" /><div class="tabbed-labels"><label for="__tabbed_9_1">Python 3.10+</label><label for="__tabbed_9_2">Python 3.9+</label><label for="__tabbed_9_3">Python 3.7+</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-27-1"><span class="c1"># Code above omitted 👆</span>
</span><span id="__span-27-2">
</span><span id="__span-27-3"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-27-4">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-27-5">
</span><span id="__span-27-6">        <span class="c1"># Code here omitted 👈</span>
</span><span id="__span-27-7">
</span><span id="__span-27-8"><span class="hll">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span></span><span id="__span-27-9"><span class="hll">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span></span><span id="__span-27-10">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After committing&quot;</span><span class="p">)</span>
</span><span id="__span-27-11">
</span><span id="__span-27-12">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-27-13">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy after commit:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-27-14">
</span><span id="__span-27-15"><span class="hll">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes after commit:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span></span><span id="__span-27-16">
</span><span id="__span-27-17"><span class="c1"># Code below omitted 👇</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-28-1"><span class="c1"># Code above omitted 👆</span>
</span><span id="__span-28-2">
</span><span id="__span-28-3"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-28-4">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-28-5">
</span><span id="__span-28-6">        <span class="c1"># Code here omitted 👈</span>
</span><span id="__span-28-7">
</span><span id="__span-28-8"><span class="hll">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span></span><span id="__span-28-9"><span class="hll">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span></span><span id="__span-28-10">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After committing&quot;</span><span class="p">)</span>
</span><span id="__span-28-11">
</span><span id="__span-28-12">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-28-13">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy after commit:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-28-14">
</span><span id="__span-28-15"><span class="hll">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes after commit:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span></span><span id="__span-28-16">
</span><span id="__span-28-17"><span class="c1"># Code below omitted 👇</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-29-1"><span class="c1"># Code above omitted 👆</span>
</span><span id="__span-29-2">
</span><span id="__span-29-3"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-29-4">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-29-5">
</span><span id="__span-29-6">        <span class="c1"># Code here omitted 👈</span>
</span><span id="__span-29-7">
</span><span id="__span-29-8"><span class="hll">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span></span><span id="__span-29-9"><span class="hll">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span></span><span id="__span-29-10">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After committing&quot;</span><span class="p">)</span>
</span><span id="__span-29-11">
</span><span id="__span-29-12">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-29-13">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy after commit:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-29-14">
</span><span id="__span-29-15"><span class="hll">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes after commit:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span></span><span id="__span-29-16">
</span><span id="__span-29-17"><span class="c1"># Code below omitted 👇</span>
</span></code></pre></div>
</div>
</div>
</div>
<details>
<summary>👀 Full file preview</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="10:3"><input checked="checked" id="__tabbed_10_1" name="__tabbed_10" type="radio" /><input id="__tabbed_10_2" name="__tabbed_10" type="radio" /><input id="__tabbed_10_3" name="__tabbed_10" type="radio" /><div class="tabbed-labels"><label for="__tabbed_10_1">Python 3.10+</label><label for="__tabbed_10_2">Python 3.9+</label><label for="__tabbed_10_3">Python 3.7+</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-30-1"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">select</span>
</span><span id="__span-30-2">
</span><span id="__span-30-3">
</span><span id="__span-30-4"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-30-5">    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-30-6">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-30-7">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-30-8">
</span><span id="__span-30-9">    <span class="n">heroes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;Hero&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">()</span>
</span><span id="__span-30-10">
</span><span id="__span-30-11">
</span><span id="__span-30-12"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-30-13">    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-30-14">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-30-15">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-30-16">    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-30-17">
</span><span id="__span-30-18">    <span class="n">team_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">)</span>
</span><span id="__span-30-19">    <span class="n">team</span><span class="p">:</span> <span class="n">Team</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">()</span>
</span><span id="__span-30-20">
</span><span id="__span-30-21">
</span><span id="__span-30-22"><span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
</span><span id="__span-30-23"><span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-30-24">
</span><span id="__span-30-25"><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-30-26">
</span><span id="__span-30-27">
</span><span id="__span-30-28"><span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
</span><span id="__span-30-29">    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
</span><span id="__span-30-30">
</span><span id="__span-30-31">
</span><span id="__span-30-32"><span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
</span><span id="__span-30-33">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-30-34">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Preventers&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sharp Tower&quot;</span><span class="p">)</span>
</span><span id="__span-30-35">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Z-Force&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sister Margaret&#39;s Bar&quot;</span><span class="p">)</span>
</span><span id="__span-30-36">
</span><span id="__span-30-37">        <span class="n">hero_deadpond</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-30-38">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Dive Wilson&quot;</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span>
</span><span id="__span-30-39">        <span class="p">)</span>
</span><span id="__span-30-40">        <span class="n">hero_rusty_man</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-30-41">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span>
</span><span id="__span-30-42">        <span class="p">)</span>
</span><span id="__span-30-43">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
</span><span id="__span-30-44">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-30-45">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-30-46">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-30-47">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-30-48">
</span><span id="__span-30-49">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-30-50">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-30-51">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-30-52">
</span><span id="__span-30-53">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-30-54">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-30-55">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-30-56">
</span><span id="__span-30-57">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="n">team_preventers</span>
</span><span id="__span-30-58">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-30-59">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-30-60">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-30-61">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Updated hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-30-62">
</span><span id="__span-30-63">        <span class="n">hero_black_lion</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Black Lion&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Trevor Challa&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">35</span><span class="p">)</span>
</span><span id="__span-30-64">        <span class="n">hero_sure_e</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Princess Sure-E&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Sure-E&quot;</span><span class="p">)</span>
</span><span id="__span-30-65">        <span class="n">team_wakaland</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span>
</span><span id="__span-30-66">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Wakaland&quot;</span><span class="p">,</span>
</span><span id="__span-30-67">            <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Wakaland Capital City&quot;</span><span class="p">,</span>
</span><span id="__span-30-68">            <span class="n">heroes</span><span class="o">=</span><span class="p">[</span><span class="n">hero_black_lion</span><span class="p">,</span> <span class="n">hero_sure_e</span><span class="p">],</span>
</span><span id="__span-30-69">        <span class="p">)</span>
</span><span id="__span-30-70">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-30-71">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-30-72">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-30-73">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Team Wakaland:&quot;</span><span class="p">,</span> <span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-30-74">
</span><span id="__span-30-75">        <span class="n">hero_tarantula</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Tarantula&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Natalia Roman-on&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
</span><span id="__span-30-76">        <span class="n">hero_dr_weird</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Dr. Weird&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Steve Weird&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">36</span><span class="p">)</span>
</span><span id="__span-30-77">        <span class="n">hero_cap</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-30-78">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Captain North America&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Esteban Rogelios&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">93</span>
</span><span id="__span-30-79">        <span class="p">)</span>
</span><span id="__span-30-80">
</span><span id="__span-30-81">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-30-82">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-30-83">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-30-84">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_preventers</span><span class="p">)</span>
</span><span id="__span-30-85">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-30-86">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-30-87">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-30-88">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-30-89">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-30-90">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-30-91">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-30-92">
</span><span id="__span-30-93">
</span><span id="__span-30-94"><span class="k">def</span> <span class="nf">select_heroes</span><span class="p">():</span>
</span><span id="__span-30-95">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-30-96">        <span class="n">statement</span> <span class="o">=</span> <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-30-97">        <span class="n">result</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="n">statement</span><span class="p">)</span>
</span><span id="__span-30-98">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-30-99">
</span><span id="__span-30-100">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers heroes:&quot;</span><span class="p">,</span> <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-30-101">
</span><span id="__span-30-102">
</span><span id="__span-30-103"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-30-104">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-30-105">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-30-106">            <span class="n">select</span><span class="p">(</span><span class="n">Hero</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hero</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Spider-Boy&quot;</span><span class="p">)</span>
</span><span id="__span-30-107">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-30-108">
</span><span id="__span-30-109">        <span class="n">preventers_team</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-30-110">            <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-30-111">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-30-112">
</span><span id="__span-30-113">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hero Spider-Boy:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-30-114">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="p">)</span>
</span><span id="__span-30-115">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-30-116">
</span><span id="__span-30-117">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-30-118">
</span><span id="__span-30-119">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy without team:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-30-120">
</span><span id="__span-30-121">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes again:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-30-122">
</span><span id="__span-30-123">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-30-124">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-30-125">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After committing&quot;</span><span class="p">)</span>
</span><span id="__span-30-126">
</span><span id="__span-30-127">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-30-128">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy after commit:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-30-129">
</span><span id="__span-30-130">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes after commit:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-30-131">
</span><span id="__span-30-132">
</span><span id="__span-30-133"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span id="__span-30-134">    <span class="n">create_db_and_tables</span><span class="p">()</span>
</span><span id="__span-30-135">    <span class="n">create_heroes</span><span class="p">()</span>
</span><span id="__span-30-136">    <span class="n">select_heroes</span><span class="p">()</span>
</span><span id="__span-30-137">    <span class="n">update_heroes</span><span class="p">()</span>
</span><span id="__span-30-138">
</span><span id="__span-30-139">
</span><span id="__span-30-140"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-30-141">    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-31-1"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>
</span><span id="__span-31-2">
</span><span id="__span-31-3"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">select</span>
</span><span id="__span-31-4">
</span><span id="__span-31-5">
</span><span id="__span-31-6"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-31-7">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-31-8">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-31-9">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-31-10">
</span><span id="__span-31-11">    <span class="n">heroes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;Hero&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">()</span>
</span><span id="__span-31-12">
</span><span id="__span-31-13">
</span><span id="__span-31-14"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-31-15">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-31-16">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-31-17">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-31-18">    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-31-19">
</span><span id="__span-31-20">    <span class="n">team_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">)</span>
</span><span id="__span-31-21">    <span class="n">team</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Team</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">()</span>
</span><span id="__span-31-22">
</span><span id="__span-31-23">
</span><span id="__span-31-24"><span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
</span><span id="__span-31-25"><span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-31-26">
</span><span id="__span-31-27"><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-31-28">
</span><span id="__span-31-29">
</span><span id="__span-31-30"><span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
</span><span id="__span-31-31">    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
</span><span id="__span-31-32">
</span><span id="__span-31-33">
</span><span id="__span-31-34"><span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
</span><span id="__span-31-35">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-31-36">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Preventers&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sharp Tower&quot;</span><span class="p">)</span>
</span><span id="__span-31-37">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Z-Force&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sister Margaret&#39;s Bar&quot;</span><span class="p">)</span>
</span><span id="__span-31-38">
</span><span id="__span-31-39">        <span class="n">hero_deadpond</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-31-40">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Dive Wilson&quot;</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span>
</span><span id="__span-31-41">        <span class="p">)</span>
</span><span id="__span-31-42">        <span class="n">hero_rusty_man</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-31-43">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span>
</span><span id="__span-31-44">        <span class="p">)</span>
</span><span id="__span-31-45">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
</span><span id="__span-31-46">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-31-47">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-31-48">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-31-49">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-31-50">
</span><span id="__span-31-51">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-31-52">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-31-53">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-31-54">
</span><span id="__span-31-55">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-31-56">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-31-57">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-31-58">
</span><span id="__span-31-59">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="n">team_preventers</span>
</span><span id="__span-31-60">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-31-61">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-31-62">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-31-63">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Updated hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-31-64">
</span><span id="__span-31-65">        <span class="n">hero_black_lion</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Black Lion&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Trevor Challa&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">35</span><span class="p">)</span>
</span><span id="__span-31-66">        <span class="n">hero_sure_e</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Princess Sure-E&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Sure-E&quot;</span><span class="p">)</span>
</span><span id="__span-31-67">        <span class="n">team_wakaland</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span>
</span><span id="__span-31-68">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Wakaland&quot;</span><span class="p">,</span>
</span><span id="__span-31-69">            <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Wakaland Capital City&quot;</span><span class="p">,</span>
</span><span id="__span-31-70">            <span class="n">heroes</span><span class="o">=</span><span class="p">[</span><span class="n">hero_black_lion</span><span class="p">,</span> <span class="n">hero_sure_e</span><span class="p">],</span>
</span><span id="__span-31-71">        <span class="p">)</span>
</span><span id="__span-31-72">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-31-73">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-31-74">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-31-75">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Team Wakaland:&quot;</span><span class="p">,</span> <span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-31-76">
</span><span id="__span-31-77">        <span class="n">hero_tarantula</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Tarantula&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Natalia Roman-on&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
</span><span id="__span-31-78">        <span class="n">hero_dr_weird</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Dr. Weird&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Steve Weird&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">36</span><span class="p">)</span>
</span><span id="__span-31-79">        <span class="n">hero_cap</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-31-80">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Captain North America&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Esteban Rogelios&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">93</span>
</span><span id="__span-31-81">        <span class="p">)</span>
</span><span id="__span-31-82">
</span><span id="__span-31-83">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-31-84">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-31-85">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-31-86">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_preventers</span><span class="p">)</span>
</span><span id="__span-31-87">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-31-88">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-31-89">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-31-90">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-31-91">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-31-92">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-31-93">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-31-94">
</span><span id="__span-31-95">
</span><span id="__span-31-96"><span class="k">def</span> <span class="nf">select_heroes</span><span class="p">():</span>
</span><span id="__span-31-97">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-31-98">        <span class="n">statement</span> <span class="o">=</span> <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-31-99">        <span class="n">result</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="n">statement</span><span class="p">)</span>
</span><span id="__span-31-100">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-31-101">
</span><span id="__span-31-102">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers heroes:&quot;</span><span class="p">,</span> <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-31-103">
</span><span id="__span-31-104">
</span><span id="__span-31-105"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-31-106">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-31-107">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-31-108">            <span class="n">select</span><span class="p">(</span><span class="n">Hero</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hero</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Spider-Boy&quot;</span><span class="p">)</span>
</span><span id="__span-31-109">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-31-110">
</span><span id="__span-31-111">        <span class="n">preventers_team</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-31-112">            <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-31-113">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-31-114">
</span><span id="__span-31-115">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hero Spider-Boy:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-31-116">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="p">)</span>
</span><span id="__span-31-117">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-31-118">
</span><span id="__span-31-119">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-31-120">
</span><span id="__span-31-121">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy without team:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-31-122">
</span><span id="__span-31-123">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes again:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-31-124">
</span><span id="__span-31-125">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-31-126">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-31-127">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After committing&quot;</span><span class="p">)</span>
</span><span id="__span-31-128">
</span><span id="__span-31-129">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-31-130">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy after commit:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-31-131">
</span><span id="__span-31-132">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes after commit:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-31-133">
</span><span id="__span-31-134">
</span><span id="__span-31-135"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span id="__span-31-136">    <span class="n">create_db_and_tables</span><span class="p">()</span>
</span><span id="__span-31-137">    <span class="n">create_heroes</span><span class="p">()</span>
</span><span id="__span-31-138">    <span class="n">select_heroes</span><span class="p">()</span>
</span><span id="__span-31-139">    <span class="n">update_heroes</span><span class="p">()</span>
</span><span id="__span-31-140">
</span><span id="__span-31-141">
</span><span id="__span-31-142"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-31-143">    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-32-1"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span>
</span><span id="__span-32-2">
</span><span id="__span-32-3"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">select</span>
</span><span id="__span-32-4">
</span><span id="__span-32-5">
</span><span id="__span-32-6"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-32-7">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-32-8">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-32-9">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-32-10">
</span><span id="__span-32-11">    <span class="n">heroes</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="s2">&quot;Hero&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">()</span>
</span><span id="__span-32-12">
</span><span id="__span-32-13">
</span><span id="__span-32-14"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-32-15">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-32-16">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-32-17">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-32-18">    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-32-19">
</span><span id="__span-32-20">    <span class="n">team_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">)</span>
</span><span id="__span-32-21">    <span class="n">team</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Team</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">()</span>
</span><span id="__span-32-22">
</span><span id="__span-32-23">
</span><span id="__span-32-24"><span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
</span><span id="__span-32-25"><span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-32-26">
</span><span id="__span-32-27"><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-32-28">
</span><span id="__span-32-29">
</span><span id="__span-32-30"><span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
</span><span id="__span-32-31">    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
</span><span id="__span-32-32">
</span><span id="__span-32-33">
</span><span id="__span-32-34"><span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
</span><span id="__span-32-35">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-32-36">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Preventers&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sharp Tower&quot;</span><span class="p">)</span>
</span><span id="__span-32-37">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Z-Force&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sister Margaret&#39;s Bar&quot;</span><span class="p">)</span>
</span><span id="__span-32-38">
</span><span id="__span-32-39">        <span class="n">hero_deadpond</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-32-40">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Dive Wilson&quot;</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span>
</span><span id="__span-32-41">        <span class="p">)</span>
</span><span id="__span-32-42">        <span class="n">hero_rusty_man</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-32-43">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span>
</span><span id="__span-32-44">        <span class="p">)</span>
</span><span id="__span-32-45">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
</span><span id="__span-32-46">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-32-47">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-32-48">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-32-49">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-32-50">
</span><span id="__span-32-51">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-32-52">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-32-53">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-32-54">
</span><span id="__span-32-55">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-32-56">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-32-57">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-32-58">
</span><span id="__span-32-59">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="n">team_preventers</span>
</span><span id="__span-32-60">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-32-61">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-32-62">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-32-63">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Updated hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-32-64">
</span><span id="__span-32-65">        <span class="n">hero_black_lion</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Black Lion&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Trevor Challa&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">35</span><span class="p">)</span>
</span><span id="__span-32-66">        <span class="n">hero_sure_e</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Princess Sure-E&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Sure-E&quot;</span><span class="p">)</span>
</span><span id="__span-32-67">        <span class="n">team_wakaland</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span>
</span><span id="__span-32-68">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Wakaland&quot;</span><span class="p">,</span>
</span><span id="__span-32-69">            <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Wakaland Capital City&quot;</span><span class="p">,</span>
</span><span id="__span-32-70">            <span class="n">heroes</span><span class="o">=</span><span class="p">[</span><span class="n">hero_black_lion</span><span class="p">,</span> <span class="n">hero_sure_e</span><span class="p">],</span>
</span><span id="__span-32-71">        <span class="p">)</span>
</span><span id="__span-32-72">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-32-73">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-32-74">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-32-75">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Team Wakaland:&quot;</span><span class="p">,</span> <span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-32-76">
</span><span id="__span-32-77">        <span class="n">hero_tarantula</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Tarantula&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Natalia Roman-on&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
</span><span id="__span-32-78">        <span class="n">hero_dr_weird</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Dr. Weird&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Steve Weird&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">36</span><span class="p">)</span>
</span><span id="__span-32-79">        <span class="n">hero_cap</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-32-80">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Captain North America&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Esteban Rogelios&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">93</span>
</span><span id="__span-32-81">        <span class="p">)</span>
</span><span id="__span-32-82">
</span><span id="__span-32-83">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-32-84">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-32-85">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-32-86">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_preventers</span><span class="p">)</span>
</span><span id="__span-32-87">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-32-88">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-32-89">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-32-90">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-32-91">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-32-92">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-32-93">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-32-94">
</span><span id="__span-32-95">
</span><span id="__span-32-96"><span class="k">def</span> <span class="nf">select_heroes</span><span class="p">():</span>
</span><span id="__span-32-97">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-32-98">        <span class="n">statement</span> <span class="o">=</span> <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-32-99">        <span class="n">result</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="n">statement</span><span class="p">)</span>
</span><span id="__span-32-100">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-32-101">
</span><span id="__span-32-102">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers heroes:&quot;</span><span class="p">,</span> <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-32-103">
</span><span id="__span-32-104">
</span><span id="__span-32-105"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-32-106">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-32-107">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-32-108">            <span class="n">select</span><span class="p">(</span><span class="n">Hero</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hero</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Spider-Boy&quot;</span><span class="p">)</span>
</span><span id="__span-32-109">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-32-110">
</span><span id="__span-32-111">        <span class="n">preventers_team</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-32-112">            <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-32-113">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-32-114">
</span><span id="__span-32-115">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hero Spider-Boy:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-32-116">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="p">)</span>
</span><span id="__span-32-117">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-32-118">
</span><span id="__span-32-119">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-32-120">
</span><span id="__span-32-121">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy without team:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-32-122">
</span><span id="__span-32-123">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes again:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-32-124">
</span><span id="__span-32-125">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-32-126">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-32-127">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After committing&quot;</span><span class="p">)</span>
</span><span id="__span-32-128">
</span><span id="__span-32-129">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-32-130">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy after commit:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-32-131">
</span><span id="__span-32-132">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes after commit:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-32-133">
</span><span id="__span-32-134">
</span><span id="__span-32-135"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span id="__span-32-136">    <span class="n">create_db_and_tables</span><span class="p">()</span>
</span><span id="__span-32-137">    <span class="n">create_heroes</span><span class="p">()</span>
</span><span id="__span-32-138">    <span class="n">select_heroes</span><span class="p">()</span>
</span><span id="__span-32-139">    <span class="n">update_heroes</span><span class="p">()</span>
</span><span id="__span-32-140">
</span><span id="__span-32-141">
</span><span id="__span-32-142"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-32-143">    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div>
</div>
</div>
</div>
</details>
<p>When we access <code>preventers_team.heroes</code> after the <code>commit</code>, that triggers a refresh, so we get the latest list, without <strong>Spider-Boy</strong>, so that's fine again:</p>
<div class="highlight"><pre><span></span><code><span id="__span-33-1">INFO Engine SELECT hero.id AS hero_id, hero.name AS hero_name, hero.secret_name AS hero_secret_name, hero.age AS hero_age, hero.team_id AS hero_team_id
</span><span id="__span-33-2">FROM hero
</span><span id="__span-33-3">WHERE ? = hero.team_id
</span><span id="__span-33-4">2021-08-13 11:15:24,658 INFO sqlalchemy.engine.Engine [cached since 0.1924s ago] (2,)
</span><span id="__span-33-5">
</span><span id="__span-33-6">Preventers Team Heroes after commit: [
</span><span id="__span-33-7">        Hero(name=&#39;Rusty-Man&#39;, age=48, id=2, secret_name=&#39;Tommy Sharp&#39;, team_id=2),
</span><span id="__span-33-8">        Hero(name=&#39;Tarantula&#39;, age=32, id=6, secret_name=&#39;Natalia Roman-on&#39;, team_id=2),
</span><span id="__span-33-9">        Hero(name=&#39;Dr. Weird&#39;, age=36, id=7, secret_name=&#39;Steve Weird&#39;, team_id=2),
</span><span id="__span-33-10">        Hero(name=&#39;Captain North America&#39;, age=93, id=8, secret_name=&#39;Esteban Rogelios&#39;, team_id=2)
</span><span id="__span-33-11">]
</span></code></pre></div>
<p>There's no <strong>Spider-Boy</strong> after committing, so that's good. 😊</p>
<p>But we still have that inconsistency in that previous point above.</p>
<p>If we use the objects before committing, we could end up having errors. 😔</p>
<p>Let's fix that. 🤓</p>
<h2 id="fix-it-using-back_populates">Fix It Using <code>back_populates</code><a class="headerlink" href="#fix-it-using-back_populates" title="Permanent link">&para;</a></h2>
<p>That's what <code>back_populates</code> is for. ✨</p>
<p>Let's add it back:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="11:3"><input checked="checked" id="__tabbed_11_1" name="__tabbed_11" type="radio" /><input id="__tabbed_11_2" name="__tabbed_11" type="radio" /><input id="__tabbed_11_3" name="__tabbed_11" type="radio" /><div class="tabbed-labels"><label for="__tabbed_11_1">Python 3.10+</label><label for="__tabbed_11_2">Python 3.9+</label><label for="__tabbed_11_3">Python 3.7+</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-34-1"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">select</span>
</span><span id="__span-34-2">
</span><span id="__span-34-3">
</span><span id="__span-34-4"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-34-5">    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-34-6">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-34-7">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-34-8">
</span><span id="__span-34-9"><span class="hll">    <span class="n">heroes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;Hero&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team&quot;</span><span class="p">)</span>
</span></span><span id="__span-34-10">
</span><span id="__span-34-11">
</span><span id="__span-34-12"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-34-13">    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-34-14">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-34-15">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-34-16">    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-34-17">
</span><span id="__span-34-18">    <span class="n">team_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">)</span>
</span><span id="__span-34-19"><span class="hll">    <span class="n">team</span><span class="p">:</span> <span class="n">Team</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;heroes&quot;</span><span class="p">)</span>
</span></span><span id="__span-34-20">
</span><span id="__span-34-21"><span class="c1"># Code below omitted 👇</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-35-1"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>
</span><span id="__span-35-2">
</span><span id="__span-35-3"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">select</span>
</span><span id="__span-35-4">
</span><span id="__span-35-5">
</span><span id="__span-35-6"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-35-7">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-35-8">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-35-9">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-35-10">
</span><span id="__span-35-11"><span class="hll">    <span class="n">heroes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;Hero&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team&quot;</span><span class="p">)</span>
</span></span><span id="__span-35-12">
</span><span id="__span-35-13">
</span><span id="__span-35-14"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-35-15">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-35-16">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-35-17">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-35-18">    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-35-19">
</span><span id="__span-35-20">    <span class="n">team_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">)</span>
</span><span id="__span-35-21"><span class="hll">    <span class="n">team</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Team</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;heroes&quot;</span><span class="p">)</span>
</span></span><span id="__span-35-22">
</span><span id="__span-35-23"><span class="c1"># Code below omitted 👇</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-36-1"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span>
</span><span id="__span-36-2">
</span><span id="__span-36-3"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">select</span>
</span><span id="__span-36-4">
</span><span id="__span-36-5">
</span><span id="__span-36-6"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-36-7">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-36-8">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-36-9">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-36-10">
</span><span id="__span-36-11"><span class="hll">    <span class="n">heroes</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="s2">&quot;Hero&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team&quot;</span><span class="p">)</span>
</span></span><span id="__span-36-12">
</span><span id="__span-36-13">
</span><span id="__span-36-14"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-36-15">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-36-16">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-36-17">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-36-18">    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-36-19">
</span><span id="__span-36-20">    <span class="n">team_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">)</span>
</span><span id="__span-36-21"><span class="hll">    <span class="n">team</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Team</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;heroes&quot;</span><span class="p">)</span>
</span></span><span id="__span-36-22">
</span><span id="__span-36-23"><span class="c1"># Code below omitted 👇</span>
</span></code></pre></div>
</div>
</div>
</div>
<details>
<summary>👀 Full file preview</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="12:3"><input checked="checked" id="__tabbed_12_1" name="__tabbed_12" type="radio" /><input id="__tabbed_12_2" name="__tabbed_12" type="radio" /><input id="__tabbed_12_3" name="__tabbed_12" type="radio" /><div class="tabbed-labels"><label for="__tabbed_12_1">Python 3.10+</label><label for="__tabbed_12_2">Python 3.9+</label><label for="__tabbed_12_3">Python 3.7+</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-37-1"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">select</span>
</span><span id="__span-37-2">
</span><span id="__span-37-3">
</span><span id="__span-37-4"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-37-5">    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-37-6">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-37-7">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-37-8">
</span><span id="__span-37-9">    <span class="n">heroes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;Hero&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team&quot;</span><span class="p">)</span>
</span><span id="__span-37-10">
</span><span id="__span-37-11">
</span><span id="__span-37-12"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-37-13">    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-37-14">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-37-15">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-37-16">    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-37-17">
</span><span id="__span-37-18">    <span class="n">team_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">)</span>
</span><span id="__span-37-19">    <span class="n">team</span><span class="p">:</span> <span class="n">Team</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;heroes&quot;</span><span class="p">)</span>
</span><span id="__span-37-20">
</span><span id="__span-37-21">
</span><span id="__span-37-22"><span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
</span><span id="__span-37-23"><span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-37-24">
</span><span id="__span-37-25"><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-37-26">
</span><span id="__span-37-27">
</span><span id="__span-37-28"><span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
</span><span id="__span-37-29">    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
</span><span id="__span-37-30">
</span><span id="__span-37-31">
</span><span id="__span-37-32"><span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
</span><span id="__span-37-33">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-37-34">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Preventers&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sharp Tower&quot;</span><span class="p">)</span>
</span><span id="__span-37-35">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Z-Force&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sister Margaret&#39;s Bar&quot;</span><span class="p">)</span>
</span><span id="__span-37-36">
</span><span id="__span-37-37">        <span class="n">hero_deadpond</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-37-38">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Dive Wilson&quot;</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span>
</span><span id="__span-37-39">        <span class="p">)</span>
</span><span id="__span-37-40">        <span class="n">hero_rusty_man</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-37-41">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span>
</span><span id="__span-37-42">        <span class="p">)</span>
</span><span id="__span-37-43">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
</span><span id="__span-37-44">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-37-45">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-37-46">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-37-47">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-37-48">
</span><span id="__span-37-49">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-37-50">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-37-51">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-37-52">
</span><span id="__span-37-53">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-37-54">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-37-55">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-37-56">
</span><span id="__span-37-57">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="n">team_preventers</span>
</span><span id="__span-37-58">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-37-59">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-37-60">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-37-61">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Updated hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-37-62">
</span><span id="__span-37-63">        <span class="n">hero_black_lion</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Black Lion&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Trevor Challa&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">35</span><span class="p">)</span>
</span><span id="__span-37-64">        <span class="n">hero_sure_e</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Princess Sure-E&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Sure-E&quot;</span><span class="p">)</span>
</span><span id="__span-37-65">        <span class="n">team_wakaland</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span>
</span><span id="__span-37-66">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Wakaland&quot;</span><span class="p">,</span>
</span><span id="__span-37-67">            <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Wakaland Capital City&quot;</span><span class="p">,</span>
</span><span id="__span-37-68">            <span class="n">heroes</span><span class="o">=</span><span class="p">[</span><span class="n">hero_black_lion</span><span class="p">,</span> <span class="n">hero_sure_e</span><span class="p">],</span>
</span><span id="__span-37-69">        <span class="p">)</span>
</span><span id="__span-37-70">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-37-71">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-37-72">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-37-73">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Team Wakaland:&quot;</span><span class="p">,</span> <span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-37-74">
</span><span id="__span-37-75">        <span class="n">hero_tarantula</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Tarantula&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Natalia Roman-on&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
</span><span id="__span-37-76">        <span class="n">hero_dr_weird</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Dr. Weird&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Steve Weird&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">36</span><span class="p">)</span>
</span><span id="__span-37-77">        <span class="n">hero_cap</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-37-78">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Captain North America&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Esteban Rogelios&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">93</span>
</span><span id="__span-37-79">        <span class="p">)</span>
</span><span id="__span-37-80">
</span><span id="__span-37-81">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-37-82">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-37-83">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-37-84">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_preventers</span><span class="p">)</span>
</span><span id="__span-37-85">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-37-86">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-37-87">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-37-88">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-37-89">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-37-90">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-37-91">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-37-92">
</span><span id="__span-37-93">
</span><span id="__span-37-94"><span class="k">def</span> <span class="nf">select_heroes</span><span class="p">():</span>
</span><span id="__span-37-95">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-37-96">        <span class="n">statement</span> <span class="o">=</span> <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-37-97">        <span class="n">result</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="n">statement</span><span class="p">)</span>
</span><span id="__span-37-98">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-37-99">
</span><span id="__span-37-100">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers heroes:&quot;</span><span class="p">,</span> <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-37-101">
</span><span id="__span-37-102">
</span><span id="__span-37-103"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-37-104">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-37-105">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-37-106">            <span class="n">select</span><span class="p">(</span><span class="n">Hero</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hero</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Spider-Boy&quot;</span><span class="p">)</span>
</span><span id="__span-37-107">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-37-108">
</span><span id="__span-37-109">        <span class="n">preventers_team</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-37-110">            <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-37-111">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-37-112">
</span><span id="__span-37-113">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hero Spider-Boy:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-37-114">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="p">)</span>
</span><span id="__span-37-115">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-37-116">
</span><span id="__span-37-117">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-37-118">
</span><span id="__span-37-119">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy without team:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-37-120">
</span><span id="__span-37-121">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes again:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-37-122">
</span><span id="__span-37-123">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-37-124">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-37-125">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After committing&quot;</span><span class="p">)</span>
</span><span id="__span-37-126">
</span><span id="__span-37-127">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-37-128">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy after commit:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-37-129">
</span><span id="__span-37-130">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes after commit:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-37-131">
</span><span id="__span-37-132">
</span><span id="__span-37-133"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span id="__span-37-134">    <span class="n">create_db_and_tables</span><span class="p">()</span>
</span><span id="__span-37-135">    <span class="n">create_heroes</span><span class="p">()</span>
</span><span id="__span-37-136">    <span class="n">select_heroes</span><span class="p">()</span>
</span><span id="__span-37-137">    <span class="n">update_heroes</span><span class="p">()</span>
</span><span id="__span-37-138">
</span><span id="__span-37-139">
</span><span id="__span-37-140"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-37-141">    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-38-1"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>
</span><span id="__span-38-2">
</span><span id="__span-38-3"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">select</span>
</span><span id="__span-38-4">
</span><span id="__span-38-5">
</span><span id="__span-38-6"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-38-7">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-38-8">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-38-9">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-38-10">
</span><span id="__span-38-11">    <span class="n">heroes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;Hero&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team&quot;</span><span class="p">)</span>
</span><span id="__span-38-12">
</span><span id="__span-38-13">
</span><span id="__span-38-14"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-38-15">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-38-16">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-38-17">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-38-18">    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-38-19">
</span><span id="__span-38-20">    <span class="n">team_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">)</span>
</span><span id="__span-38-21">    <span class="n">team</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Team</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;heroes&quot;</span><span class="p">)</span>
</span><span id="__span-38-22">
</span><span id="__span-38-23">
</span><span id="__span-38-24"><span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
</span><span id="__span-38-25"><span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-38-26">
</span><span id="__span-38-27"><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-38-28">
</span><span id="__span-38-29">
</span><span id="__span-38-30"><span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
</span><span id="__span-38-31">    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
</span><span id="__span-38-32">
</span><span id="__span-38-33">
</span><span id="__span-38-34"><span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
</span><span id="__span-38-35">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-38-36">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Preventers&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sharp Tower&quot;</span><span class="p">)</span>
</span><span id="__span-38-37">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Z-Force&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sister Margaret&#39;s Bar&quot;</span><span class="p">)</span>
</span><span id="__span-38-38">
</span><span id="__span-38-39">        <span class="n">hero_deadpond</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-38-40">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Dive Wilson&quot;</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span>
</span><span id="__span-38-41">        <span class="p">)</span>
</span><span id="__span-38-42">        <span class="n">hero_rusty_man</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-38-43">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span>
</span><span id="__span-38-44">        <span class="p">)</span>
</span><span id="__span-38-45">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
</span><span id="__span-38-46">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-38-47">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-38-48">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-38-49">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-38-50">
</span><span id="__span-38-51">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-38-52">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-38-53">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-38-54">
</span><span id="__span-38-55">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-38-56">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-38-57">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-38-58">
</span><span id="__span-38-59">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="n">team_preventers</span>
</span><span id="__span-38-60">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-38-61">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-38-62">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-38-63">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Updated hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-38-64">
</span><span id="__span-38-65">        <span class="n">hero_black_lion</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Black Lion&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Trevor Challa&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">35</span><span class="p">)</span>
</span><span id="__span-38-66">        <span class="n">hero_sure_e</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Princess Sure-E&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Sure-E&quot;</span><span class="p">)</span>
</span><span id="__span-38-67">        <span class="n">team_wakaland</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span>
</span><span id="__span-38-68">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Wakaland&quot;</span><span class="p">,</span>
</span><span id="__span-38-69">            <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Wakaland Capital City&quot;</span><span class="p">,</span>
</span><span id="__span-38-70">            <span class="n">heroes</span><span class="o">=</span><span class="p">[</span><span class="n">hero_black_lion</span><span class="p">,</span> <span class="n">hero_sure_e</span><span class="p">],</span>
</span><span id="__span-38-71">        <span class="p">)</span>
</span><span id="__span-38-72">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-38-73">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-38-74">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-38-75">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Team Wakaland:&quot;</span><span class="p">,</span> <span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-38-76">
</span><span id="__span-38-77">        <span class="n">hero_tarantula</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Tarantula&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Natalia Roman-on&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
</span><span id="__span-38-78">        <span class="n">hero_dr_weird</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Dr. Weird&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Steve Weird&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">36</span><span class="p">)</span>
</span><span id="__span-38-79">        <span class="n">hero_cap</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-38-80">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Captain North America&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Esteban Rogelios&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">93</span>
</span><span id="__span-38-81">        <span class="p">)</span>
</span><span id="__span-38-82">
</span><span id="__span-38-83">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-38-84">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-38-85">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-38-86">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_preventers</span><span class="p">)</span>
</span><span id="__span-38-87">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-38-88">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-38-89">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-38-90">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-38-91">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-38-92">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-38-93">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-38-94">
</span><span id="__span-38-95">
</span><span id="__span-38-96"><span class="k">def</span> <span class="nf">select_heroes</span><span class="p">():</span>
</span><span id="__span-38-97">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-38-98">        <span class="n">statement</span> <span class="o">=</span> <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-38-99">        <span class="n">result</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="n">statement</span><span class="p">)</span>
</span><span id="__span-38-100">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-38-101">
</span><span id="__span-38-102">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers heroes:&quot;</span><span class="p">,</span> <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-38-103">
</span><span id="__span-38-104">
</span><span id="__span-38-105"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-38-106">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-38-107">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-38-108">            <span class="n">select</span><span class="p">(</span><span class="n">Hero</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hero</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Spider-Boy&quot;</span><span class="p">)</span>
</span><span id="__span-38-109">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-38-110">
</span><span id="__span-38-111">        <span class="n">preventers_team</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-38-112">            <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-38-113">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-38-114">
</span><span id="__span-38-115">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hero Spider-Boy:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-38-116">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="p">)</span>
</span><span id="__span-38-117">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-38-118">
</span><span id="__span-38-119">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-38-120">
</span><span id="__span-38-121">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy without team:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-38-122">
</span><span id="__span-38-123">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes again:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-38-124">
</span><span id="__span-38-125">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-38-126">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-38-127">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After committing&quot;</span><span class="p">)</span>
</span><span id="__span-38-128">
</span><span id="__span-38-129">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-38-130">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy after commit:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-38-131">
</span><span id="__span-38-132">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes after commit:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-38-133">
</span><span id="__span-38-134">
</span><span id="__span-38-135"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span id="__span-38-136">    <span class="n">create_db_and_tables</span><span class="p">()</span>
</span><span id="__span-38-137">    <span class="n">create_heroes</span><span class="p">()</span>
</span><span id="__span-38-138">    <span class="n">select_heroes</span><span class="p">()</span>
</span><span id="__span-38-139">    <span class="n">update_heroes</span><span class="p">()</span>
</span><span id="__span-38-140">
</span><span id="__span-38-141">
</span><span id="__span-38-142"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-38-143">    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-39-1"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span>
</span><span id="__span-39-2">
</span><span id="__span-39-3"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">select</span>
</span><span id="__span-39-4">
</span><span id="__span-39-5">
</span><span id="__span-39-6"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-39-7">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-39-8">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-39-9">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-39-10">
</span><span id="__span-39-11">    <span class="n">heroes</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="s2">&quot;Hero&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team&quot;</span><span class="p">)</span>
</span><span id="__span-39-12">
</span><span id="__span-39-13">
</span><span id="__span-39-14"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-39-15">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-39-16">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-39-17">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-39-18">    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-39-19">
</span><span id="__span-39-20">    <span class="n">team_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">)</span>
</span><span id="__span-39-21">    <span class="n">team</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Team</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;heroes&quot;</span><span class="p">)</span>
</span><span id="__span-39-22">
</span><span id="__span-39-23">
</span><span id="__span-39-24"><span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
</span><span id="__span-39-25"><span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-39-26">
</span><span id="__span-39-27"><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-39-28">
</span><span id="__span-39-29">
</span><span id="__span-39-30"><span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
</span><span id="__span-39-31">    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
</span><span id="__span-39-32">
</span><span id="__span-39-33">
</span><span id="__span-39-34"><span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
</span><span id="__span-39-35">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-39-36">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Preventers&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sharp Tower&quot;</span><span class="p">)</span>
</span><span id="__span-39-37">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Z-Force&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sister Margaret&#39;s Bar&quot;</span><span class="p">)</span>
</span><span id="__span-39-38">
</span><span id="__span-39-39">        <span class="n">hero_deadpond</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-39-40">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Dive Wilson&quot;</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span>
</span><span id="__span-39-41">        <span class="p">)</span>
</span><span id="__span-39-42">        <span class="n">hero_rusty_man</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-39-43">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span>
</span><span id="__span-39-44">        <span class="p">)</span>
</span><span id="__span-39-45">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
</span><span id="__span-39-46">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-39-47">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-39-48">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-39-49">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-39-50">
</span><span id="__span-39-51">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-39-52">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-39-53">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-39-54">
</span><span id="__span-39-55">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-39-56">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-39-57">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-39-58">
</span><span id="__span-39-59">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="n">team_preventers</span>
</span><span id="__span-39-60">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-39-61">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-39-62">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-39-63">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Updated hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-39-64">
</span><span id="__span-39-65">        <span class="n">hero_black_lion</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Black Lion&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Trevor Challa&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">35</span><span class="p">)</span>
</span><span id="__span-39-66">        <span class="n">hero_sure_e</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Princess Sure-E&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Sure-E&quot;</span><span class="p">)</span>
</span><span id="__span-39-67">        <span class="n">team_wakaland</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span>
</span><span id="__span-39-68">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Wakaland&quot;</span><span class="p">,</span>
</span><span id="__span-39-69">            <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Wakaland Capital City&quot;</span><span class="p">,</span>
</span><span id="__span-39-70">            <span class="n">heroes</span><span class="o">=</span><span class="p">[</span><span class="n">hero_black_lion</span><span class="p">,</span> <span class="n">hero_sure_e</span><span class="p">],</span>
</span><span id="__span-39-71">        <span class="p">)</span>
</span><span id="__span-39-72">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-39-73">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-39-74">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-39-75">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Team Wakaland:&quot;</span><span class="p">,</span> <span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-39-76">
</span><span id="__span-39-77">        <span class="n">hero_tarantula</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Tarantula&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Natalia Roman-on&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
</span><span id="__span-39-78">        <span class="n">hero_dr_weird</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Dr. Weird&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Steve Weird&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">36</span><span class="p">)</span>
</span><span id="__span-39-79">        <span class="n">hero_cap</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-39-80">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Captain North America&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Esteban Rogelios&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">93</span>
</span><span id="__span-39-81">        <span class="p">)</span>
</span><span id="__span-39-82">
</span><span id="__span-39-83">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-39-84">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-39-85">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-39-86">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_preventers</span><span class="p">)</span>
</span><span id="__span-39-87">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-39-88">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-39-89">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-39-90">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-39-91">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-39-92">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-39-93">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-39-94">
</span><span id="__span-39-95">
</span><span id="__span-39-96"><span class="k">def</span> <span class="nf">select_heroes</span><span class="p">():</span>
</span><span id="__span-39-97">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-39-98">        <span class="n">statement</span> <span class="o">=</span> <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-39-99">        <span class="n">result</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="n">statement</span><span class="p">)</span>
</span><span id="__span-39-100">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-39-101">
</span><span id="__span-39-102">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers heroes:&quot;</span><span class="p">,</span> <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-39-103">
</span><span id="__span-39-104">
</span><span id="__span-39-105"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-39-106">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-39-107">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-39-108">            <span class="n">select</span><span class="p">(</span><span class="n">Hero</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hero</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Spider-Boy&quot;</span><span class="p">)</span>
</span><span id="__span-39-109">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-39-110">
</span><span id="__span-39-111">        <span class="n">preventers_team</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-39-112">            <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-39-113">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-39-114">
</span><span id="__span-39-115">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hero Spider-Boy:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-39-116">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="p">)</span>
</span><span id="__span-39-117">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-39-118">
</span><span id="__span-39-119">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-39-120">
</span><span id="__span-39-121">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy without team:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-39-122">
</span><span id="__span-39-123">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes again:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-39-124">
</span><span id="__span-39-125">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-39-126">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-39-127">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After committing&quot;</span><span class="p">)</span>
</span><span id="__span-39-128">
</span><span id="__span-39-129">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-39-130">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy after commit:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-39-131">
</span><span id="__span-39-132">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes after commit:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-39-133">
</span><span id="__span-39-134">
</span><span id="__span-39-135"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span id="__span-39-136">    <span class="n">create_db_and_tables</span><span class="p">()</span>
</span><span id="__span-39-137">    <span class="n">create_heroes</span><span class="p">()</span>
</span><span id="__span-39-138">    <span class="n">select_heroes</span><span class="p">()</span>
</span><span id="__span-39-139">    <span class="n">update_heroes</span><span class="p">()</span>
</span><span id="__span-39-140">
</span><span id="__span-39-141">
</span><span id="__span-39-142"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-39-143">    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div>
</div>
</div>
</div>
</details>
<p>And we can keep the rest of the code the same:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="13:3"><input checked="checked" id="__tabbed_13_1" name="__tabbed_13" type="radio" /><input id="__tabbed_13_2" name="__tabbed_13" type="radio" /><input id="__tabbed_13_3" name="__tabbed_13" type="radio" /><div class="tabbed-labels"><label for="__tabbed_13_1">Python 3.10+</label><label for="__tabbed_13_2">Python 3.9+</label><label for="__tabbed_13_3">Python 3.7+</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-40-1"><span class="c1"># Code above omitted 👆</span>
</span><span id="__span-40-2">
</span><span id="__span-40-3"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-40-4">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-40-5">
</span><span id="__span-40-6">        <span class="c1"># Code here omitted 👈</span>
</span><span id="__span-40-7">
</span><span id="__span-40-8"><span class="hll">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="kc">None</span>
</span></span><span id="__span-40-9">
</span><span id="__span-40-10">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy without team:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-40-11">
</span><span id="__span-40-12"><span class="hll">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes again:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span></span><span id="__span-40-13">
</span><span id="__span-40-14"><span class="c1"># Code below omitted 👇</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-41-1"><span class="c1"># Code above omitted 👆</span>
</span><span id="__span-41-2">
</span><span id="__span-41-3"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-41-4">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-41-5">
</span><span id="__span-41-6">        <span class="c1"># Code here omitted 👈</span>
</span><span id="__span-41-7">
</span><span id="__span-41-8"><span class="hll">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="kc">None</span>
</span></span><span id="__span-41-9">
</span><span id="__span-41-10">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy without team:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-41-11">
</span><span id="__span-41-12"><span class="hll">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes again:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span></span><span id="__span-41-13">
</span><span id="__span-41-14"><span class="c1"># Code below omitted 👇</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-42-1"><span class="c1"># Code above omitted 👆</span>
</span><span id="__span-42-2">
</span><span id="__span-42-3"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-42-4">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-42-5">
</span><span id="__span-42-6">        <span class="c1"># Code here omitted 👈</span>
</span><span id="__span-42-7">
</span><span id="__span-42-8"><span class="hll">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="kc">None</span>
</span></span><span id="__span-42-9">
</span><span id="__span-42-10">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy without team:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-42-11">
</span><span id="__span-42-12"><span class="hll">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes again:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span></span><span id="__span-42-13">
</span><span id="__span-42-14"><span class="c1"># Code below omitted 👇</span>
</span></code></pre></div>
</div>
</div>
</div>
<details>
<summary>👀 Full file preview</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="14:3"><input checked="checked" id="__tabbed_14_1" name="__tabbed_14" type="radio" /><input id="__tabbed_14_2" name="__tabbed_14" type="radio" /><input id="__tabbed_14_3" name="__tabbed_14" type="radio" /><div class="tabbed-labels"><label for="__tabbed_14_1">Python 3.10+</label><label for="__tabbed_14_2">Python 3.9+</label><label for="__tabbed_14_3">Python 3.7+</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-43-1"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">select</span>
</span><span id="__span-43-2">
</span><span id="__span-43-3">
</span><span id="__span-43-4"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-43-5">    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-43-6">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-43-7">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-43-8">
</span><span id="__span-43-9">    <span class="n">heroes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;Hero&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team&quot;</span><span class="p">)</span>
</span><span id="__span-43-10">
</span><span id="__span-43-11">
</span><span id="__span-43-12"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-43-13">    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-43-14">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-43-15">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-43-16">    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-43-17">
</span><span id="__span-43-18">    <span class="n">team_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">)</span>
</span><span id="__span-43-19">    <span class="n">team</span><span class="p">:</span> <span class="n">Team</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;heroes&quot;</span><span class="p">)</span>
</span><span id="__span-43-20">
</span><span id="__span-43-21">
</span><span id="__span-43-22"><span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
</span><span id="__span-43-23"><span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-43-24">
</span><span id="__span-43-25"><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-43-26">
</span><span id="__span-43-27">
</span><span id="__span-43-28"><span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
</span><span id="__span-43-29">    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
</span><span id="__span-43-30">
</span><span id="__span-43-31">
</span><span id="__span-43-32"><span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
</span><span id="__span-43-33">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-43-34">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Preventers&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sharp Tower&quot;</span><span class="p">)</span>
</span><span id="__span-43-35">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Z-Force&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sister Margaret&#39;s Bar&quot;</span><span class="p">)</span>
</span><span id="__span-43-36">
</span><span id="__span-43-37">        <span class="n">hero_deadpond</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-43-38">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Dive Wilson&quot;</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span>
</span><span id="__span-43-39">        <span class="p">)</span>
</span><span id="__span-43-40">        <span class="n">hero_rusty_man</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-43-41">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span>
</span><span id="__span-43-42">        <span class="p">)</span>
</span><span id="__span-43-43">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
</span><span id="__span-43-44">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-43-45">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-43-46">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-43-47">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-43-48">
</span><span id="__span-43-49">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-43-50">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-43-51">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-43-52">
</span><span id="__span-43-53">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-43-54">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-43-55">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-43-56">
</span><span id="__span-43-57">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="n">team_preventers</span>
</span><span id="__span-43-58">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-43-59">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-43-60">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-43-61">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Updated hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-43-62">
</span><span id="__span-43-63">        <span class="n">hero_black_lion</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Black Lion&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Trevor Challa&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">35</span><span class="p">)</span>
</span><span id="__span-43-64">        <span class="n">hero_sure_e</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Princess Sure-E&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Sure-E&quot;</span><span class="p">)</span>
</span><span id="__span-43-65">        <span class="n">team_wakaland</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span>
</span><span id="__span-43-66">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Wakaland&quot;</span><span class="p">,</span>
</span><span id="__span-43-67">            <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Wakaland Capital City&quot;</span><span class="p">,</span>
</span><span id="__span-43-68">            <span class="n">heroes</span><span class="o">=</span><span class="p">[</span><span class="n">hero_black_lion</span><span class="p">,</span> <span class="n">hero_sure_e</span><span class="p">],</span>
</span><span id="__span-43-69">        <span class="p">)</span>
</span><span id="__span-43-70">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-43-71">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-43-72">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-43-73">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Team Wakaland:&quot;</span><span class="p">,</span> <span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-43-74">
</span><span id="__span-43-75">        <span class="n">hero_tarantula</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Tarantula&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Natalia Roman-on&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
</span><span id="__span-43-76">        <span class="n">hero_dr_weird</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Dr. Weird&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Steve Weird&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">36</span><span class="p">)</span>
</span><span id="__span-43-77">        <span class="n">hero_cap</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-43-78">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Captain North America&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Esteban Rogelios&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">93</span>
</span><span id="__span-43-79">        <span class="p">)</span>
</span><span id="__span-43-80">
</span><span id="__span-43-81">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-43-82">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-43-83">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-43-84">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_preventers</span><span class="p">)</span>
</span><span id="__span-43-85">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-43-86">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-43-87">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-43-88">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-43-89">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-43-90">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-43-91">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-43-92">
</span><span id="__span-43-93">
</span><span id="__span-43-94"><span class="k">def</span> <span class="nf">select_heroes</span><span class="p">():</span>
</span><span id="__span-43-95">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-43-96">        <span class="n">statement</span> <span class="o">=</span> <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-43-97">        <span class="n">result</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="n">statement</span><span class="p">)</span>
</span><span id="__span-43-98">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-43-99">
</span><span id="__span-43-100">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers heroes:&quot;</span><span class="p">,</span> <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-43-101">
</span><span id="__span-43-102">
</span><span id="__span-43-103"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-43-104">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-43-105">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-43-106">            <span class="n">select</span><span class="p">(</span><span class="n">Hero</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hero</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Spider-Boy&quot;</span><span class="p">)</span>
</span><span id="__span-43-107">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-43-108">
</span><span id="__span-43-109">        <span class="n">preventers_team</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-43-110">            <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-43-111">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-43-112">
</span><span id="__span-43-113">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hero Spider-Boy:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-43-114">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="p">)</span>
</span><span id="__span-43-115">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-43-116">
</span><span id="__span-43-117">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-43-118">
</span><span id="__span-43-119">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy without team:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-43-120">
</span><span id="__span-43-121">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes again:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-43-122">
</span><span id="__span-43-123">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-43-124">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-43-125">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After committing&quot;</span><span class="p">)</span>
</span><span id="__span-43-126">
</span><span id="__span-43-127">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-43-128">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy after commit:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-43-129">
</span><span id="__span-43-130">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes after commit:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-43-131">
</span><span id="__span-43-132">
</span><span id="__span-43-133"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span id="__span-43-134">    <span class="n">create_db_and_tables</span><span class="p">()</span>
</span><span id="__span-43-135">    <span class="n">create_heroes</span><span class="p">()</span>
</span><span id="__span-43-136">    <span class="n">select_heroes</span><span class="p">()</span>
</span><span id="__span-43-137">    <span class="n">update_heroes</span><span class="p">()</span>
</span><span id="__span-43-138">
</span><span id="__span-43-139">
</span><span id="__span-43-140"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-43-141">    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-44-1"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>
</span><span id="__span-44-2">
</span><span id="__span-44-3"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">select</span>
</span><span id="__span-44-4">
</span><span id="__span-44-5">
</span><span id="__span-44-6"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-44-7">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-44-8">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-44-9">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-44-10">
</span><span id="__span-44-11">    <span class="n">heroes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;Hero&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team&quot;</span><span class="p">)</span>
</span><span id="__span-44-12">
</span><span id="__span-44-13">
</span><span id="__span-44-14"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-44-15">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-44-16">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-44-17">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-44-18">    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-44-19">
</span><span id="__span-44-20">    <span class="n">team_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">)</span>
</span><span id="__span-44-21">    <span class="n">team</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Team</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;heroes&quot;</span><span class="p">)</span>
</span><span id="__span-44-22">
</span><span id="__span-44-23">
</span><span id="__span-44-24"><span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
</span><span id="__span-44-25"><span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-44-26">
</span><span id="__span-44-27"><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-44-28">
</span><span id="__span-44-29">
</span><span id="__span-44-30"><span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
</span><span id="__span-44-31">    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
</span><span id="__span-44-32">
</span><span id="__span-44-33">
</span><span id="__span-44-34"><span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
</span><span id="__span-44-35">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-44-36">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Preventers&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sharp Tower&quot;</span><span class="p">)</span>
</span><span id="__span-44-37">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Z-Force&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sister Margaret&#39;s Bar&quot;</span><span class="p">)</span>
</span><span id="__span-44-38">
</span><span id="__span-44-39">        <span class="n">hero_deadpond</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-44-40">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Dive Wilson&quot;</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span>
</span><span id="__span-44-41">        <span class="p">)</span>
</span><span id="__span-44-42">        <span class="n">hero_rusty_man</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-44-43">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span>
</span><span id="__span-44-44">        <span class="p">)</span>
</span><span id="__span-44-45">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
</span><span id="__span-44-46">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-44-47">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-44-48">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-44-49">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-44-50">
</span><span id="__span-44-51">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-44-52">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-44-53">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-44-54">
</span><span id="__span-44-55">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-44-56">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-44-57">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-44-58">
</span><span id="__span-44-59">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="n">team_preventers</span>
</span><span id="__span-44-60">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-44-61">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-44-62">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-44-63">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Updated hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-44-64">
</span><span id="__span-44-65">        <span class="n">hero_black_lion</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Black Lion&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Trevor Challa&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">35</span><span class="p">)</span>
</span><span id="__span-44-66">        <span class="n">hero_sure_e</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Princess Sure-E&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Sure-E&quot;</span><span class="p">)</span>
</span><span id="__span-44-67">        <span class="n">team_wakaland</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span>
</span><span id="__span-44-68">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Wakaland&quot;</span><span class="p">,</span>
</span><span id="__span-44-69">            <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Wakaland Capital City&quot;</span><span class="p">,</span>
</span><span id="__span-44-70">            <span class="n">heroes</span><span class="o">=</span><span class="p">[</span><span class="n">hero_black_lion</span><span class="p">,</span> <span class="n">hero_sure_e</span><span class="p">],</span>
</span><span id="__span-44-71">        <span class="p">)</span>
</span><span id="__span-44-72">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-44-73">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-44-74">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-44-75">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Team Wakaland:&quot;</span><span class="p">,</span> <span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-44-76">
</span><span id="__span-44-77">        <span class="n">hero_tarantula</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Tarantula&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Natalia Roman-on&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
</span><span id="__span-44-78">        <span class="n">hero_dr_weird</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Dr. Weird&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Steve Weird&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">36</span><span class="p">)</span>
</span><span id="__span-44-79">        <span class="n">hero_cap</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-44-80">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Captain North America&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Esteban Rogelios&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">93</span>
</span><span id="__span-44-81">        <span class="p">)</span>
</span><span id="__span-44-82">
</span><span id="__span-44-83">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-44-84">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-44-85">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-44-86">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_preventers</span><span class="p">)</span>
</span><span id="__span-44-87">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-44-88">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-44-89">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-44-90">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-44-91">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-44-92">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-44-93">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-44-94">
</span><span id="__span-44-95">
</span><span id="__span-44-96"><span class="k">def</span> <span class="nf">select_heroes</span><span class="p">():</span>
</span><span id="__span-44-97">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-44-98">        <span class="n">statement</span> <span class="o">=</span> <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-44-99">        <span class="n">result</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="n">statement</span><span class="p">)</span>
</span><span id="__span-44-100">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-44-101">
</span><span id="__span-44-102">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers heroes:&quot;</span><span class="p">,</span> <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-44-103">
</span><span id="__span-44-104">
</span><span id="__span-44-105"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-44-106">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-44-107">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-44-108">            <span class="n">select</span><span class="p">(</span><span class="n">Hero</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hero</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Spider-Boy&quot;</span><span class="p">)</span>
</span><span id="__span-44-109">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-44-110">
</span><span id="__span-44-111">        <span class="n">preventers_team</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-44-112">            <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-44-113">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-44-114">
</span><span id="__span-44-115">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hero Spider-Boy:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-44-116">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="p">)</span>
</span><span id="__span-44-117">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-44-118">
</span><span id="__span-44-119">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-44-120">
</span><span id="__span-44-121">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy without team:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-44-122">
</span><span id="__span-44-123">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes again:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-44-124">
</span><span id="__span-44-125">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-44-126">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-44-127">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After committing&quot;</span><span class="p">)</span>
</span><span id="__span-44-128">
</span><span id="__span-44-129">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-44-130">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy after commit:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-44-131">
</span><span id="__span-44-132">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes after commit:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-44-133">
</span><span id="__span-44-134">
</span><span id="__span-44-135"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span id="__span-44-136">    <span class="n">create_db_and_tables</span><span class="p">()</span>
</span><span id="__span-44-137">    <span class="n">create_heroes</span><span class="p">()</span>
</span><span id="__span-44-138">    <span class="n">select_heroes</span><span class="p">()</span>
</span><span id="__span-44-139">    <span class="n">update_heroes</span><span class="p">()</span>
</span><span id="__span-44-140">
</span><span id="__span-44-141">
</span><span id="__span-44-142"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-44-143">    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-45-1"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span>
</span><span id="__span-45-2">
</span><span id="__span-45-3"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">select</span>
</span><span id="__span-45-4">
</span><span id="__span-45-5">
</span><span id="__span-45-6"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-45-7">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-45-8">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-45-9">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-45-10">
</span><span id="__span-45-11">    <span class="n">heroes</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="s2">&quot;Hero&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team&quot;</span><span class="p">)</span>
</span><span id="__span-45-12">
</span><span id="__span-45-13">
</span><span id="__span-45-14"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-45-15">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-45-16">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-45-17">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-45-18">    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-45-19">
</span><span id="__span-45-20">    <span class="n">team_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">)</span>
</span><span id="__span-45-21">    <span class="n">team</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Team</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;heroes&quot;</span><span class="p">)</span>
</span><span id="__span-45-22">
</span><span id="__span-45-23">
</span><span id="__span-45-24"><span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
</span><span id="__span-45-25"><span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-45-26">
</span><span id="__span-45-27"><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-45-28">
</span><span id="__span-45-29">
</span><span id="__span-45-30"><span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
</span><span id="__span-45-31">    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
</span><span id="__span-45-32">
</span><span id="__span-45-33">
</span><span id="__span-45-34"><span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
</span><span id="__span-45-35">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-45-36">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Preventers&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sharp Tower&quot;</span><span class="p">)</span>
</span><span id="__span-45-37">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Z-Force&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sister Margaret&#39;s Bar&quot;</span><span class="p">)</span>
</span><span id="__span-45-38">
</span><span id="__span-45-39">        <span class="n">hero_deadpond</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-45-40">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Dive Wilson&quot;</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span>
</span><span id="__span-45-41">        <span class="p">)</span>
</span><span id="__span-45-42">        <span class="n">hero_rusty_man</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-45-43">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span>
</span><span id="__span-45-44">        <span class="p">)</span>
</span><span id="__span-45-45">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
</span><span id="__span-45-46">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-45-47">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-45-48">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-45-49">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-45-50">
</span><span id="__span-45-51">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-45-52">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-45-53">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-45-54">
</span><span id="__span-45-55">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-45-56">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-45-57">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-45-58">
</span><span id="__span-45-59">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="n">team_preventers</span>
</span><span id="__span-45-60">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-45-61">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-45-62">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-45-63">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Updated hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-45-64">
</span><span id="__span-45-65">        <span class="n">hero_black_lion</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Black Lion&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Trevor Challa&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">35</span><span class="p">)</span>
</span><span id="__span-45-66">        <span class="n">hero_sure_e</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Princess Sure-E&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Sure-E&quot;</span><span class="p">)</span>
</span><span id="__span-45-67">        <span class="n">team_wakaland</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span>
</span><span id="__span-45-68">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Wakaland&quot;</span><span class="p">,</span>
</span><span id="__span-45-69">            <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Wakaland Capital City&quot;</span><span class="p">,</span>
</span><span id="__span-45-70">            <span class="n">heroes</span><span class="o">=</span><span class="p">[</span><span class="n">hero_black_lion</span><span class="p">,</span> <span class="n">hero_sure_e</span><span class="p">],</span>
</span><span id="__span-45-71">        <span class="p">)</span>
</span><span id="__span-45-72">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-45-73">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-45-74">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-45-75">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Team Wakaland:&quot;</span><span class="p">,</span> <span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-45-76">
</span><span id="__span-45-77">        <span class="n">hero_tarantula</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Tarantula&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Natalia Roman-on&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
</span><span id="__span-45-78">        <span class="n">hero_dr_weird</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Dr. Weird&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Steve Weird&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">36</span><span class="p">)</span>
</span><span id="__span-45-79">        <span class="n">hero_cap</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-45-80">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Captain North America&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Esteban Rogelios&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">93</span>
</span><span id="__span-45-81">        <span class="p">)</span>
</span><span id="__span-45-82">
</span><span id="__span-45-83">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-45-84">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-45-85">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-45-86">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_preventers</span><span class="p">)</span>
</span><span id="__span-45-87">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-45-88">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-45-89">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-45-90">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-45-91">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-45-92">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-45-93">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-45-94">
</span><span id="__span-45-95">
</span><span id="__span-45-96"><span class="k">def</span> <span class="nf">select_heroes</span><span class="p">():</span>
</span><span id="__span-45-97">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-45-98">        <span class="n">statement</span> <span class="o">=</span> <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-45-99">        <span class="n">result</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="n">statement</span><span class="p">)</span>
</span><span id="__span-45-100">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-45-101">
</span><span id="__span-45-102">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers heroes:&quot;</span><span class="p">,</span> <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-45-103">
</span><span id="__span-45-104">
</span><span id="__span-45-105"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-45-106">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-45-107">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-45-108">            <span class="n">select</span><span class="p">(</span><span class="n">Hero</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hero</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Spider-Boy&quot;</span><span class="p">)</span>
</span><span id="__span-45-109">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-45-110">
</span><span id="__span-45-111">        <span class="n">preventers_team</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-45-112">            <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-45-113">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-45-114">
</span><span id="__span-45-115">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hero Spider-Boy:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-45-116">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="p">)</span>
</span><span id="__span-45-117">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-45-118">
</span><span id="__span-45-119">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-45-120">
</span><span id="__span-45-121">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy without team:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-45-122">
</span><span id="__span-45-123">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes again:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-45-124">
</span><span id="__span-45-125">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-45-126">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-45-127">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After committing&quot;</span><span class="p">)</span>
</span><span id="__span-45-128">
</span><span id="__span-45-129">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-45-130">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy after commit:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-45-131">
</span><span id="__span-45-132">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes after commit:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-45-133">
</span><span id="__span-45-134">
</span><span id="__span-45-135"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span id="__span-45-136">    <span class="n">create_db_and_tables</span><span class="p">()</span>
</span><span id="__span-45-137">    <span class="n">create_heroes</span><span class="p">()</span>
</span><span id="__span-45-138">    <span class="n">select_heroes</span><span class="p">()</span>
</span><span id="__span-45-139">    <span class="n">update_heroes</span><span class="p">()</span>
</span><span id="__span-45-140">
</span><span id="__span-45-141">
</span><span id="__span-45-142"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-45-143">    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div>
</div>
</div>
</div>
</details>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>This is the same section where we updated <code>hero_spider_boy.team</code> to <code>None</code> but we <em>haven't committed</em> that change yet.</p>
<p>The same section that caused a problem before.</p>
</div>
<h2 id="review-the-result">Review the Result<a class="headerlink" href="#review-the-result" title="Permanent link">&para;</a></h2>
<p>This time, <strong>SQLDev</strong> (actually SQLAlchemy) will be able to notice the change, and <strong>automatically update the list of heroes</strong> in the team, even before we commit.</p>
<p>That second print would output:</p>
<div class="highlight"><pre><span></span><code><span id="__span-46-1">Preventers Team Heroes again: [
</span><span id="__span-46-2">        Hero(name=&#39;Rusty-Man&#39;, age=48, id=2, secret_name=&#39;Tommy Sharp&#39;, team_id=2),
</span><span id="__span-46-3">        Hero(name=&#39;Tarantula&#39;, age=32, id=6, secret_name=&#39;Natalia Roman-on&#39;, team_id=2),
</span><span id="__span-46-4">        Hero(name=&#39;Dr. Weird&#39;, age=36, id=7, secret_name=&#39;Steve Weird&#39;, team_id=2),
</span><span id="__span-46-5">        Hero(name=&#39;Captain North America&#39;, age=93, id=8, secret_name=&#39;Esteban Rogelios&#39;, team_id=2)
</span><span id="__span-46-6">]
</span></code></pre></div>
<p>Notice that now <strong>Spider-Boy</strong> is not there, we fixed it with <code>back_populates</code>! 🎉</p>
<h2 id="the-value-of-back_populates">The Value of <code>back_populates</code><a class="headerlink" href="#the-value-of-back_populates" title="Permanent link">&para;</a></h2>
<p>Now that you know why <code>back_populates</code> is there, let's review the exact value again.</p>
<p>It's quite simple code, it's just a string, but it might be confusing to think exactly <em>what</em> string should go there:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="15:3"><input checked="checked" id="__tabbed_15_1" name="__tabbed_15" type="radio" /><input id="__tabbed_15_2" name="__tabbed_15" type="radio" /><input id="__tabbed_15_3" name="__tabbed_15" type="radio" /><div class="tabbed-labels"><label for="__tabbed_15_1">Python 3.10+</label><label for="__tabbed_15_2">Python 3.9+</label><label for="__tabbed_15_3">Python 3.7+</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-47-1"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">select</span>
</span><span id="__span-47-2">
</span><span id="__span-47-3">
</span><span id="__span-47-4"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-47-5">    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-47-6">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-47-7">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-47-8">
</span><span id="__span-47-9"><span class="hll">    <span class="n">heroes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;Hero&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team&quot;</span><span class="p">)</span>
</span></span><span id="__span-47-10">
</span><span id="__span-47-11">
</span><span id="__span-47-12"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-47-13">    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-47-14">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-47-15">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-47-16">    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-47-17">
</span><span id="__span-47-18">    <span class="n">team_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">)</span>
</span><span id="__span-47-19"><span class="hll">    <span class="n">team</span><span class="p">:</span> <span class="n">Team</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;heroes&quot;</span><span class="p">)</span>
</span></span><span id="__span-47-20">
</span><span id="__span-47-21"><span class="c1"># Code below omitted 👇</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-48-1"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>
</span><span id="__span-48-2">
</span><span id="__span-48-3"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">select</span>
</span><span id="__span-48-4">
</span><span id="__span-48-5">
</span><span id="__span-48-6"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-48-7">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-48-8">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-48-9">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-48-10">
</span><span id="__span-48-11"><span class="hll">    <span class="n">heroes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;Hero&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team&quot;</span><span class="p">)</span>
</span></span><span id="__span-48-12">
</span><span id="__span-48-13">
</span><span id="__span-48-14"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-48-15">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-48-16">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-48-17">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-48-18">    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-48-19">
</span><span id="__span-48-20">    <span class="n">team_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">)</span>
</span><span id="__span-48-21"><span class="hll">    <span class="n">team</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Team</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;heroes&quot;</span><span class="p">)</span>
</span></span><span id="__span-48-22">
</span><span id="__span-48-23"><span class="c1"># Code below omitted 👇</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-49-1"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span>
</span><span id="__span-49-2">
</span><span id="__span-49-3"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">select</span>
</span><span id="__span-49-4">
</span><span id="__span-49-5">
</span><span id="__span-49-6"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-49-7">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-49-8">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-49-9">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-49-10">
</span><span id="__span-49-11"><span class="hll">    <span class="n">heroes</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="s2">&quot;Hero&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team&quot;</span><span class="p">)</span>
</span></span><span id="__span-49-12">
</span><span id="__span-49-13">
</span><span id="__span-49-14"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-49-15">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-49-16">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-49-17">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-49-18">    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-49-19">
</span><span id="__span-49-20">    <span class="n">team_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">)</span>
</span><span id="__span-49-21"><span class="hll">    <span class="n">team</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Team</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;heroes&quot;</span><span class="p">)</span>
</span></span><span id="__span-49-22">
</span><span id="__span-49-23"><span class="c1"># Code below omitted 👇</span>
</span></code></pre></div>
</div>
</div>
</div>
<details>
<summary>👀 Full file preview</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="16:3"><input checked="checked" id="__tabbed_16_1" name="__tabbed_16" type="radio" /><input id="__tabbed_16_2" name="__tabbed_16" type="radio" /><input id="__tabbed_16_3" name="__tabbed_16" type="radio" /><div class="tabbed-labels"><label for="__tabbed_16_1">Python 3.10+</label><label for="__tabbed_16_2">Python 3.9+</label><label for="__tabbed_16_3">Python 3.7+</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-50-1"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">select</span>
</span><span id="__span-50-2">
</span><span id="__span-50-3">
</span><span id="__span-50-4"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-50-5">    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-50-6">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-50-7">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-50-8">
</span><span id="__span-50-9">    <span class="n">heroes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;Hero&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team&quot;</span><span class="p">)</span>
</span><span id="__span-50-10">
</span><span id="__span-50-11">
</span><span id="__span-50-12"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-50-13">    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-50-14">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-50-15">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-50-16">    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-50-17">
</span><span id="__span-50-18">    <span class="n">team_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">)</span>
</span><span id="__span-50-19">    <span class="n">team</span><span class="p">:</span> <span class="n">Team</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;heroes&quot;</span><span class="p">)</span>
</span><span id="__span-50-20">
</span><span id="__span-50-21">
</span><span id="__span-50-22"><span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
</span><span id="__span-50-23"><span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-50-24">
</span><span id="__span-50-25"><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-50-26">
</span><span id="__span-50-27">
</span><span id="__span-50-28"><span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
</span><span id="__span-50-29">    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
</span><span id="__span-50-30">
</span><span id="__span-50-31">
</span><span id="__span-50-32"><span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
</span><span id="__span-50-33">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-50-34">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Preventers&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sharp Tower&quot;</span><span class="p">)</span>
</span><span id="__span-50-35">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Z-Force&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sister Margaret&#39;s Bar&quot;</span><span class="p">)</span>
</span><span id="__span-50-36">
</span><span id="__span-50-37">        <span class="n">hero_deadpond</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-50-38">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Dive Wilson&quot;</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span>
</span><span id="__span-50-39">        <span class="p">)</span>
</span><span id="__span-50-40">        <span class="n">hero_rusty_man</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-50-41">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span>
</span><span id="__span-50-42">        <span class="p">)</span>
</span><span id="__span-50-43">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
</span><span id="__span-50-44">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-50-45">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-50-46">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-50-47">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-50-48">
</span><span id="__span-50-49">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-50-50">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-50-51">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-50-52">
</span><span id="__span-50-53">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-50-54">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-50-55">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-50-56">
</span><span id="__span-50-57">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="n">team_preventers</span>
</span><span id="__span-50-58">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-50-59">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-50-60">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-50-61">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Updated hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-50-62">
</span><span id="__span-50-63">        <span class="n">hero_black_lion</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Black Lion&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Trevor Challa&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">35</span><span class="p">)</span>
</span><span id="__span-50-64">        <span class="n">hero_sure_e</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Princess Sure-E&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Sure-E&quot;</span><span class="p">)</span>
</span><span id="__span-50-65">        <span class="n">team_wakaland</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span>
</span><span id="__span-50-66">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Wakaland&quot;</span><span class="p">,</span>
</span><span id="__span-50-67">            <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Wakaland Capital City&quot;</span><span class="p">,</span>
</span><span id="__span-50-68">            <span class="n">heroes</span><span class="o">=</span><span class="p">[</span><span class="n">hero_black_lion</span><span class="p">,</span> <span class="n">hero_sure_e</span><span class="p">],</span>
</span><span id="__span-50-69">        <span class="p">)</span>
</span><span id="__span-50-70">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-50-71">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-50-72">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-50-73">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Team Wakaland:&quot;</span><span class="p">,</span> <span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-50-74">
</span><span id="__span-50-75">        <span class="n">hero_tarantula</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Tarantula&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Natalia Roman-on&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
</span><span id="__span-50-76">        <span class="n">hero_dr_weird</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Dr. Weird&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Steve Weird&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">36</span><span class="p">)</span>
</span><span id="__span-50-77">        <span class="n">hero_cap</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-50-78">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Captain North America&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Esteban Rogelios&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">93</span>
</span><span id="__span-50-79">        <span class="p">)</span>
</span><span id="__span-50-80">
</span><span id="__span-50-81">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-50-82">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-50-83">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-50-84">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_preventers</span><span class="p">)</span>
</span><span id="__span-50-85">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-50-86">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-50-87">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-50-88">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-50-89">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-50-90">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-50-91">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-50-92">
</span><span id="__span-50-93">
</span><span id="__span-50-94"><span class="k">def</span> <span class="nf">select_heroes</span><span class="p">():</span>
</span><span id="__span-50-95">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-50-96">        <span class="n">statement</span> <span class="o">=</span> <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-50-97">        <span class="n">result</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="n">statement</span><span class="p">)</span>
</span><span id="__span-50-98">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-50-99">
</span><span id="__span-50-100">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers heroes:&quot;</span><span class="p">,</span> <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-50-101">
</span><span id="__span-50-102">
</span><span id="__span-50-103"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-50-104">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-50-105">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-50-106">            <span class="n">select</span><span class="p">(</span><span class="n">Hero</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hero</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Spider-Boy&quot;</span><span class="p">)</span>
</span><span id="__span-50-107">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-50-108">
</span><span id="__span-50-109">        <span class="n">preventers_team</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-50-110">            <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-50-111">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-50-112">
</span><span id="__span-50-113">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hero Spider-Boy:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-50-114">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="p">)</span>
</span><span id="__span-50-115">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-50-116">
</span><span id="__span-50-117">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-50-118">
</span><span id="__span-50-119">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy without team:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-50-120">
</span><span id="__span-50-121">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes again:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-50-122">
</span><span id="__span-50-123">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-50-124">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-50-125">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After committing&quot;</span><span class="p">)</span>
</span><span id="__span-50-126">
</span><span id="__span-50-127">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-50-128">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy after commit:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-50-129">
</span><span id="__span-50-130">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes after commit:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-50-131">
</span><span id="__span-50-132">
</span><span id="__span-50-133"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span id="__span-50-134">    <span class="n">create_db_and_tables</span><span class="p">()</span>
</span><span id="__span-50-135">    <span class="n">create_heroes</span><span class="p">()</span>
</span><span id="__span-50-136">    <span class="n">select_heroes</span><span class="p">()</span>
</span><span id="__span-50-137">    <span class="n">update_heroes</span><span class="p">()</span>
</span><span id="__span-50-138">
</span><span id="__span-50-139">
</span><span id="__span-50-140"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-50-141">    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-51-1"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>
</span><span id="__span-51-2">
</span><span id="__span-51-3"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">select</span>
</span><span id="__span-51-4">
</span><span id="__span-51-5">
</span><span id="__span-51-6"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-51-7">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-51-8">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-51-9">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-51-10">
</span><span id="__span-51-11">    <span class="n">heroes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;Hero&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team&quot;</span><span class="p">)</span>
</span><span id="__span-51-12">
</span><span id="__span-51-13">
</span><span id="__span-51-14"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-51-15">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-51-16">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-51-17">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-51-18">    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-51-19">
</span><span id="__span-51-20">    <span class="n">team_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">)</span>
</span><span id="__span-51-21">    <span class="n">team</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Team</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;heroes&quot;</span><span class="p">)</span>
</span><span id="__span-51-22">
</span><span id="__span-51-23">
</span><span id="__span-51-24"><span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
</span><span id="__span-51-25"><span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-51-26">
</span><span id="__span-51-27"><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-51-28">
</span><span id="__span-51-29">
</span><span id="__span-51-30"><span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
</span><span id="__span-51-31">    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
</span><span id="__span-51-32">
</span><span id="__span-51-33">
</span><span id="__span-51-34"><span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
</span><span id="__span-51-35">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-51-36">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Preventers&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sharp Tower&quot;</span><span class="p">)</span>
</span><span id="__span-51-37">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Z-Force&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sister Margaret&#39;s Bar&quot;</span><span class="p">)</span>
</span><span id="__span-51-38">
</span><span id="__span-51-39">        <span class="n">hero_deadpond</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-51-40">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Dive Wilson&quot;</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span>
</span><span id="__span-51-41">        <span class="p">)</span>
</span><span id="__span-51-42">        <span class="n">hero_rusty_man</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-51-43">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span>
</span><span id="__span-51-44">        <span class="p">)</span>
</span><span id="__span-51-45">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
</span><span id="__span-51-46">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-51-47">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-51-48">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-51-49">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-51-50">
</span><span id="__span-51-51">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-51-52">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-51-53">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-51-54">
</span><span id="__span-51-55">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-51-56">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-51-57">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-51-58">
</span><span id="__span-51-59">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="n">team_preventers</span>
</span><span id="__span-51-60">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-51-61">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-51-62">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-51-63">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Updated hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-51-64">
</span><span id="__span-51-65">        <span class="n">hero_black_lion</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Black Lion&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Trevor Challa&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">35</span><span class="p">)</span>
</span><span id="__span-51-66">        <span class="n">hero_sure_e</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Princess Sure-E&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Sure-E&quot;</span><span class="p">)</span>
</span><span id="__span-51-67">        <span class="n">team_wakaland</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span>
</span><span id="__span-51-68">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Wakaland&quot;</span><span class="p">,</span>
</span><span id="__span-51-69">            <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Wakaland Capital City&quot;</span><span class="p">,</span>
</span><span id="__span-51-70">            <span class="n">heroes</span><span class="o">=</span><span class="p">[</span><span class="n">hero_black_lion</span><span class="p">,</span> <span class="n">hero_sure_e</span><span class="p">],</span>
</span><span id="__span-51-71">        <span class="p">)</span>
</span><span id="__span-51-72">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-51-73">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-51-74">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-51-75">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Team Wakaland:&quot;</span><span class="p">,</span> <span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-51-76">
</span><span id="__span-51-77">        <span class="n">hero_tarantula</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Tarantula&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Natalia Roman-on&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
</span><span id="__span-51-78">        <span class="n">hero_dr_weird</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Dr. Weird&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Steve Weird&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">36</span><span class="p">)</span>
</span><span id="__span-51-79">        <span class="n">hero_cap</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-51-80">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Captain North America&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Esteban Rogelios&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">93</span>
</span><span id="__span-51-81">        <span class="p">)</span>
</span><span id="__span-51-82">
</span><span id="__span-51-83">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-51-84">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-51-85">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-51-86">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_preventers</span><span class="p">)</span>
</span><span id="__span-51-87">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-51-88">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-51-89">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-51-90">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-51-91">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-51-92">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-51-93">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-51-94">
</span><span id="__span-51-95">
</span><span id="__span-51-96"><span class="k">def</span> <span class="nf">select_heroes</span><span class="p">():</span>
</span><span id="__span-51-97">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-51-98">        <span class="n">statement</span> <span class="o">=</span> <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-51-99">        <span class="n">result</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="n">statement</span><span class="p">)</span>
</span><span id="__span-51-100">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-51-101">
</span><span id="__span-51-102">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers heroes:&quot;</span><span class="p">,</span> <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-51-103">
</span><span id="__span-51-104">
</span><span id="__span-51-105"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-51-106">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-51-107">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-51-108">            <span class="n">select</span><span class="p">(</span><span class="n">Hero</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hero</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Spider-Boy&quot;</span><span class="p">)</span>
</span><span id="__span-51-109">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-51-110">
</span><span id="__span-51-111">        <span class="n">preventers_team</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-51-112">            <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-51-113">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-51-114">
</span><span id="__span-51-115">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hero Spider-Boy:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-51-116">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="p">)</span>
</span><span id="__span-51-117">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-51-118">
</span><span id="__span-51-119">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-51-120">
</span><span id="__span-51-121">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy without team:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-51-122">
</span><span id="__span-51-123">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes again:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-51-124">
</span><span id="__span-51-125">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-51-126">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-51-127">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After committing&quot;</span><span class="p">)</span>
</span><span id="__span-51-128">
</span><span id="__span-51-129">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-51-130">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy after commit:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-51-131">
</span><span id="__span-51-132">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes after commit:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-51-133">
</span><span id="__span-51-134">
</span><span id="__span-51-135"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span id="__span-51-136">    <span class="n">create_db_and_tables</span><span class="p">()</span>
</span><span id="__span-51-137">    <span class="n">create_heroes</span><span class="p">()</span>
</span><span id="__span-51-138">    <span class="n">select_heroes</span><span class="p">()</span>
</span><span id="__span-51-139">    <span class="n">update_heroes</span><span class="p">()</span>
</span><span id="__span-51-140">
</span><span id="__span-51-141">
</span><span id="__span-51-142"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-51-143">    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-52-1"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span>
</span><span id="__span-52-2">
</span><span id="__span-52-3"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">select</span>
</span><span id="__span-52-4">
</span><span id="__span-52-5">
</span><span id="__span-52-6"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-52-7">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-52-8">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-52-9">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-52-10">
</span><span id="__span-52-11">    <span class="n">heroes</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="s2">&quot;Hero&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team&quot;</span><span class="p">)</span>
</span><span id="__span-52-12">
</span><span id="__span-52-13">
</span><span id="__span-52-14"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-52-15">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-52-16">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-52-17">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-52-18">    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-52-19">
</span><span id="__span-52-20">    <span class="n">team_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">)</span>
</span><span id="__span-52-21">    <span class="n">team</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Team</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;heroes&quot;</span><span class="p">)</span>
</span><span id="__span-52-22">
</span><span id="__span-52-23">
</span><span id="__span-52-24"><span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
</span><span id="__span-52-25"><span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-52-26">
</span><span id="__span-52-27"><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-52-28">
</span><span id="__span-52-29">
</span><span id="__span-52-30"><span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
</span><span id="__span-52-31">    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
</span><span id="__span-52-32">
</span><span id="__span-52-33">
</span><span id="__span-52-34"><span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
</span><span id="__span-52-35">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-52-36">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Preventers&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sharp Tower&quot;</span><span class="p">)</span>
</span><span id="__span-52-37">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Z-Force&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sister Margaret&#39;s Bar&quot;</span><span class="p">)</span>
</span><span id="__span-52-38">
</span><span id="__span-52-39">        <span class="n">hero_deadpond</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-52-40">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Dive Wilson&quot;</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span>
</span><span id="__span-52-41">        <span class="p">)</span>
</span><span id="__span-52-42">        <span class="n">hero_rusty_man</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-52-43">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span>
</span><span id="__span-52-44">        <span class="p">)</span>
</span><span id="__span-52-45">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
</span><span id="__span-52-46">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-52-47">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-52-48">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-52-49">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-52-50">
</span><span id="__span-52-51">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-52-52">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-52-53">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-52-54">
</span><span id="__span-52-55">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-52-56">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-52-57">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-52-58">
</span><span id="__span-52-59">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="n">team_preventers</span>
</span><span id="__span-52-60">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-52-61">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-52-62">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-52-63">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Updated hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-52-64">
</span><span id="__span-52-65">        <span class="n">hero_black_lion</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Black Lion&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Trevor Challa&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">35</span><span class="p">)</span>
</span><span id="__span-52-66">        <span class="n">hero_sure_e</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Princess Sure-E&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Sure-E&quot;</span><span class="p">)</span>
</span><span id="__span-52-67">        <span class="n">team_wakaland</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span>
</span><span id="__span-52-68">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Wakaland&quot;</span><span class="p">,</span>
</span><span id="__span-52-69">            <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Wakaland Capital City&quot;</span><span class="p">,</span>
</span><span id="__span-52-70">            <span class="n">heroes</span><span class="o">=</span><span class="p">[</span><span class="n">hero_black_lion</span><span class="p">,</span> <span class="n">hero_sure_e</span><span class="p">],</span>
</span><span id="__span-52-71">        <span class="p">)</span>
</span><span id="__span-52-72">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-52-73">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-52-74">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-52-75">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Team Wakaland:&quot;</span><span class="p">,</span> <span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-52-76">
</span><span id="__span-52-77">        <span class="n">hero_tarantula</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Tarantula&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Natalia Roman-on&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
</span><span id="__span-52-78">        <span class="n">hero_dr_weird</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Dr. Weird&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Steve Weird&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">36</span><span class="p">)</span>
</span><span id="__span-52-79">        <span class="n">hero_cap</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-52-80">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Captain North America&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Esteban Rogelios&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">93</span>
</span><span id="__span-52-81">        <span class="p">)</span>
</span><span id="__span-52-82">
</span><span id="__span-52-83">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-52-84">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-52-85">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-52-86">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_preventers</span><span class="p">)</span>
</span><span id="__span-52-87">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-52-88">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-52-89">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-52-90">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-52-91">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-52-92">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-52-93">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-52-94">
</span><span id="__span-52-95">
</span><span id="__span-52-96"><span class="k">def</span> <span class="nf">select_heroes</span><span class="p">():</span>
</span><span id="__span-52-97">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-52-98">        <span class="n">statement</span> <span class="o">=</span> <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-52-99">        <span class="n">result</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="n">statement</span><span class="p">)</span>
</span><span id="__span-52-100">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-52-101">
</span><span id="__span-52-102">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers heroes:&quot;</span><span class="p">,</span> <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-52-103">
</span><span id="__span-52-104">
</span><span id="__span-52-105"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-52-106">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-52-107">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-52-108">            <span class="n">select</span><span class="p">(</span><span class="n">Hero</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hero</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Spider-Boy&quot;</span><span class="p">)</span>
</span><span id="__span-52-109">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-52-110">
</span><span id="__span-52-111">        <span class="n">preventers_team</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-52-112">            <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-52-113">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-52-114">
</span><span id="__span-52-115">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hero Spider-Boy:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-52-116">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="p">)</span>
</span><span id="__span-52-117">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-52-118">
</span><span id="__span-52-119">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-52-120">
</span><span id="__span-52-121">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy without team:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-52-122">
</span><span id="__span-52-123">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes again:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-52-124">
</span><span id="__span-52-125">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-52-126">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-52-127">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After committing&quot;</span><span class="p">)</span>
</span><span id="__span-52-128">
</span><span id="__span-52-129">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-52-130">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy after commit:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-52-131">
</span><span id="__span-52-132">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes after commit:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-52-133">
</span><span id="__span-52-134">
</span><span id="__span-52-135"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span id="__span-52-136">    <span class="n">create_db_and_tables</span><span class="p">()</span>
</span><span id="__span-52-137">    <span class="n">create_heroes</span><span class="p">()</span>
</span><span id="__span-52-138">    <span class="n">select_heroes</span><span class="p">()</span>
</span><span id="__span-52-139">    <span class="n">update_heroes</span><span class="p">()</span>
</span><span id="__span-52-140">
</span><span id="__span-52-141">
</span><span id="__span-52-142"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-52-143">    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div>
</div>
</div>
</div>
</details>
<p>The string in <code>back_populates</code> is the name of the attribute <em>in the other</em> model, that will reference <em>the current</em> model.</p>
<p><img src="/img/tutorial/relationships/attributes/back-populates.svg"></p>
<p>So, in the class <code>Team</code>, we have an attribute <code>heroes</code> and we declare it with <code>Relationship(back_populates="team")</code>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="17:3"><input checked="checked" id="__tabbed_17_1" name="__tabbed_17" type="radio" /><input id="__tabbed_17_2" name="__tabbed_17" type="radio" /><input id="__tabbed_17_3" name="__tabbed_17" type="radio" /><div class="tabbed-labels"><label for="__tabbed_17_1">Python 3.10+</label><label for="__tabbed_17_2">Python 3.9+</label><label for="__tabbed_17_3">Python 3.7+</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-53-1"><span class="c1"># Code above omitted 👆</span>
</span><span id="__span-53-2">
</span><span id="__span-53-3"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-53-4">    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-53-5">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-53-6">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-53-7">
</span><span id="__span-53-8"><span class="hll">    <span class="n">heroes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;Hero&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team&quot;</span><span class="p">)</span>
</span></span><span id="__span-53-9">
</span><span id="__span-53-10"><span class="c1"># Code below omitted 👇</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-54-1"><span class="c1"># Code above omitted 👆</span>
</span><span id="__span-54-2">
</span><span id="__span-54-3"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-54-4">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-54-5">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-54-6">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-54-7">
</span><span id="__span-54-8"><span class="hll">    <span class="n">heroes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;Hero&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team&quot;</span><span class="p">)</span>
</span></span><span id="__span-54-9">
</span><span id="__span-54-10"><span class="c1"># Code below omitted 👇</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-55-1"><span class="c1"># Code above omitted 👆</span>
</span><span id="__span-55-2">
</span><span id="__span-55-3"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-55-4">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-55-5">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-55-6">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-55-7">
</span><span id="__span-55-8"><span class="hll">    <span class="n">heroes</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="s2">&quot;Hero&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team&quot;</span><span class="p">)</span>
</span></span><span id="__span-55-9">
</span><span id="__span-55-10"><span class="c1"># Code below omitted 👇</span>
</span></code></pre></div>
</div>
</div>
</div>
<details>
<summary>👀 Full file preview</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="18:3"><input checked="checked" id="__tabbed_18_1" name="__tabbed_18" type="radio" /><input id="__tabbed_18_2" name="__tabbed_18" type="radio" /><input id="__tabbed_18_3" name="__tabbed_18" type="radio" /><div class="tabbed-labels"><label for="__tabbed_18_1">Python 3.10+</label><label for="__tabbed_18_2">Python 3.9+</label><label for="__tabbed_18_3">Python 3.7+</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-56-1"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">select</span>
</span><span id="__span-56-2">
</span><span id="__span-56-3">
</span><span id="__span-56-4"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-56-5">    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-56-6">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-56-7">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-56-8">
</span><span id="__span-56-9">    <span class="n">heroes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;Hero&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team&quot;</span><span class="p">)</span>
</span><span id="__span-56-10">
</span><span id="__span-56-11">
</span><span id="__span-56-12"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-56-13">    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-56-14">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-56-15">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-56-16">    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-56-17">
</span><span id="__span-56-18">    <span class="n">team_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">)</span>
</span><span id="__span-56-19">    <span class="n">team</span><span class="p">:</span> <span class="n">Team</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;heroes&quot;</span><span class="p">)</span>
</span><span id="__span-56-20">
</span><span id="__span-56-21">
</span><span id="__span-56-22"><span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
</span><span id="__span-56-23"><span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-56-24">
</span><span id="__span-56-25"><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-56-26">
</span><span id="__span-56-27">
</span><span id="__span-56-28"><span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
</span><span id="__span-56-29">    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
</span><span id="__span-56-30">
</span><span id="__span-56-31">
</span><span id="__span-56-32"><span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
</span><span id="__span-56-33">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-56-34">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Preventers&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sharp Tower&quot;</span><span class="p">)</span>
</span><span id="__span-56-35">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Z-Force&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sister Margaret&#39;s Bar&quot;</span><span class="p">)</span>
</span><span id="__span-56-36">
</span><span id="__span-56-37">        <span class="n">hero_deadpond</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-56-38">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Dive Wilson&quot;</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span>
</span><span id="__span-56-39">        <span class="p">)</span>
</span><span id="__span-56-40">        <span class="n">hero_rusty_man</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-56-41">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span>
</span><span id="__span-56-42">        <span class="p">)</span>
</span><span id="__span-56-43">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
</span><span id="__span-56-44">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-56-45">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-56-46">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-56-47">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-56-48">
</span><span id="__span-56-49">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-56-50">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-56-51">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-56-52">
</span><span id="__span-56-53">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-56-54">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-56-55">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-56-56">
</span><span id="__span-56-57">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="n">team_preventers</span>
</span><span id="__span-56-58">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-56-59">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-56-60">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-56-61">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Updated hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-56-62">
</span><span id="__span-56-63">        <span class="n">hero_black_lion</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Black Lion&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Trevor Challa&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">35</span><span class="p">)</span>
</span><span id="__span-56-64">        <span class="n">hero_sure_e</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Princess Sure-E&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Sure-E&quot;</span><span class="p">)</span>
</span><span id="__span-56-65">        <span class="n">team_wakaland</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span>
</span><span id="__span-56-66">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Wakaland&quot;</span><span class="p">,</span>
</span><span id="__span-56-67">            <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Wakaland Capital City&quot;</span><span class="p">,</span>
</span><span id="__span-56-68">            <span class="n">heroes</span><span class="o">=</span><span class="p">[</span><span class="n">hero_black_lion</span><span class="p">,</span> <span class="n">hero_sure_e</span><span class="p">],</span>
</span><span id="__span-56-69">        <span class="p">)</span>
</span><span id="__span-56-70">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-56-71">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-56-72">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-56-73">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Team Wakaland:&quot;</span><span class="p">,</span> <span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-56-74">
</span><span id="__span-56-75">        <span class="n">hero_tarantula</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Tarantula&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Natalia Roman-on&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
</span><span id="__span-56-76">        <span class="n">hero_dr_weird</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Dr. Weird&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Steve Weird&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">36</span><span class="p">)</span>
</span><span id="__span-56-77">        <span class="n">hero_cap</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-56-78">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Captain North America&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Esteban Rogelios&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">93</span>
</span><span id="__span-56-79">        <span class="p">)</span>
</span><span id="__span-56-80">
</span><span id="__span-56-81">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-56-82">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-56-83">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-56-84">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_preventers</span><span class="p">)</span>
</span><span id="__span-56-85">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-56-86">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-56-87">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-56-88">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-56-89">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-56-90">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-56-91">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-56-92">
</span><span id="__span-56-93">
</span><span id="__span-56-94"><span class="k">def</span> <span class="nf">select_heroes</span><span class="p">():</span>
</span><span id="__span-56-95">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-56-96">        <span class="n">statement</span> <span class="o">=</span> <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-56-97">        <span class="n">result</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="n">statement</span><span class="p">)</span>
</span><span id="__span-56-98">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-56-99">
</span><span id="__span-56-100">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers heroes:&quot;</span><span class="p">,</span> <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-56-101">
</span><span id="__span-56-102">
</span><span id="__span-56-103"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-56-104">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-56-105">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-56-106">            <span class="n">select</span><span class="p">(</span><span class="n">Hero</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hero</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Spider-Boy&quot;</span><span class="p">)</span>
</span><span id="__span-56-107">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-56-108">
</span><span id="__span-56-109">        <span class="n">preventers_team</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-56-110">            <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-56-111">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-56-112">
</span><span id="__span-56-113">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hero Spider-Boy:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-56-114">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="p">)</span>
</span><span id="__span-56-115">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-56-116">
</span><span id="__span-56-117">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-56-118">
</span><span id="__span-56-119">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy without team:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-56-120">
</span><span id="__span-56-121">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes again:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-56-122">
</span><span id="__span-56-123">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-56-124">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-56-125">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After committing&quot;</span><span class="p">)</span>
</span><span id="__span-56-126">
</span><span id="__span-56-127">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-56-128">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy after commit:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-56-129">
</span><span id="__span-56-130">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes after commit:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-56-131">
</span><span id="__span-56-132">
</span><span id="__span-56-133"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span id="__span-56-134">    <span class="n">create_db_and_tables</span><span class="p">()</span>
</span><span id="__span-56-135">    <span class="n">create_heroes</span><span class="p">()</span>
</span><span id="__span-56-136">    <span class="n">select_heroes</span><span class="p">()</span>
</span><span id="__span-56-137">    <span class="n">update_heroes</span><span class="p">()</span>
</span><span id="__span-56-138">
</span><span id="__span-56-139">
</span><span id="__span-56-140"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-56-141">    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-57-1"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>
</span><span id="__span-57-2">
</span><span id="__span-57-3"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">select</span>
</span><span id="__span-57-4">
</span><span id="__span-57-5">
</span><span id="__span-57-6"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-57-7">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-57-8">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-57-9">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-57-10">
</span><span id="__span-57-11">    <span class="n">heroes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;Hero&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team&quot;</span><span class="p">)</span>
</span><span id="__span-57-12">
</span><span id="__span-57-13">
</span><span id="__span-57-14"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-57-15">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-57-16">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-57-17">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-57-18">    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-57-19">
</span><span id="__span-57-20">    <span class="n">team_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">)</span>
</span><span id="__span-57-21">    <span class="n">team</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Team</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;heroes&quot;</span><span class="p">)</span>
</span><span id="__span-57-22">
</span><span id="__span-57-23">
</span><span id="__span-57-24"><span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
</span><span id="__span-57-25"><span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-57-26">
</span><span id="__span-57-27"><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-57-28">
</span><span id="__span-57-29">
</span><span id="__span-57-30"><span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
</span><span id="__span-57-31">    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
</span><span id="__span-57-32">
</span><span id="__span-57-33">
</span><span id="__span-57-34"><span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
</span><span id="__span-57-35">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-57-36">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Preventers&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sharp Tower&quot;</span><span class="p">)</span>
</span><span id="__span-57-37">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Z-Force&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sister Margaret&#39;s Bar&quot;</span><span class="p">)</span>
</span><span id="__span-57-38">
</span><span id="__span-57-39">        <span class="n">hero_deadpond</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-57-40">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Dive Wilson&quot;</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span>
</span><span id="__span-57-41">        <span class="p">)</span>
</span><span id="__span-57-42">        <span class="n">hero_rusty_man</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-57-43">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span>
</span><span id="__span-57-44">        <span class="p">)</span>
</span><span id="__span-57-45">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
</span><span id="__span-57-46">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-57-47">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-57-48">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-57-49">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-57-50">
</span><span id="__span-57-51">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-57-52">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-57-53">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-57-54">
</span><span id="__span-57-55">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-57-56">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-57-57">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-57-58">
</span><span id="__span-57-59">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="n">team_preventers</span>
</span><span id="__span-57-60">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-57-61">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-57-62">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-57-63">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Updated hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-57-64">
</span><span id="__span-57-65">        <span class="n">hero_black_lion</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Black Lion&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Trevor Challa&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">35</span><span class="p">)</span>
</span><span id="__span-57-66">        <span class="n">hero_sure_e</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Princess Sure-E&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Sure-E&quot;</span><span class="p">)</span>
</span><span id="__span-57-67">        <span class="n">team_wakaland</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span>
</span><span id="__span-57-68">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Wakaland&quot;</span><span class="p">,</span>
</span><span id="__span-57-69">            <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Wakaland Capital City&quot;</span><span class="p">,</span>
</span><span id="__span-57-70">            <span class="n">heroes</span><span class="o">=</span><span class="p">[</span><span class="n">hero_black_lion</span><span class="p">,</span> <span class="n">hero_sure_e</span><span class="p">],</span>
</span><span id="__span-57-71">        <span class="p">)</span>
</span><span id="__span-57-72">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-57-73">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-57-74">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-57-75">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Team Wakaland:&quot;</span><span class="p">,</span> <span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-57-76">
</span><span id="__span-57-77">        <span class="n">hero_tarantula</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Tarantula&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Natalia Roman-on&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
</span><span id="__span-57-78">        <span class="n">hero_dr_weird</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Dr. Weird&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Steve Weird&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">36</span><span class="p">)</span>
</span><span id="__span-57-79">        <span class="n">hero_cap</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-57-80">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Captain North America&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Esteban Rogelios&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">93</span>
</span><span id="__span-57-81">        <span class="p">)</span>
</span><span id="__span-57-82">
</span><span id="__span-57-83">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-57-84">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-57-85">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-57-86">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_preventers</span><span class="p">)</span>
</span><span id="__span-57-87">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-57-88">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-57-89">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-57-90">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-57-91">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-57-92">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-57-93">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-57-94">
</span><span id="__span-57-95">
</span><span id="__span-57-96"><span class="k">def</span> <span class="nf">select_heroes</span><span class="p">():</span>
</span><span id="__span-57-97">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-57-98">        <span class="n">statement</span> <span class="o">=</span> <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-57-99">        <span class="n">result</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="n">statement</span><span class="p">)</span>
</span><span id="__span-57-100">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-57-101">
</span><span id="__span-57-102">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers heroes:&quot;</span><span class="p">,</span> <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-57-103">
</span><span id="__span-57-104">
</span><span id="__span-57-105"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-57-106">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-57-107">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-57-108">            <span class="n">select</span><span class="p">(</span><span class="n">Hero</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hero</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Spider-Boy&quot;</span><span class="p">)</span>
</span><span id="__span-57-109">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-57-110">
</span><span id="__span-57-111">        <span class="n">preventers_team</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-57-112">            <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-57-113">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-57-114">
</span><span id="__span-57-115">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hero Spider-Boy:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-57-116">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="p">)</span>
</span><span id="__span-57-117">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-57-118">
</span><span id="__span-57-119">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-57-120">
</span><span id="__span-57-121">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy without team:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-57-122">
</span><span id="__span-57-123">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes again:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-57-124">
</span><span id="__span-57-125">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-57-126">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-57-127">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After committing&quot;</span><span class="p">)</span>
</span><span id="__span-57-128">
</span><span id="__span-57-129">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-57-130">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy after commit:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-57-131">
</span><span id="__span-57-132">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes after commit:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-57-133">
</span><span id="__span-57-134">
</span><span id="__span-57-135"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span id="__span-57-136">    <span class="n">create_db_and_tables</span><span class="p">()</span>
</span><span id="__span-57-137">    <span class="n">create_heroes</span><span class="p">()</span>
</span><span id="__span-57-138">    <span class="n">select_heroes</span><span class="p">()</span>
</span><span id="__span-57-139">    <span class="n">update_heroes</span><span class="p">()</span>
</span><span id="__span-57-140">
</span><span id="__span-57-141">
</span><span id="__span-57-142"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-57-143">    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-58-1"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span>
</span><span id="__span-58-2">
</span><span id="__span-58-3"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">select</span>
</span><span id="__span-58-4">
</span><span id="__span-58-5">
</span><span id="__span-58-6"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-58-7">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-58-8">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-58-9">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-58-10">
</span><span id="__span-58-11">    <span class="n">heroes</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="s2">&quot;Hero&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team&quot;</span><span class="p">)</span>
</span><span id="__span-58-12">
</span><span id="__span-58-13">
</span><span id="__span-58-14"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-58-15">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-58-16">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-58-17">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-58-18">    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-58-19">
</span><span id="__span-58-20">    <span class="n">team_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">)</span>
</span><span id="__span-58-21">    <span class="n">team</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Team</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;heroes&quot;</span><span class="p">)</span>
</span><span id="__span-58-22">
</span><span id="__span-58-23">
</span><span id="__span-58-24"><span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
</span><span id="__span-58-25"><span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-58-26">
</span><span id="__span-58-27"><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-58-28">
</span><span id="__span-58-29">
</span><span id="__span-58-30"><span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
</span><span id="__span-58-31">    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
</span><span id="__span-58-32">
</span><span id="__span-58-33">
</span><span id="__span-58-34"><span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
</span><span id="__span-58-35">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-58-36">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Preventers&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sharp Tower&quot;</span><span class="p">)</span>
</span><span id="__span-58-37">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Z-Force&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sister Margaret&#39;s Bar&quot;</span><span class="p">)</span>
</span><span id="__span-58-38">
</span><span id="__span-58-39">        <span class="n">hero_deadpond</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-58-40">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Dive Wilson&quot;</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span>
</span><span id="__span-58-41">        <span class="p">)</span>
</span><span id="__span-58-42">        <span class="n">hero_rusty_man</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-58-43">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span>
</span><span id="__span-58-44">        <span class="p">)</span>
</span><span id="__span-58-45">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
</span><span id="__span-58-46">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-58-47">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-58-48">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-58-49">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-58-50">
</span><span id="__span-58-51">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-58-52">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-58-53">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-58-54">
</span><span id="__span-58-55">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-58-56">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-58-57">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-58-58">
</span><span id="__span-58-59">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="n">team_preventers</span>
</span><span id="__span-58-60">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-58-61">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-58-62">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-58-63">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Updated hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-58-64">
</span><span id="__span-58-65">        <span class="n">hero_black_lion</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Black Lion&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Trevor Challa&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">35</span><span class="p">)</span>
</span><span id="__span-58-66">        <span class="n">hero_sure_e</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Princess Sure-E&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Sure-E&quot;</span><span class="p">)</span>
</span><span id="__span-58-67">        <span class="n">team_wakaland</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span>
</span><span id="__span-58-68">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Wakaland&quot;</span><span class="p">,</span>
</span><span id="__span-58-69">            <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Wakaland Capital City&quot;</span><span class="p">,</span>
</span><span id="__span-58-70">            <span class="n">heroes</span><span class="o">=</span><span class="p">[</span><span class="n">hero_black_lion</span><span class="p">,</span> <span class="n">hero_sure_e</span><span class="p">],</span>
</span><span id="__span-58-71">        <span class="p">)</span>
</span><span id="__span-58-72">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-58-73">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-58-74">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-58-75">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Team Wakaland:&quot;</span><span class="p">,</span> <span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-58-76">
</span><span id="__span-58-77">        <span class="n">hero_tarantula</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Tarantula&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Natalia Roman-on&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
</span><span id="__span-58-78">        <span class="n">hero_dr_weird</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Dr. Weird&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Steve Weird&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">36</span><span class="p">)</span>
</span><span id="__span-58-79">        <span class="n">hero_cap</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-58-80">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Captain North America&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Esteban Rogelios&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">93</span>
</span><span id="__span-58-81">        <span class="p">)</span>
</span><span id="__span-58-82">
</span><span id="__span-58-83">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-58-84">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-58-85">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-58-86">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_preventers</span><span class="p">)</span>
</span><span id="__span-58-87">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-58-88">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-58-89">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-58-90">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-58-91">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-58-92">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-58-93">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-58-94">
</span><span id="__span-58-95">
</span><span id="__span-58-96"><span class="k">def</span> <span class="nf">select_heroes</span><span class="p">():</span>
</span><span id="__span-58-97">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-58-98">        <span class="n">statement</span> <span class="o">=</span> <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-58-99">        <span class="n">result</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="n">statement</span><span class="p">)</span>
</span><span id="__span-58-100">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-58-101">
</span><span id="__span-58-102">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers heroes:&quot;</span><span class="p">,</span> <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-58-103">
</span><span id="__span-58-104">
</span><span id="__span-58-105"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-58-106">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-58-107">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-58-108">            <span class="n">select</span><span class="p">(</span><span class="n">Hero</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hero</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Spider-Boy&quot;</span><span class="p">)</span>
</span><span id="__span-58-109">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-58-110">
</span><span id="__span-58-111">        <span class="n">preventers_team</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-58-112">            <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-58-113">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-58-114">
</span><span id="__span-58-115">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hero Spider-Boy:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-58-116">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="p">)</span>
</span><span id="__span-58-117">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-58-118">
</span><span id="__span-58-119">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-58-120">
</span><span id="__span-58-121">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy without team:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-58-122">
</span><span id="__span-58-123">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes again:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-58-124">
</span><span id="__span-58-125">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-58-126">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-58-127">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After committing&quot;</span><span class="p">)</span>
</span><span id="__span-58-128">
</span><span id="__span-58-129">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-58-130">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy after commit:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-58-131">
</span><span id="__span-58-132">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes after commit:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-58-133">
</span><span id="__span-58-134">
</span><span id="__span-58-135"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span id="__span-58-136">    <span class="n">create_db_and_tables</span><span class="p">()</span>
</span><span id="__span-58-137">    <span class="n">create_heroes</span><span class="p">()</span>
</span><span id="__span-58-138">    <span class="n">select_heroes</span><span class="p">()</span>
</span><span id="__span-58-139">    <span class="n">update_heroes</span><span class="p">()</span>
</span><span id="__span-58-140">
</span><span id="__span-58-141">
</span><span id="__span-58-142"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-58-143">    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div>
</div>
</div>
</div>
</details>
<p>The string in <code>back_populates="team"</code> refers to the attribute <code>team</code> in the class <code>Hero</code> (the other class).</p>
<p>And, in the class <code>Hero</code>, we declare an attribute <code>team</code>, and we declare it with <code>Relationship(back_populates="heroes")</code>.</p>
<p>So, the string <code>"heroes"</code> refers to the attribute <code>heroes</code> in the class <code>Team</code>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="19:3"><input checked="checked" id="__tabbed_19_1" name="__tabbed_19" type="radio" /><input id="__tabbed_19_2" name="__tabbed_19" type="radio" /><input id="__tabbed_19_3" name="__tabbed_19" type="radio" /><div class="tabbed-labels"><label for="__tabbed_19_1">Python 3.10+</label><label for="__tabbed_19_2">Python 3.9+</label><label for="__tabbed_19_3">Python 3.7+</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-59-1"><span class="c1"># Code above omitted 👆</span>
</span><span id="__span-59-2">
</span><span id="__span-59-3"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-59-4">    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-59-5">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-59-6">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-59-7">    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-59-8">
</span><span id="__span-59-9">    <span class="n">team_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">)</span>
</span><span id="__span-59-10"><span class="hll">    <span class="n">team</span><span class="p">:</span> <span class="n">Team</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;heroes&quot;</span><span class="p">)</span>
</span></span><span id="__span-59-11">
</span><span id="__span-59-12"><span class="c1"># Code below omitted 👇</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-60-1"><span class="c1"># Code above omitted 👆</span>
</span><span id="__span-60-2">
</span><span id="__span-60-3"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-60-4">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-60-5">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-60-6">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-60-7">    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-60-8">
</span><span id="__span-60-9">    <span class="n">team_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">)</span>
</span><span id="__span-60-10"><span class="hll">    <span class="n">team</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Team</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;heroes&quot;</span><span class="p">)</span>
</span></span><span id="__span-60-11">
</span><span id="__span-60-12"><span class="c1"># Code below omitted 👇</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-61-1"><span class="c1"># Code above omitted 👆</span>
</span><span id="__span-61-2">
</span><span id="__span-61-3"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-61-4">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-61-5">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-61-6">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-61-7">    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-61-8">
</span><span id="__span-61-9">    <span class="n">team_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">)</span>
</span><span id="__span-61-10"><span class="hll">    <span class="n">team</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Team</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;heroes&quot;</span><span class="p">)</span>
</span></span><span id="__span-61-11">
</span><span id="__span-61-12"><span class="c1"># Code below omitted 👇</span>
</span></code></pre></div>
</div>
</div>
</div>
<details>
<summary>👀 Full file preview</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="20:3"><input checked="checked" id="__tabbed_20_1" name="__tabbed_20" type="radio" /><input id="__tabbed_20_2" name="__tabbed_20" type="radio" /><input id="__tabbed_20_3" name="__tabbed_20" type="radio" /><div class="tabbed-labels"><label for="__tabbed_20_1">Python 3.10+</label><label for="__tabbed_20_2">Python 3.9+</label><label for="__tabbed_20_3">Python 3.7+</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-62-1"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">select</span>
</span><span id="__span-62-2">
</span><span id="__span-62-3">
</span><span id="__span-62-4"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-62-5">    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-62-6">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-62-7">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-62-8">
</span><span id="__span-62-9">    <span class="n">heroes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;Hero&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team&quot;</span><span class="p">)</span>
</span><span id="__span-62-10">
</span><span id="__span-62-11">
</span><span id="__span-62-12"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-62-13">    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-62-14">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-62-15">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-62-16">    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-62-17">
</span><span id="__span-62-18">    <span class="n">team_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">)</span>
</span><span id="__span-62-19">    <span class="n">team</span><span class="p">:</span> <span class="n">Team</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;heroes&quot;</span><span class="p">)</span>
</span><span id="__span-62-20">
</span><span id="__span-62-21">
</span><span id="__span-62-22"><span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
</span><span id="__span-62-23"><span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-62-24">
</span><span id="__span-62-25"><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-62-26">
</span><span id="__span-62-27">
</span><span id="__span-62-28"><span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
</span><span id="__span-62-29">    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
</span><span id="__span-62-30">
</span><span id="__span-62-31">
</span><span id="__span-62-32"><span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
</span><span id="__span-62-33">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-62-34">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Preventers&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sharp Tower&quot;</span><span class="p">)</span>
</span><span id="__span-62-35">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Z-Force&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sister Margaret&#39;s Bar&quot;</span><span class="p">)</span>
</span><span id="__span-62-36">
</span><span id="__span-62-37">        <span class="n">hero_deadpond</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-62-38">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Dive Wilson&quot;</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span>
</span><span id="__span-62-39">        <span class="p">)</span>
</span><span id="__span-62-40">        <span class="n">hero_rusty_man</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-62-41">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span>
</span><span id="__span-62-42">        <span class="p">)</span>
</span><span id="__span-62-43">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
</span><span id="__span-62-44">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-62-45">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-62-46">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-62-47">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-62-48">
</span><span id="__span-62-49">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-62-50">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-62-51">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-62-52">
</span><span id="__span-62-53">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-62-54">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-62-55">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-62-56">
</span><span id="__span-62-57">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="n">team_preventers</span>
</span><span id="__span-62-58">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-62-59">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-62-60">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-62-61">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Updated hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-62-62">
</span><span id="__span-62-63">        <span class="n">hero_black_lion</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Black Lion&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Trevor Challa&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">35</span><span class="p">)</span>
</span><span id="__span-62-64">        <span class="n">hero_sure_e</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Princess Sure-E&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Sure-E&quot;</span><span class="p">)</span>
</span><span id="__span-62-65">        <span class="n">team_wakaland</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span>
</span><span id="__span-62-66">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Wakaland&quot;</span><span class="p">,</span>
</span><span id="__span-62-67">            <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Wakaland Capital City&quot;</span><span class="p">,</span>
</span><span id="__span-62-68">            <span class="n">heroes</span><span class="o">=</span><span class="p">[</span><span class="n">hero_black_lion</span><span class="p">,</span> <span class="n">hero_sure_e</span><span class="p">],</span>
</span><span id="__span-62-69">        <span class="p">)</span>
</span><span id="__span-62-70">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-62-71">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-62-72">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-62-73">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Team Wakaland:&quot;</span><span class="p">,</span> <span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-62-74">
</span><span id="__span-62-75">        <span class="n">hero_tarantula</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Tarantula&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Natalia Roman-on&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
</span><span id="__span-62-76">        <span class="n">hero_dr_weird</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Dr. Weird&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Steve Weird&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">36</span><span class="p">)</span>
</span><span id="__span-62-77">        <span class="n">hero_cap</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-62-78">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Captain North America&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Esteban Rogelios&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">93</span>
</span><span id="__span-62-79">        <span class="p">)</span>
</span><span id="__span-62-80">
</span><span id="__span-62-81">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-62-82">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-62-83">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-62-84">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_preventers</span><span class="p">)</span>
</span><span id="__span-62-85">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-62-86">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-62-87">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-62-88">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-62-89">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-62-90">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-62-91">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-62-92">
</span><span id="__span-62-93">
</span><span id="__span-62-94"><span class="k">def</span> <span class="nf">select_heroes</span><span class="p">():</span>
</span><span id="__span-62-95">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-62-96">        <span class="n">statement</span> <span class="o">=</span> <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-62-97">        <span class="n">result</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="n">statement</span><span class="p">)</span>
</span><span id="__span-62-98">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-62-99">
</span><span id="__span-62-100">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers heroes:&quot;</span><span class="p">,</span> <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-62-101">
</span><span id="__span-62-102">
</span><span id="__span-62-103"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-62-104">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-62-105">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-62-106">            <span class="n">select</span><span class="p">(</span><span class="n">Hero</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hero</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Spider-Boy&quot;</span><span class="p">)</span>
</span><span id="__span-62-107">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-62-108">
</span><span id="__span-62-109">        <span class="n">preventers_team</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-62-110">            <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-62-111">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-62-112">
</span><span id="__span-62-113">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hero Spider-Boy:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-62-114">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="p">)</span>
</span><span id="__span-62-115">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-62-116">
</span><span id="__span-62-117">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-62-118">
</span><span id="__span-62-119">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy without team:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-62-120">
</span><span id="__span-62-121">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes again:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-62-122">
</span><span id="__span-62-123">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-62-124">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-62-125">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After committing&quot;</span><span class="p">)</span>
</span><span id="__span-62-126">
</span><span id="__span-62-127">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-62-128">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy after commit:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-62-129">
</span><span id="__span-62-130">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes after commit:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-62-131">
</span><span id="__span-62-132">
</span><span id="__span-62-133"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span id="__span-62-134">    <span class="n">create_db_and_tables</span><span class="p">()</span>
</span><span id="__span-62-135">    <span class="n">create_heroes</span><span class="p">()</span>
</span><span id="__span-62-136">    <span class="n">select_heroes</span><span class="p">()</span>
</span><span id="__span-62-137">    <span class="n">update_heroes</span><span class="p">()</span>
</span><span id="__span-62-138">
</span><span id="__span-62-139">
</span><span id="__span-62-140"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-62-141">    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-63-1"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>
</span><span id="__span-63-2">
</span><span id="__span-63-3"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">select</span>
</span><span id="__span-63-4">
</span><span id="__span-63-5">
</span><span id="__span-63-6"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-63-7">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-63-8">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-63-9">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-63-10">
</span><span id="__span-63-11">    <span class="n">heroes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;Hero&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team&quot;</span><span class="p">)</span>
</span><span id="__span-63-12">
</span><span id="__span-63-13">
</span><span id="__span-63-14"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-63-15">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-63-16">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-63-17">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-63-18">    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-63-19">
</span><span id="__span-63-20">    <span class="n">team_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">)</span>
</span><span id="__span-63-21">    <span class="n">team</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Team</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;heroes&quot;</span><span class="p">)</span>
</span><span id="__span-63-22">
</span><span id="__span-63-23">
</span><span id="__span-63-24"><span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
</span><span id="__span-63-25"><span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-63-26">
</span><span id="__span-63-27"><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-63-28">
</span><span id="__span-63-29">
</span><span id="__span-63-30"><span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
</span><span id="__span-63-31">    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
</span><span id="__span-63-32">
</span><span id="__span-63-33">
</span><span id="__span-63-34"><span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
</span><span id="__span-63-35">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-63-36">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Preventers&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sharp Tower&quot;</span><span class="p">)</span>
</span><span id="__span-63-37">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Z-Force&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sister Margaret&#39;s Bar&quot;</span><span class="p">)</span>
</span><span id="__span-63-38">
</span><span id="__span-63-39">        <span class="n">hero_deadpond</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-63-40">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Dive Wilson&quot;</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span>
</span><span id="__span-63-41">        <span class="p">)</span>
</span><span id="__span-63-42">        <span class="n">hero_rusty_man</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-63-43">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span>
</span><span id="__span-63-44">        <span class="p">)</span>
</span><span id="__span-63-45">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
</span><span id="__span-63-46">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-63-47">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-63-48">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-63-49">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-63-50">
</span><span id="__span-63-51">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-63-52">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-63-53">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-63-54">
</span><span id="__span-63-55">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-63-56">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-63-57">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-63-58">
</span><span id="__span-63-59">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="n">team_preventers</span>
</span><span id="__span-63-60">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-63-61">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-63-62">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-63-63">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Updated hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-63-64">
</span><span id="__span-63-65">        <span class="n">hero_black_lion</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Black Lion&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Trevor Challa&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">35</span><span class="p">)</span>
</span><span id="__span-63-66">        <span class="n">hero_sure_e</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Princess Sure-E&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Sure-E&quot;</span><span class="p">)</span>
</span><span id="__span-63-67">        <span class="n">team_wakaland</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span>
</span><span id="__span-63-68">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Wakaland&quot;</span><span class="p">,</span>
</span><span id="__span-63-69">            <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Wakaland Capital City&quot;</span><span class="p">,</span>
</span><span id="__span-63-70">            <span class="n">heroes</span><span class="o">=</span><span class="p">[</span><span class="n">hero_black_lion</span><span class="p">,</span> <span class="n">hero_sure_e</span><span class="p">],</span>
</span><span id="__span-63-71">        <span class="p">)</span>
</span><span id="__span-63-72">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-63-73">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-63-74">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-63-75">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Team Wakaland:&quot;</span><span class="p">,</span> <span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-63-76">
</span><span id="__span-63-77">        <span class="n">hero_tarantula</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Tarantula&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Natalia Roman-on&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
</span><span id="__span-63-78">        <span class="n">hero_dr_weird</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Dr. Weird&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Steve Weird&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">36</span><span class="p">)</span>
</span><span id="__span-63-79">        <span class="n">hero_cap</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-63-80">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Captain North America&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Esteban Rogelios&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">93</span>
</span><span id="__span-63-81">        <span class="p">)</span>
</span><span id="__span-63-82">
</span><span id="__span-63-83">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-63-84">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-63-85">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-63-86">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_preventers</span><span class="p">)</span>
</span><span id="__span-63-87">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-63-88">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-63-89">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-63-90">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-63-91">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-63-92">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-63-93">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-63-94">
</span><span id="__span-63-95">
</span><span id="__span-63-96"><span class="k">def</span> <span class="nf">select_heroes</span><span class="p">():</span>
</span><span id="__span-63-97">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-63-98">        <span class="n">statement</span> <span class="o">=</span> <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-63-99">        <span class="n">result</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="n">statement</span><span class="p">)</span>
</span><span id="__span-63-100">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-63-101">
</span><span id="__span-63-102">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers heroes:&quot;</span><span class="p">,</span> <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-63-103">
</span><span id="__span-63-104">
</span><span id="__span-63-105"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-63-106">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-63-107">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-63-108">            <span class="n">select</span><span class="p">(</span><span class="n">Hero</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hero</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Spider-Boy&quot;</span><span class="p">)</span>
</span><span id="__span-63-109">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-63-110">
</span><span id="__span-63-111">        <span class="n">preventers_team</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-63-112">            <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-63-113">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-63-114">
</span><span id="__span-63-115">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hero Spider-Boy:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-63-116">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="p">)</span>
</span><span id="__span-63-117">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-63-118">
</span><span id="__span-63-119">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-63-120">
</span><span id="__span-63-121">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy without team:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-63-122">
</span><span id="__span-63-123">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes again:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-63-124">
</span><span id="__span-63-125">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-63-126">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-63-127">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After committing&quot;</span><span class="p">)</span>
</span><span id="__span-63-128">
</span><span id="__span-63-129">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-63-130">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy after commit:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-63-131">
</span><span id="__span-63-132">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes after commit:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-63-133">
</span><span id="__span-63-134">
</span><span id="__span-63-135"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span id="__span-63-136">    <span class="n">create_db_and_tables</span><span class="p">()</span>
</span><span id="__span-63-137">    <span class="n">create_heroes</span><span class="p">()</span>
</span><span id="__span-63-138">    <span class="n">select_heroes</span><span class="p">()</span>
</span><span id="__span-63-139">    <span class="n">update_heroes</span><span class="p">()</span>
</span><span id="__span-63-140">
</span><span id="__span-63-141">
</span><span id="__span-63-142"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-63-143">    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-64-1"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span>
</span><span id="__span-64-2">
</span><span id="__span-64-3"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">select</span>
</span><span id="__span-64-4">
</span><span id="__span-64-5">
</span><span id="__span-64-6"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-64-7">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-64-8">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-64-9">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-64-10">
</span><span id="__span-64-11">    <span class="n">heroes</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="s2">&quot;Hero&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team&quot;</span><span class="p">)</span>
</span><span id="__span-64-12">
</span><span id="__span-64-13">
</span><span id="__span-64-14"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-64-15">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-64-16">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-64-17">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-64-18">    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-64-19">
</span><span id="__span-64-20">    <span class="n">team_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">)</span>
</span><span id="__span-64-21">    <span class="n">team</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Team</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;heroes&quot;</span><span class="p">)</span>
</span><span id="__span-64-22">
</span><span id="__span-64-23">
</span><span id="__span-64-24"><span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
</span><span id="__span-64-25"><span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-64-26">
</span><span id="__span-64-27"><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-64-28">
</span><span id="__span-64-29">
</span><span id="__span-64-30"><span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
</span><span id="__span-64-31">    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
</span><span id="__span-64-32">
</span><span id="__span-64-33">
</span><span id="__span-64-34"><span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
</span><span id="__span-64-35">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-64-36">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Preventers&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sharp Tower&quot;</span><span class="p">)</span>
</span><span id="__span-64-37">        <span class="n">team_z_force</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Z-Force&quot;</span><span class="p">,</span> <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Sister Margaret&#39;s Bar&quot;</span><span class="p">)</span>
</span><span id="__span-64-38">
</span><span id="__span-64-39">        <span class="n">hero_deadpond</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-64-40">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Dive Wilson&quot;</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_z_force</span>
</span><span id="__span-64-41">        <span class="p">)</span>
</span><span id="__span-64-42">        <span class="n">hero_rusty_man</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-64-43">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="n">team_preventers</span>
</span><span id="__span-64-44">        <span class="p">)</span>
</span><span id="__span-64-45">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
</span><span id="__span-64-46">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-64-47">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-64-48">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-64-49">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-64-50">
</span><span id="__span-64-51">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-64-52">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-64-53">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-64-54">
</span><span id="__span-64-55">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_deadpond</span><span class="p">)</span>
</span><span id="__span-64-56">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_rusty_man</span><span class="p">)</span>
</span><span id="__span-64-57">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-64-58">
</span><span id="__span-64-59">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="n">team_preventers</span>
</span><span id="__span-64-60">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-64-61">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-64-62">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-64-63">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Updated hero:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-64-64">
</span><span id="__span-64-65">        <span class="n">hero_black_lion</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Black Lion&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Trevor Challa&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">35</span><span class="p">)</span>
</span><span id="__span-64-66">        <span class="n">hero_sure_e</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Princess Sure-E&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Sure-E&quot;</span><span class="p">)</span>
</span><span id="__span-64-67">        <span class="n">team_wakaland</span> <span class="o">=</span> <span class="n">Team</span><span class="p">(</span>
</span><span id="__span-64-68">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Wakaland&quot;</span><span class="p">,</span>
</span><span id="__span-64-69">            <span class="n">headquarters</span><span class="o">=</span><span class="s2">&quot;Wakaland Capital City&quot;</span><span class="p">,</span>
</span><span id="__span-64-70">            <span class="n">heroes</span><span class="o">=</span><span class="p">[</span><span class="n">hero_black_lion</span><span class="p">,</span> <span class="n">hero_sure_e</span><span class="p">],</span>
</span><span id="__span-64-71">        <span class="p">)</span>
</span><span id="__span-64-72">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-64-73">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-64-74">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-64-75">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Team Wakaland:&quot;</span><span class="p">,</span> <span class="n">team_wakaland</span><span class="p">)</span>
</span><span id="__span-64-76">
</span><span id="__span-64-77">        <span class="n">hero_tarantula</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Tarantula&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Natalia Roman-on&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
</span><span id="__span-64-78">        <span class="n">hero_dr_weird</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Dr. Weird&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Steve Weird&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">36</span><span class="p">)</span>
</span><span id="__span-64-79">        <span class="n">hero_cap</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span>
</span><span id="__span-64-80">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Captain North America&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Esteban Rogelios&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">93</span>
</span><span id="__span-64-81">        <span class="p">)</span>
</span><span id="__span-64-82">
</span><span id="__span-64-83">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-64-84">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-64-85">        <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-64-86">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">team_preventers</span><span class="p">)</span>
</span><span id="__span-64-87">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-64-88">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-64-89">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-64-90">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-64-91">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_tarantula</span><span class="p">)</span>
</span><span id="__span-64-92">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_dr_weird</span><span class="p">)</span>
</span><span id="__span-64-93">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers new hero:&quot;</span><span class="p">,</span> <span class="n">hero_cap</span><span class="p">)</span>
</span><span id="__span-64-94">
</span><span id="__span-64-95">
</span><span id="__span-64-96"><span class="k">def</span> <span class="nf">select_heroes</span><span class="p">():</span>
</span><span id="__span-64-97">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-64-98">        <span class="n">statement</span> <span class="o">=</span> <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-64-99">        <span class="n">result</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="n">statement</span><span class="p">)</span>
</span><span id="__span-64-100">        <span class="n">team_preventers</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-64-101">
</span><span id="__span-64-102">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers heroes:&quot;</span><span class="p">,</span> <span class="n">team_preventers</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-64-103">
</span><span id="__span-64-104">
</span><span id="__span-64-105"><span class="k">def</span> <span class="nf">update_heroes</span><span class="p">():</span>
</span><span id="__span-64-106">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span id="__span-64-107">        <span class="n">hero_spider_boy</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-64-108">            <span class="n">select</span><span class="p">(</span><span class="n">Hero</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Hero</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Spider-Boy&quot;</span><span class="p">)</span>
</span><span id="__span-64-109">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-64-110">
</span><span id="__span-64-111">        <span class="n">preventers_team</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
</span><span id="__span-64-112">            <span class="n">select</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Team</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Preventers&quot;</span><span class="p">)</span>
</span><span id="__span-64-113">        <span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
</span><span id="__span-64-114">
</span><span id="__span-64-115">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hero Spider-Boy:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-64-116">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="p">)</span>
</span><span id="__span-64-117">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-64-118">
</span><span id="__span-64-119">        <span class="n">hero_spider_boy</span><span class="o">.</span><span class="n">team</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-64-120">
</span><span id="__span-64-121">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy without team:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-64-122">
</span><span id="__span-64-123">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes again:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-64-124">
</span><span id="__span-64-125">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-64-126">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-64-127">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After committing&quot;</span><span class="p">)</span>
</span><span id="__span-64-128">
</span><span id="__span-64-129">        <span class="n">session</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-64-130">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spider-Boy after commit:&quot;</span><span class="p">,</span> <span class="n">hero_spider_boy</span><span class="p">)</span>
</span><span id="__span-64-131">
</span><span id="__span-64-132">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preventers Team Heroes after commit:&quot;</span><span class="p">,</span> <span class="n">preventers_team</span><span class="o">.</span><span class="n">heroes</span><span class="p">)</span>
</span><span id="__span-64-133">
</span><span id="__span-64-134">
</span><span id="__span-64-135"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span id="__span-64-136">    <span class="n">create_db_and_tables</span><span class="p">()</span>
</span><span id="__span-64-137">    <span class="n">create_heroes</span><span class="p">()</span>
</span><span id="__span-64-138">    <span class="n">select_heroes</span><span class="p">()</span>
</span><span id="__span-64-139">    <span class="n">update_heroes</span><span class="p">()</span>
</span><span id="__span-64-140">
</span><span id="__span-64-141">
</span><span id="__span-64-142"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-64-143">    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div>
</div>
</div>
</div>
</details>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Each <strong>relationship attribute</strong> points to the other one, in the other model, using <code>back_populates</code>.</p>
</div>
<p>Although it's simple code, it can be confusing to think about 😵, because the same line has concepts related to both models in multiple places:</p>
<ul>
<li>Just by being in the <strong>current</strong> model, the line has something to do with the current model.</li>
<li>The name of the attribute is about the <strong>other</strong> model.</li>
<li>The type annotation is about the <strong>other</strong> model.</li>
<li>And the <code>back_populates</code> refers to an attribute in the <strong>other</strong> model, that points to the <strong>current</strong> model.</li>
</ul>
<h2 id="a-mental-trick-to-remember-back_populates">A Mental Trick to Remember <code>back_populates</code><a class="headerlink" href="#a-mental-trick-to-remember-back_populates" title="Permanent link">&para;</a></h2>
<p>A mental trick you can use to remember is that the string in <code>back_populates</code> is always about the current model class you are editing. 🤓</p>
<p>So, if you are in the class <code>Hero</code>, the value of <code>back_populates</code> for any relationship attribute connecting to <strong>any</strong> other table (to any other model, it could be <code>Team</code>, <code>Weapon</code>, <code>Powers</code>, etc) will still always refer to this same class.</p>
<p>So, <code>back_populates</code> would most probably be something like <code>"hero"</code> or <code>"heroes"</code>.</p>
<p><img src="/img/tutorial/relationships/attributes/back-populates2.svg"></p>
<div class="tabbed-set tabbed-alternate" data-tabs="21:3"><input checked="checked" id="__tabbed_21_1" name="__tabbed_21" type="radio" /><input id="__tabbed_21_2" name="__tabbed_21" type="radio" /><input id="__tabbed_21_3" name="__tabbed_21" type="radio" /><div class="tabbed-labels"><label for="__tabbed_21_1">Python 3.10+</label><label for="__tabbed_21_2">Python 3.9+</label><label for="__tabbed_21_3">Python 3.7+</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-65-1"><span class="c1"># Code above omitted 👆</span>
</span><span id="__span-65-2">
</span><span id="__span-65-3"><span class="hll"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span></span><span id="__span-65-4">    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-65-5">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-65-6">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-65-7">    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-65-8">
</span><span id="__span-65-9">    <span class="n">team_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">)</span>
</span><span id="__span-65-10"><span class="hll">    <span class="n">team</span><span class="p">:</span> <span class="n">Team</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;heroes&quot;</span><span class="p">)</span>
</span></span><span id="__span-65-11">
</span><span id="__span-65-12">    <span class="n">weapon_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;weapon.id&quot;</span><span class="p">)</span>
</span><span id="__span-65-13"><span class="hll">    <span class="n">weapon</span><span class="p">:</span> <span class="n">Weapon</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;hero&quot;</span><span class="p">)</span>
</span></span><span id="__span-65-14">
</span><span id="__span-65-15"><span class="hll">    <span class="n">powers</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Power</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;hero&quot;</span><span class="p">)</span>
</span></span><span id="__span-65-16">
</span><span id="__span-65-17"><span class="c1"># Code below omitted 👇</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-66-1"><span class="c1"># Code above omitted 👆</span>
</span><span id="__span-66-2">
</span><span id="__span-66-3"><span class="hll"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span></span><span id="__span-66-4">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-66-5">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-66-6">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-66-7">    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-66-8">
</span><span id="__span-66-9">    <span class="n">team_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">)</span>
</span><span id="__span-66-10"><span class="hll">    <span class="n">team</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Team</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;heroes&quot;</span><span class="p">)</span>
</span></span><span id="__span-66-11">
</span><span id="__span-66-12">    <span class="n">weapon_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;weapon.id&quot;</span><span class="p">)</span>
</span><span id="__span-66-13"><span class="hll">    <span class="n">weapon</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Weapon</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;hero&quot;</span><span class="p">)</span>
</span></span><span id="__span-66-14">
</span><span id="__span-66-15"><span class="hll">    <span class="n">powers</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Power</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;hero&quot;</span><span class="p">)</span>
</span></span><span id="__span-66-16">
</span><span id="__span-66-17"><span class="c1"># Code below omitted 👇</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-67-1"><span class="c1"># Code above omitted 👆</span>
</span><span id="__span-67-2">
</span><span id="__span-67-3"><span class="hll"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span></span><span id="__span-67-4">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-67-5">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-67-6">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-67-7">    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-67-8">
</span><span id="__span-67-9">    <span class="n">team_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">)</span>
</span><span id="__span-67-10"><span class="hll">    <span class="n">team</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Team</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;heroes&quot;</span><span class="p">)</span>
</span></span><span id="__span-67-11">
</span><span id="__span-67-12">    <span class="n">weapon_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;weapon.id&quot;</span><span class="p">)</span>
</span><span id="__span-67-13"><span class="hll">    <span class="n">weapon</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Weapon</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;hero&quot;</span><span class="p">)</span>
</span></span><span id="__span-67-14">
</span><span id="__span-67-15"><span class="hll">    <span class="n">powers</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Power</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;hero&quot;</span><span class="p">)</span>
</span></span><span id="__span-67-16">
</span><span id="__span-67-17"><span class="c1"># Code below omitted 👇</span>
</span></code></pre></div>
</div>
</div>
</div>
<details>
<summary>👀 Full file preview</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="22:3"><input checked="checked" id="__tabbed_22_1" name="__tabbed_22" type="radio" /><input id="__tabbed_22_2" name="__tabbed_22" type="radio" /><input id="__tabbed_22_3" name="__tabbed_22" type="radio" /><div class="tabbed-labels"><label for="__tabbed_22_1">Python 3.10+</label><label for="__tabbed_22_2">Python 3.9+</label><label for="__tabbed_22_3">Python 3.7+</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-68-1"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span>
</span><span id="__span-68-2">
</span><span id="__span-68-3">
</span><span id="__span-68-4"><span class="k">class</span> <span class="nc">Weapon</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-68-5">    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-68-6">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-68-7">
</span><span id="__span-68-8">    <span class="n">hero</span><span class="p">:</span> <span class="s2">&quot;Hero&quot;</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;weapon&quot;</span><span class="p">)</span>
</span><span id="__span-68-9">
</span><span id="__span-68-10">
</span><span id="__span-68-11"><span class="k">class</span> <span class="nc">Power</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-68-12">    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-68-13">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-68-14">
</span><span id="__span-68-15">    <span class="n">hero_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;hero.id&quot;</span><span class="p">)</span>
</span><span id="__span-68-16">    <span class="n">hero</span><span class="p">:</span> <span class="s2">&quot;Hero&quot;</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;powers&quot;</span><span class="p">)</span>
</span><span id="__span-68-17">
</span><span id="__span-68-18">
</span><span id="__span-68-19"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-68-20">    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-68-21">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-68-22">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-68-23">
</span><span id="__span-68-24">    <span class="n">heroes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;Hero&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team&quot;</span><span class="p">)</span>
</span><span id="__span-68-25">
</span><span id="__span-68-26">
</span><span id="__span-68-27"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-68-28">    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-68-29">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-68-30">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-68-31">    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-68-32">
</span><span id="__span-68-33">    <span class="n">team_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">)</span>
</span><span id="__span-68-34">    <span class="n">team</span><span class="p">:</span> <span class="n">Team</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;heroes&quot;</span><span class="p">)</span>
</span><span id="__span-68-35">
</span><span id="__span-68-36">    <span class="n">weapon_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;weapon.id&quot;</span><span class="p">)</span>
</span><span id="__span-68-37">    <span class="n">weapon</span><span class="p">:</span> <span class="n">Weapon</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;hero&quot;</span><span class="p">)</span>
</span><span id="__span-68-38">
</span><span id="__span-68-39">    <span class="n">powers</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Power</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;hero&quot;</span><span class="p">)</span>
</span><span id="__span-68-40">
</span><span id="__span-68-41">
</span><span id="__span-68-42"><span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
</span><span id="__span-68-43"><span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-68-44">
</span><span id="__span-68-45"><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-68-46">
</span><span id="__span-68-47">
</span><span id="__span-68-48"><span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
</span><span id="__span-68-49">    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
</span><span id="__span-68-50">
</span><span id="__span-68-51">
</span><span id="__span-68-52"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span id="__span-68-53">    <span class="n">create_db_and_tables</span><span class="p">()</span>
</span><span id="__span-68-54">
</span><span id="__span-68-55">
</span><span id="__span-68-56"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-68-57">    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-69-1"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>
</span><span id="__span-69-2">
</span><span id="__span-69-3"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span>
</span><span id="__span-69-4">
</span><span id="__span-69-5">
</span><span id="__span-69-6"><span class="k">class</span> <span class="nc">Weapon</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-69-7">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-69-8">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-69-9">
</span><span id="__span-69-10">    <span class="n">hero</span><span class="p">:</span> <span class="s2">&quot;Hero&quot;</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;weapon&quot;</span><span class="p">)</span>
</span><span id="__span-69-11">
</span><span id="__span-69-12">
</span><span id="__span-69-13"><span class="k">class</span> <span class="nc">Power</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-69-14">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-69-15">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-69-16">
</span><span id="__span-69-17">    <span class="n">hero_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;hero.id&quot;</span><span class="p">)</span>
</span><span id="__span-69-18">    <span class="n">hero</span><span class="p">:</span> <span class="s2">&quot;Hero&quot;</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;powers&quot;</span><span class="p">)</span>
</span><span id="__span-69-19">
</span><span id="__span-69-20">
</span><span id="__span-69-21"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-69-22">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-69-23">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-69-24">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-69-25">
</span><span id="__span-69-26">    <span class="n">heroes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;Hero&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team&quot;</span><span class="p">)</span>
</span><span id="__span-69-27">
</span><span id="__span-69-28">
</span><span id="__span-69-29"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-69-30">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-69-31">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-69-32">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-69-33">    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-69-34">
</span><span id="__span-69-35">    <span class="n">team_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">)</span>
</span><span id="__span-69-36">    <span class="n">team</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Team</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;heroes&quot;</span><span class="p">)</span>
</span><span id="__span-69-37">
</span><span id="__span-69-38">    <span class="n">weapon_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;weapon.id&quot;</span><span class="p">)</span>
</span><span id="__span-69-39">    <span class="n">weapon</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Weapon</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;hero&quot;</span><span class="p">)</span>
</span><span id="__span-69-40">
</span><span id="__span-69-41">    <span class="n">powers</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Power</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;hero&quot;</span><span class="p">)</span>
</span><span id="__span-69-42">
</span><span id="__span-69-43">
</span><span id="__span-69-44"><span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
</span><span id="__span-69-45"><span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-69-46">
</span><span id="__span-69-47"><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-69-48">
</span><span id="__span-69-49">
</span><span id="__span-69-50"><span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
</span><span id="__span-69-51">    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
</span><span id="__span-69-52">
</span><span id="__span-69-53">
</span><span id="__span-69-54"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span id="__span-69-55">    <span class="n">create_db_and_tables</span><span class="p">()</span>
</span><span id="__span-69-56">
</span><span id="__span-69-57">
</span><span id="__span-69-58"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-69-59">    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span id="__span-70-1"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span>
</span><span id="__span-70-2">
</span><span id="__span-70-3"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Relationship</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span>
</span><span id="__span-70-4">
</span><span id="__span-70-5">
</span><span id="__span-70-6"><span class="k">class</span> <span class="nc">Weapon</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-70-7">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-70-8">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-70-9">
</span><span id="__span-70-10">    <span class="n">hero</span><span class="p">:</span> <span class="s2">&quot;Hero&quot;</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;weapon&quot;</span><span class="p">)</span>
</span><span id="__span-70-11">
</span><span id="__span-70-12">
</span><span id="__span-70-13"><span class="k">class</span> <span class="nc">Power</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-70-14">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-70-15">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-70-16">
</span><span id="__span-70-17">    <span class="n">hero_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;hero.id&quot;</span><span class="p">)</span>
</span><span id="__span-70-18">    <span class="n">hero</span><span class="p">:</span> <span class="s2">&quot;Hero&quot;</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;powers&quot;</span><span class="p">)</span>
</span><span id="__span-70-19">
</span><span id="__span-70-20">
</span><span id="__span-70-21"><span class="k">class</span> <span class="nc">Team</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-70-22">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-70-23">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-70-24">    <span class="n">headquarters</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-70-25">
</span><span id="__span-70-26">    <span class="n">heroes</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="s2">&quot;Hero&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;team&quot;</span><span class="p">)</span>
</span><span id="__span-70-27">
</span><span id="__span-70-28">
</span><span id="__span-70-29"><span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="__span-70-30">    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-70-31">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-70-32">    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-70-33">    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-70-34">
</span><span id="__span-70-35">    <span class="n">team_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;team.id&quot;</span><span class="p">)</span>
</span><span id="__span-70-36">    <span class="n">team</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Team</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;heroes&quot;</span><span class="p">)</span>
</span><span id="__span-70-37">
</span><span id="__span-70-38">    <span class="n">weapon_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">foreign_key</span><span class="o">=</span><span class="s2">&quot;weapon.id&quot;</span><span class="p">)</span>
</span><span id="__span-70-39">    <span class="n">weapon</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Weapon</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;hero&quot;</span><span class="p">)</span>
</span><span id="__span-70-40">
</span><span id="__span-70-41">    <span class="n">powers</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Power</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relationship</span><span class="p">(</span><span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;hero&quot;</span><span class="p">)</span>
</span><span id="__span-70-42">
</span><span id="__span-70-43">
</span><span id="__span-70-44"><span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
</span><span id="__span-70-45"><span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-70-46">
</span><span id="__span-70-47"><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-70-48">
</span><span id="__span-70-49">
</span><span id="__span-70-50"><span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
</span><span id="__span-70-51">    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
</span><span id="__span-70-52">
</span><span id="__span-70-53">
</span><span id="__span-70-54"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span id="__span-70-55">    <span class="n">create_db_and_tables</span><span class="p">()</span>
</span><span id="__span-70-56">
</span><span id="__span-70-57">
</span><span id="__span-70-58"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-70-59">    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div>
</div>
</div>
</div>
</details>







  
  



  



  <form class="md-feedback" name="feedback" hidden>
    <fieldset>
      <legend class="md-feedback__title">
        Was this page helpful?
      </legend>
      <div class="md-feedback__inner">
        <div class="md-feedback__list">
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page was helpful" data-md-value="1">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m7 0c0 .8-.7 1.5-1.5 1.5S14 10.3 14 9.5 14.7 8 15.5 8s1.5.7 1.5 1.5m-5 7.73c-1.75 0-3.29-.73-4.19-1.81L9.23 14c.45.72 1.52 1.23 2.77 1.23s2.32-.51 2.77-1.23l1.42 1.42c-.9 1.08-2.44 1.81-4.19 1.81"/></svg>
            </button>
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page could be improved" data-md-value="0">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10m-6.5-4c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5-1.5-.7-1.5-1.5.7-1.5 1.5-1.5M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m2 4.5c1.75 0 3.29.72 4.19 1.81l-1.42 1.42C14.32 16.5 13.25 16 12 16s-2.32.5-2.77 1.23l-1.42-1.42C8.71 14.72 10.25 14 12 14"/></svg>
            </button>
          
        </div>
        <div class="md-feedback__note">
          
            <div data-md-value="1" hidden>
              
              
                
              
              Thanks for your feedback!
            </div>
          
            <div data-md-value="0" hidden>
              
              
                
              
              Thanks for your feedback!
            </div>
          
        </div>
      </div>
    </fieldset>
  </form>


                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../remove-relationships/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Remove Relationships">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Remove Relationships
              </div>
            </div>
          </a>
        
        
          
          <a href="../cascade-delete-relationships/" class="md-footer__link md-footer__link--next" aria-label="Next: Cascade Delete Relationships">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Cascade Delete Relationships
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/readyapi/sqldev" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/khulnasoft" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/in/khulnasoft" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://dev.to/khulnasoft" target="_blank" rel="noopener" title="dev.to" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M120.12 208.29c-3.88-2.9-7.77-4.35-11.65-4.35H91.03v104.47h17.45c3.88 0 7.77-1.45 11.65-4.35s5.82-7.25 5.82-13.06v-69.65c-.01-5.8-1.96-10.16-5.83-13.06M404.1 32H43.9C19.7 32 .06 51.59 0 75.8v360.4C.06 460.41 19.7 480 43.9 480h360.2c24.21 0 43.84-19.59 43.9-43.8V75.8c-.06-24.21-19.7-43.8-43.9-43.8M154.2 291.19c0 18.81-11.61 47.31-48.36 47.25h-46.4V172.98h47.38c35.44 0 47.36 28.46 47.37 47.28zm100.68-88.66H201.6v38.42h32.57v29.57H201.6v38.41h53.29v29.57h-62.18c-11.16.29-20.44-8.53-20.72-19.69V193.7c-.27-11.15 8.56-20.41 19.71-20.69h63.19zm103.64 115.29c-13.2 30.75-36.85 24.63-47.44 0l-38.53-144.8h32.57l29.71 113.72 29.57-113.72h32.58z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://medium.com/@khulnasoft" target="_blank" rel="noopener" title="medium.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M180.5 74.262C80.813 74.262 0 155.633 0 256s80.819 181.738 180.5 181.738S361 356.373 361 256 280.191 74.262 180.5 74.262m288.25 10.646c-49.845 0-90.245 76.619-90.245 171.095s40.406 171.1 90.251 171.1 90.251-76.619 90.251-171.1H559c0-94.503-40.4-171.095-90.248-171.095Zm139.506 17.821c-17.526 0-31.735 68.628-31.735 153.274s14.2 153.274 31.735 153.274S640 340.631 640 256c0-84.649-14.215-153.271-31.742-153.271Z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://khulnasoft.com" target="_blank" rel="noopener" title="khulnasoft.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M352 256c0 22.2-1.2 43.6-3.3 64H163.4c-2.2-20.4-3.3-41.8-3.3-64s1.2-43.6 3.3-64h185.3c2.2 20.4 3.3 41.8 3.3 64m28.8-64h123.1c5.3 20.5 8.1 41.9 8.1 64s-2.8 43.5-8.1 64H380.8c2.1-20.6 3.2-42 3.2-64s-1.1-43.4-3.2-64m112.6-32H376.7c-10-63.9-29.8-117.4-55.3-151.6 78.3 20.7 142 77.5 171.9 151.6zm-149.1 0H167.7c6.1-36.4 15.5-68.6 27-94.7 10.5-23.6 22.2-40.7 33.5-51.5C239.4 3.2 248.7 0 256 0s16.6 3.2 27.8 13.8c11.3 10.8 23 27.9 33.5 51.5 11.6 26 20.9 58.2 27 94.7m-209 0H18.6c30-74.1 93.6-130.9 172-151.6-25.5 34.2-45.3 87.7-55.3 151.6M8.1 192h123.1c-2.1 20.6-3.2 42-3.2 64s1.1 43.4 3.2 64H8.1C2.8 299.5 0 278.1 0 256s2.8-43.5 8.1-64m186.6 254.6c-11.6-26-20.9-58.2-27-94.6h176.6c-6.1 36.4-15.5 68.6-27 94.6-10.5 23.6-22.2 40.7-33.5 51.5-11.2 10.7-20.5 13.9-27.8 13.9s-16.6-3.2-27.8-13.8c-11.3-10.8-23-27.9-33.5-51.5zM135.3 352c10 63.9 29.8 117.4 55.3 151.6-78.4-20.7-142-77.5-172-151.6zm358.1 0c-30 74.1-93.6 130.9-171.9 151.6 25.5-34.2 45.2-87.7 55.3-151.6h116.7z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.annotate", "content.code.copy", "content.footnote.tooltips", "content.tabs.link", "content.tooltips", "navigation.footer", "navigation.indexes", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.path", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
        <script src="../../../js/termynal.js"></script>
      
        <script src="../../../js/custom.js"></script>
      
    
  </body>
</html>